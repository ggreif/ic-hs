<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{- |

This module contains a test suite for the Internet Computer

-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE OverloadedLabels #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE NumericUnderscores #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">IC.Test.Spec.HTTP</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Test.Spec.HTTP.html#canister_http_calls"><span class="hs-identifier">canister_http_calls</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/bytestring-0.10.12.1/src/Data.ByteString.Lazy.html"><span class="hs-identifier">Data.ByteString.Lazy</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/5xj65cipwzdnpp6y5z9vwld366h065w2-vector-0.12.3.1-doc/share/doc/vector-0.12.3.1/html/src/Data.Vector.html"><span class="hs-identifier">Data.Vector</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Vec</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/parkwiz24n4dcrhpl7lzfmjfrwqql3ls-utf8-string-1.0.2-doc/share/doc/utf8-string-1.0.2/html/src/Data.ByteString.Lazy.UTF8.html"><span class="hs-identifier">Data.ByteString.Lazy.UTF8</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BLU</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/g06j82c3sqx93lq3lx6xfdryp0y61zf4-tasty-1.4.2.3-doc/share/doc/tasty-1.4.2.3/html/src/Test.Tasty.html"><span class="hs-identifier">Test.Tasty</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.html"><span class="hs-identifier">Test.Tasty.HUnit</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/Data.Word.html"><span class="hs-identifier">Data.Word</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.html"><span class="hs-identifier">Data.Row</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">R</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/5q8knwbpcq1xjhfifih1jfwmvd2jr0sg-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.html"><span class="hs-identifier">Codec.Candid</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Candid</span></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/lrgc0409r3969xpx8sr161n8fp0b2amn-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.html"><span class="hs-identifier">Data.Aeson</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/Data.Char.html"><span class="hs-identifier">Data.Char</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/lrgc0409r3969xpx8sr161n8fp0b2amn-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.Key.html"><span class="hs-identifier">Data.Aeson.Key</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">K</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/lrgc0409r3969xpx8sr161n8fp0b2amn-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.KeyMap.html"><span class="hs-identifier">Data.Aeson.KeyMap</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">KM</span></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Management.html"><span class="hs-identifier">IC.Management</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Management.html#HttpResponse"><span class="hs-identifier">HttpResponse</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Management.html#HttpHeader"><span class="hs-identifier">HttpHeader</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Types.html"><span class="hs-identifier">IC.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Types.html#EntityId"><span class="hs-identifier">EntityId</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Constants.html"><span class="hs-identifier">IC.Constants</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Id.Fresh.html"><span class="hs-identifier">IC.Id.Fresh</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Test.Universal.html"><span class="hs-identifier">IC.Test.Universal</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Test.Agent.html"><span class="hs-identifier">IC.Test.Agent</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html"><span class="hs-identifier">IC.Test.Agent.UnsafeCalls</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Test.Agent.SafeCalls.html"><span class="hs-identifier">IC.Test.Agent.SafeCalls</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Test.Spec.Utils.html"><span class="hs-identifier">IC.Test.Spec.Utils</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Types.html"><span class="hs-identifier">IC.Types</span></a></span><span class="hs-special">(</span><span class="annot"><a href="IC.Types.html#TestSubnetConfig"><span class="hs-identifier">TestSubnetConfig</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Utils.html"><span class="hs-identifier">IC.Utils</span></a></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-comment">-- * Helpers</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="annot"><a href="IC.Test.Spec.HTTP.html#charFromInt"><span class="hs-identifier hs-type">charFromInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span>
</span><span id="line-49"></span><span id="charFromInt"><span class="annot"><span class="annottext">charFromInt :: Int -&gt; Char
</span><a href="IC.Test.Spec.HTTP.html#charFromInt"><span class="hs-identifier hs-var hs-var">charFromInt</span></a></span></span><span> </span><span id="local-6989586621679360811"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360811"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Char.html#chr"><span class="hs-identifier hs-var">chr</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Char) -&gt; Int -&gt; Char
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679360811"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#ord"><span class="hs-identifier hs-var">ord</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'a'</span></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-comment">-- * Canister http calls</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="annot"><a href="IC.Test.Spec.HTTP.html#check_distinct_headers"><span class="hs-identifier hs-type">check_distinct_headers</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/5xj65cipwzdnpp6y5z9vwld366h065w2-vector-0.12.3.1-doc/share/doc/vector-0.12.3.1/html/src/Data.Vector.html#Vector"><span class="hs-identifier hs-type">Vec.Vector</span></a></span><span> </span><span class="annot"><a href="IC.Management.html#HttpHeader"><span class="hs-identifier hs-type">HttpHeader</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-54"></span><span id="check_distinct_headers"><span class="annot"><span class="annottext">check_distinct_headers :: Vector HttpHeader -&gt; Bool
</span><a href="IC.Test.Spec.HTTP.html#check_distinct_headers"><span class="hs-identifier hs-var hs-var">check_distinct_headers</span></a></span></span><span> </span><span id="local-6989586621679360806"><span class="annot"><span class="annottext">Vector HttpHeader
</span><a href="#local-6989586621679360806"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679360804"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Text] -&gt; [Text]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/Data.OldList.html#nub"><span class="hs-identifier hs-var">nub</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679360804"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679360804"><span class="annot"><span class="annottext">xs :: [Text]
</span><a href="#local-6989586621679360804"><span class="hs-identifier hs-var hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text]) -&gt; Text)
-&gt; [Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679360799"><span class="annot"><span class="annottext">Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])
</span><a href="#local-6989586621679360799"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#toLower"><span class="hs-identifier hs-var">T.toLower</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])
</span><a href="#local-6989586621679360799"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])
-&gt; Label &quot;name&quot;
-&gt; 'R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text] .! &quot;name&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;name&quot; (Label &quot;name&quot;)
Label &quot;name&quot;
</span><a href="#local-6989586621679360801"><span class="hs-var">#name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])] -&gt; [Text])
-&gt; [Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text]))
-&gt; [Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])]
forall a. Vector a -&gt; [a]
</span><a href="file:///nix/store/5xj65cipwzdnpp6y5z9vwld366h065w2-vector-0.12.3.1-doc/share/doc/vector-0.12.3.1/html/src/Data.Vector.html#toList"><span class="hs-identifier hs-var">Vec.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text]))
Vector HttpHeader
</span><a href="#local-6989586621679360806"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="annot"><a href="IC.Test.Spec.HTTP.html#http_headers_to_map"><span class="hs-identifier hs-type">http_headers_to_map</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/5xj65cipwzdnpp6y5z9vwld366h065w2-vector-0.12.3.1-doc/share/doc/vector-0.12.3.1/html/src/Data.Vector.html#Vector"><span class="hs-identifier hs-type">Vec.Vector</span></a></span><span> </span><span class="annot"><a href="IC.Management.html#HttpHeader"><span class="hs-identifier hs-type">HttpHeader</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">T.Text</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">T.Text</span></a></span><span>
</span><span id="line-58"></span><span id="http_headers_to_map"><span class="annot"><span class="annottext">http_headers_to_map :: Vector HttpHeader -&gt; Text -&gt; Maybe Text
</span><a href="IC.Test.Spec.HTTP.html#http_headers_to_map"><span class="hs-identifier hs-var hs-var">http_headers_to_map</span></a></span></span><span> </span><span id="local-6989586621679360794"><span class="annot"><span class="annottext">Vector HttpHeader
</span><a href="#local-6989586621679360794"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679360793"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679360793"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [(Text, Text)] -&gt; Maybe Text
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.List.html#lookup"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679360793"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">([(Text, Text)] -&gt; Maybe Text) -&gt; [(Text, Text)] -&gt; Maybe Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; [(Text, Text)]
</span><a href="IC.Test.Spec.HTTP.html#map_to_lower"><span class="hs-identifier hs-var">map_to_lower</span></a></span><span> </span><span class="annot"><span class="annottext">([(Text, Text)] -&gt; [(Text, Text)])
-&gt; [(Text, Text)] -&gt; [(Text, Text)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text]) -&gt; (Text, Text))
-&gt; [Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])]
-&gt; [(Text, Text)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679360790"><span class="annot"><span class="annottext">Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])
</span><a href="#local-6989586621679360790"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])
</span><a href="#local-6989586621679360790"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])
-&gt; Label &quot;name&quot;
-&gt; 'R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text] .! &quot;name&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;name&quot; (Label &quot;name&quot;)
Label &quot;name&quot;
</span><a href="#local-6989586621679360841"><span class="hs-var">#name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])
</span><a href="#local-6989586621679360790"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])
-&gt; Label &quot;value&quot;
-&gt; 'R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text] .! &quot;value&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;value&quot; (Label &quot;value&quot;)
Label &quot;value&quot;
</span><a href="#local-6989586621679360837"><span class="hs-var">#value</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])]
 -&gt; [(Text, Text)])
-&gt; [Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])]
-&gt; [(Text, Text)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text]))
-&gt; [Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])]
forall a. Vector a -&gt; [a]
</span><a href="file:///nix/store/5xj65cipwzdnpp6y5z9vwld366h065w2-vector-0.12.3.1-doc/share/doc/vector-0.12.3.1/html/src/Data.Vector.html#toList"><span class="hs-identifier hs-var">Vec.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text]))
Vector HttpHeader
</span><a href="#local-6989586621679360794"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="annot"><a href="IC.Test.Spec.HTTP.html#map_to_lower"><span class="hs-identifier hs-type">map_to_lower</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">T.Text</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">T.Text</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">T.Text</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">T.Text</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-61"></span><span id="map_to_lower"><span class="annot"><span class="annottext">map_to_lower :: [(Text, Text)] -&gt; [(Text, Text)]
</span><a href="IC.Test.Spec.HTTP.html#map_to_lower"><span class="hs-identifier hs-var hs-var">map_to_lower</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Text, Text) -&gt; (Text, Text)) -&gt; [(Text, Text)] -&gt; [(Text, Text)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679360789"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679360789"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679360788"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679360788"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#toLower"><span class="hs-identifier hs-var">T.toLower</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679360789"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679360788"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="annot"><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-type">check_http_response</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Management.html#HttpResponse"><span class="hs-identifier hs-type">HttpResponse</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span id="check_http_response"><span class="annot"><span class="annottext">check_http_response :: HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var hs-var">check_http_response</span></a></span></span><span> </span><span id="local-6989586621679360786"><span class="annot"><span class="annottext">HttpResponse
</span><a href="#local-6989586621679360786"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-65"></span><span>  </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;HTTP response header names must be distinct&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; IO ()) -&gt; Bool -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Vector HttpHeader -&gt; Bool
</span><a href="IC.Test.Spec.HTTP.html#check_distinct_headers"><span class="hs-identifier hs-var">check_distinct_headers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
HttpResponse
</span><a href="#local-6989586621679360786"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;headers&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;headers&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;headers&quot; (Label &quot;headers&quot;)
Label &quot;headers&quot;
</span><a href="#local-6989586621679360826"><span class="hs-var">#headers</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>  </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;HTTP header \&quot;Content-Length\&quot; must contain the length of the body&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; IO ()) -&gt; Bool -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
</span><a href="#local-6989586621679360784"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;content-length&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-68"></span><span>                                        </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679360782"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679360782"><span class="hs-identifier hs-var">l</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679360782"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">(Int64 -&gt; String) -&gt; Int64 -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int64
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/bytestring-0.10.12.1/src/Data.ByteString.Lazy.html#length"><span class="hs-identifier hs-var">BS.length</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Int64) -&gt; ByteString -&gt; Int64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
HttpResponse
</span><a href="#local-6989586621679360786"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;body&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;body&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;body&quot; (Label &quot;body&quot;)
Label &quot;body&quot;
</span><a href="#local-6989586621679360818"><span class="hs-var">#body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-70"></span><span>    </span><span id="local-6989586621679360784"><span class="annot"><span class="annottext">h :: Text -&gt; Maybe Text
</span><a href="#local-6989586621679360784"><span class="hs-identifier hs-var hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector HttpHeader -&gt; Text -&gt; Maybe Text
</span><a href="IC.Test.Spec.HTTP.html#http_headers_to_map"><span class="hs-identifier hs-var">http_headers_to_map</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector HttpHeader -&gt; Text -&gt; Maybe Text)
-&gt; Vector HttpHeader -&gt; Text -&gt; Maybe Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
HttpResponse
</span><a href="#local-6989586621679360786"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;headers&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;headers&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;headers&quot; (Label &quot;headers&quot;)
Label &quot;headers&quot;
</span><a href="#local-6989586621679360778"><span class="hs-var">#headers</span></a></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-keyword">newtype</span><span> </span><span id="HttpRequestHeaders"><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequestHeaders"><span class="hs-identifier hs-var">HttpRequestHeaders</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HttpRequestHeaders"><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequestHeaders"><span class="hs-identifier hs-var">HttpRequestHeaders</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">T.Text</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">T.Text</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-keyword">newtype</span><span> </span><span id="HttpRequestBody"><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequestBody"><span class="hs-identifier hs-var">HttpRequestBody</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HttpRequestBody"><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequestBody"><span class="hs-identifier hs-var">HttpRequestBody</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/bytestring-0.10.12.1/src/Data.ByteString.Lazy.Internal.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679360768"><span id="local-6989586621679360773"><span class="annot"><span class="annottext">HttpRequestBody -&gt; HttpRequestBody -&gt; Bool
(HttpRequestBody -&gt; HttpRequestBody -&gt; Bool)
-&gt; (HttpRequestBody -&gt; HttpRequestBody -&gt; Bool)
-&gt; Eq HttpRequestBody
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: HttpRequestBody -&gt; HttpRequestBody -&gt; Bool
$c/= :: HttpRequestBody -&gt; HttpRequestBody -&gt; Bool
== :: HttpRequestBody -&gt; HttpRequestBody -&gt; Bool
$c== :: HttpRequestBody -&gt; HttpRequestBody -&gt; Bool
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-keyword">data</span><span> </span><span id="HttpRequest"><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequest"><span class="hs-identifier hs-var">HttpRequest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-78"></span><span>  </span><span id="HttpRequest"><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequest"><span class="hs-identifier hs-var">HttpRequest</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="method"><span class="annot"><span class="annottext">HttpRequest -&gt; Text
</span><a href="IC.Test.Spec.HTTP.html#method"><span class="hs-identifier hs-var hs-var">method</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">T.Text</span></a></span><span>
</span><span id="line-79"></span><span>              </span><span class="hs-special">,</span><span> </span><span id="headers"><span class="annot"><span class="annottext">HttpRequest -&gt; HttpRequestHeaders
</span><a href="IC.Test.Spec.HTTP.html#headers"><span class="hs-identifier hs-var hs-var">headers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequestHeaders"><span class="hs-identifier hs-type">HttpRequestHeaders</span></a></span><span>
</span><span id="line-80"></span><span>              </span><span class="hs-special">,</span><span> </span><span id="body"><span class="annot"><span class="annottext">HttpRequest -&gt; HttpRequestBody
</span><a href="IC.Test.Spec.HTTP.html#body"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequestBody"><span class="hs-identifier hs-type">HttpRequestBody</span></a></span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679360758"><span class="annot"><a href="file:///nix/store/lrgc0409r3969xpx8sr161n8fp0b2amn-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.Types.FromJSON.html#FromJSON"><span class="hs-identifier hs-type">FromJSON</span></a></span><span> </span><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequest"><span class="hs-identifier hs-type">HttpRequest</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-84"></span><span>  </span><span id="local-6989586621679360741"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser HttpRequest
</span><a href="file:///nix/store/lrgc0409r3969xpx8sr161n8fp0b2amn-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.Types.FromJSON.html#parseJSON"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/lrgc0409r3969xpx8sr161n8fp0b2amn-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.Types.Internal.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span> </span><span id="local-6989586621679360738"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679360738"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-85"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; HttpRequestHeaders -&gt; HttpRequestBody -&gt; HttpRequest
</span><a href="IC.Test.Spec.HTTP.html#HttpRequest"><span class="hs-identifier hs-var">HttpRequest</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; HttpRequestHeaders -&gt; HttpRequestBody -&gt; HttpRequest)
-&gt; Parser Text
-&gt; Parser (HttpRequestHeaders -&gt; HttpRequestBody -&gt; HttpRequest)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679360738"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser Text
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><a href="file:///nix/store/lrgc0409r3969xpx8sr161n8fp0b2amn-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.Types.FromJSON.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;method&quot;</span></span><span>
</span><span id="line-86"></span><span>                </span><span class="annot"><span class="annottext">Parser (HttpRequestHeaders -&gt; HttpRequestBody -&gt; HttpRequest)
-&gt; Parser HttpRequestHeaders
-&gt; Parser (HttpRequestBody -&gt; HttpRequest)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679360738"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser HttpRequestHeaders
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><a href="file:///nix/store/lrgc0409r3969xpx8sr161n8fp0b2amn-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.Types.FromJSON.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;headers&quot;</span></span><span>
</span><span id="line-87"></span><span>                </span><span class="annot"><span class="annottext">Parser (HttpRequestBody -&gt; HttpRequest)
-&gt; Parser HttpRequestBody -&gt; Parser HttpRequest
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679360738"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser HttpRequestBody
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><a href="file:///nix/store/lrgc0409r3969xpx8sr161n8fp0b2amn-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.Types.FromJSON.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;data&quot;</span></span><span>
</span><span id="line-88"></span><span>  </span><span class="annot"><a href="file:///nix/store/lrgc0409r3969xpx8sr161n8fp0b2amn-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.Types.FromJSON.html#parseJSON"><span class="hs-identifier hs-var">parseJSON</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Parser HttpRequest
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unsupported&quot;</span></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679360732"><span class="annot"><a href="file:///nix/store/lrgc0409r3969xpx8sr161n8fp0b2amn-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.Types.FromJSON.html#FromJSON"><span class="hs-identifier hs-type">FromJSON</span></a></span><span> </span><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequestHeaders"><span class="hs-identifier hs-type">HttpRequestHeaders</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-91"></span><span>  </span><span id="local-6989586621679360725"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser HttpRequestHeaders
</span><a href="#local-6989586621679360725"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/lrgc0409r3969xpx8sr161n8fp0b2amn-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.Types.Internal.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span> </span><span id="local-6989586621679360724"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679360724"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-keyword">do</span><span>
</span><span id="line-93"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679360720"><span class="annot"><span class="annottext">r :: Maybe [(Text, Text)]
</span><a href="#local-6989586621679360720"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Key, Value) -&gt; Maybe [(Text, Text)] -&gt; Maybe [(Text, Text)])
-&gt; Maybe [(Text, Text)] -&gt; [(Key, Value)] -&gt; Maybe [(Text, Text)]
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679360718"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679360718"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679360717"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679360717"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679360716"><span class="annot"><span class="annottext">Maybe [(Text, Text)]
</span><a href="#local-6989586621679360716"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679360717"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><a href="file:///nix/store/lrgc0409r3969xpx8sr161n8fp0b2amn-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.Types.Internal.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span id="local-6989586621679360714"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679360714"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(Text, Text)] -&gt; [(Text, Text)])
-&gt; Maybe [(Text, Text)] -&gt; Maybe [(Text, Text)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679360713"><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679360713"><span class="hs-identifier hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key -&gt; Text
</span><a href="file:///nix/store/lrgc0409r3969xpx8sr161n8fp0b2amn-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.Key.html#toText"><span class="hs-identifier hs-var">K.toText</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679360718"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679360714"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text, Text) -&gt; [(Text, Text)] -&gt; [(Text, Text)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679360713"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe [(Text, Text)]
</span><a href="#local-6989586621679360716"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-94"></span><span>                                            </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe [(Text, Text)]
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; Maybe [(Text, Text)]
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; [(Key, Value)]
forall v. KeyMap v -&gt; [(Key, v)]
</span><a href="file:///nix/store/lrgc0409r3969xpx8sr161n8fp0b2amn-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.KeyMap.html#toList"><span class="hs-identifier hs-var">KM.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679360724"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe [(Text, Text)]
</span><a href="#local-6989586621679360720"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Maybe [(Text, Text)]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Parser HttpRequestHeaders
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unsupported&quot;</span></span><span>
</span><span id="line-96"></span><span>                </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679360710"><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679360710"><span class="hs-identifier hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HttpRequestHeaders -&gt; Parser HttpRequestHeaders
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(HttpRequestHeaders -&gt; Parser HttpRequestHeaders)
-&gt; HttpRequestHeaders -&gt; Parser HttpRequestHeaders
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; HttpRequestHeaders
</span><a href="IC.Test.Spec.HTTP.html#HttpRequestHeaders"><span class="hs-identifier hs-var">HttpRequestHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679360710"><span class="hs-identifier hs-var">hs</span></a></span><span>
</span><span id="line-97"></span><span>  </span><span class="annot"><a href="file:///nix/store/lrgc0409r3969xpx8sr161n8fp0b2amn-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.Types.FromJSON.html#parseJSON"><span class="hs-identifier hs-var">parseJSON</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Parser HttpRequestHeaders
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unsupported&quot;</span></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679360707"><span class="annot"><a href="file:///nix/store/lrgc0409r3969xpx8sr161n8fp0b2amn-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.Types.FromJSON.html#FromJSON"><span class="hs-identifier hs-type">FromJSON</span></a></span><span> </span><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequestBody"><span class="hs-identifier hs-type">HttpRequestBody</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-100"></span><span>  </span><span id="local-6989586621679360703"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser HttpRequestBody
</span><a href="#local-6989586621679360703"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/lrgc0409r3969xpx8sr161n8fp0b2amn-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.Types.Internal.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span id="local-6989586621679360702"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679360702"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HttpRequestBody -&gt; Parser HttpRequestBody
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(HttpRequestBody -&gt; Parser HttpRequestBody)
-&gt; HttpRequestBody -&gt; Parser HttpRequestBody
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; HttpRequestBody
</span><a href="IC.Test.Spec.HTTP.html#HttpRequestBody"><span class="hs-identifier hs-var">HttpRequestBody</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; HttpRequestBody) -&gt; ByteString -&gt; HttpRequestBody
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="IC.Utils.html#toUtf8"><span class="hs-identifier hs-var">toUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679360702"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-101"></span><span>  </span><span class="annot"><a href="file:///nix/store/lrgc0409r3969xpx8sr161n8fp0b2amn-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.Types.FromJSON.html#parseJSON"><span class="hs-identifier hs-var">parseJSON</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Parser HttpRequestBody
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unsupported&quot;</span></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span id="local-6989586621679360965"><span class="annot"><a href="IC.Test.Spec.HTTP.html#list_subset"><span class="hs-identifier hs-type">list_subset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679360965"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679360965"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679360965"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-104"></span><span id="list_subset"><span class="annot"><span class="annottext">list_subset :: forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><a href="IC.Test.Spec.HTTP.html#list_subset"><span class="hs-identifier hs-var hs-var">list_subset</span></a></span></span><span> </span><span id="local-6989586621679360695"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679360695"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679360694"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679360694"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679360692"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679360692"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/Data.Foldable.html#elem"><span class="hs-identifier hs-var">elem</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679360692"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679360694"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679360695"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="annot"><a href="IC.Test.Spec.HTTP.html#headers_match"><span class="hs-identifier hs-type">headers_match</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">T.Text</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">T.Text</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">T.Text</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">T.Text</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-107"></span><span id="headers_match"><span class="annot"><span class="annottext">headers_match :: [(Text, Text)] -&gt; [(Text, Text)] -&gt; Bool
</span><a href="IC.Test.Spec.HTTP.html#headers_match"><span class="hs-identifier hs-var hs-var">headers_match</span></a></span></span><span> </span><span id="local-6989586621679360689"><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679360689"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679360688"><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679360688"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Text, Text) -&gt; Bool) -&gt; [(Text, Text)] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679360687"><span class="annot"><span class="annottext">(Text, Text)
</span><a href="#local-6989586621679360687"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Text, Text) -&gt; [(Text, Text)] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/Data.Foldable.html#elem"><span class="hs-identifier hs-var">elem</span></a></span><span> </span><span class="annot"><span class="annottext">(Text, Text)
</span><a href="#local-6989586621679360687"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679360688"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679360689"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">((Text, Text) -&gt; Bool) -&gt; [(Text, Text)] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679360685"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679360685"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679360684"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679360684"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Text, Text) -&gt; [(Text, Text)] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/Data.Foldable.html#elem"><span class="hs-identifier hs-var">elem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679360685"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679360684"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679360689"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679360685"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;host&quot;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679360685"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;content-length&quot;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679360685"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;accept-encoding&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679360688"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="annot"><a href="IC.Test.Spec.HTTP.html#check_http_json"><span class="hs-identifier hs-type">check_http_json</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">T.Text</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">T.Text</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/bytestring-0.10.12.1/src/Data.ByteString.Lazy.Internal.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequest"><span class="hs-identifier hs-type">HttpRequest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#Assertion"><span class="hs-identifier hs-type">Assertion</span></a></span><span>
</span><span id="line-110"></span><span id="check_http_json"><span class="annot"><span class="annottext">check_http_json :: String
-&gt; [(Text, Text)] -&gt; ByteString -&gt; Maybe HttpRequest -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_json"><span class="hs-identifier hs-var hs-var">check_http_json</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe HttpRequest
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a. HasCallStack =&gt; String -&gt; IO a
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertFailure"><span class="hs-identifier hs-var">assertFailure</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Could not parse the original HttpRequest from the response&quot;</span></span><span>
</span><span id="line-111"></span><span class="annot"><a href="IC.Test.Spec.HTTP.html#check_http_json"><span class="hs-identifier hs-var">check_http_json</span></a></span><span> </span><span id="local-6989586621679360679"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360679"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679360678"><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679360678"><span class="hs-identifier hs-var">hs</span></a></span></span><span> </span><span id="local-6989586621679360677"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679360677"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679360676"><span class="annot"><span class="annottext">HttpRequest
</span><a href="#local-6989586621679360676"><span class="hs-identifier hs-var">req</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-112"></span><span>  </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Wrong HTTP method&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; IO ()) -&gt; Bool -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679360679"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">HttpRequest -&gt; Text
</span><a href="IC.Test.Spec.HTTP.html#method"><span class="hs-identifier hs-var hs-var">method</span></a></span><span> </span><span class="annot"><span class="annottext">HttpRequest
</span><a href="#local-6989586621679360676"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-113"></span><span>  </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Headers were not properly included in the HTTP request&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; IO ()) -&gt; Bool -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; [(Text, Text)] -&gt; Bool
</span><a href="IC.Test.Spec.HTTP.html#headers_match"><span class="hs-identifier hs-var">headers_match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; [(Text, Text)]
</span><a href="IC.Test.Spec.HTTP.html#map_to_lower"><span class="hs-identifier hs-var">map_to_lower</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679360678"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HttpRequest -&gt; HttpRequestHeaders
</span><a href="IC.Test.Spec.HTTP.html#headers"><span class="hs-identifier hs-var hs-var">headers</span></a></span><span> </span><span class="annot"><span class="annottext">HttpRequest
</span><a href="#local-6989586621679360676"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequestHeaders"><span class="hs-identifier hs-type">HttpRequestHeaders</span></a></span><span> </span><span id="local-6989586621679360675"><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679360675"><span class="hs-identifier hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; [(Text, Text)]
</span><a href="IC.Test.Spec.HTTP.html#map_to_lower"><span class="hs-identifier hs-var">map_to_lower</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679360675"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>  </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Body was not properly included in the HTTP request&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; IO ()) -&gt; Bool -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; HttpRequestBody
</span><a href="IC.Test.Spec.HTTP.html#HttpRequestBody"><span class="hs-identifier hs-var">HttpRequestBody</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679360677"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">HttpRequestBody -&gt; HttpRequestBody -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">HttpRequest -&gt; HttpRequestBody
</span><a href="IC.Test.Spec.HTTP.html#body"><span class="hs-identifier hs-var hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">HttpRequest
</span><a href="#local-6989586621679360676"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="annot"><a href="IC.Test.Spec.HTTP.html#check_http_body"><span class="hs-identifier hs-type">check_http_body</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/bytestring-0.10.12.1/src/Data.ByteString.Lazy.Internal.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-117"></span><span id="check_http_body"><span class="annot"><span class="annottext">check_http_body :: ByteString -&gt; Bool
</span><a href="IC.Test.Spec.HTTP.html#check_http_body"><span class="hs-identifier hs-var hs-var">check_http_body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; Bool
</span><a href="#local-6989586621679360673"><span class="hs-identifier hs-var">aux</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Bool)
-&gt; (ByteString -&gt; Maybe Text) -&gt; ByteString -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe Text
</span><a href="IC.Utils.html#fromUtf8"><span class="hs-identifier hs-var">fromUtf8</span></a></span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-119"></span><span>    </span><span id="local-6989586621679360673"><span class="annot"><span class="annottext">aux :: Maybe Text -&gt; Bool
</span><a href="#local-6989586621679360673"><span class="hs-identifier hs-var hs-var">aux</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-120"></span><span>    </span><span class="annot"><a href="#local-6989586621679360673"><span class="hs-identifier hs-var">aux</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679360667"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679360667"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">(==)</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'x'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Bool) -&gt; String -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Show.html#unpack"><span class="hs-identifier hs-var">T.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679360667"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="annot"><a href="IC.Test.Spec.HTTP.html#canister_http_calls"><span class="hs-identifier hs-type">canister_http_calls</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Agent.html#HasAgentConfig"><span class="hs-identifier hs-type">HasAgentConfig</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#TestSubnetConfig"><span class="hs-identifier hs-type">TestSubnetConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///nix/store/g06j82c3sqx93lq3lx6xfdryp0y61zf4-tasty-1.4.2.3-doc/share/doc/tasty-1.4.2.3/html/src/Test.Tasty.Core.html#TestTree"><span class="hs-identifier hs-type">TestTree</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-123"></span><span id="canister_http_calls"><span class="annot"><span class="annottext">canister_http_calls :: HasAgentConfig =&gt; TestSubnetConfig -&gt; [TestTree]
</span><a href="IC.Test.Spec.HTTP.html#canister_http_calls"><span class="hs-identifier hs-var hs-var">canister_http_calls</span></a></span></span><span> </span><span id="local-6989586621679359638"><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EntityId
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SubnetType
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679359637"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359637"><span class="hs-identifier hs-var">ecid_as_word64</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span class="annot"><span class="annottext">[(Word64, Word64)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359636"><span class="annot"><span class="annottext">ecid :: ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var hs-var">ecid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EntityId -&gt; ByteString
</span><a href="IC.Types.html#rawEntityId"><span class="hs-identifier hs-var hs-var">rawEntityId</span></a></span><span> </span><span class="annot"><span class="annottext">(EntityId -&gt; ByteString) -&gt; EntityId -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; EntityId
</span><a href="IC.Id.Fresh.html#wordToId"><span class="hs-identifier hs-var">wordToId</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359637"><span class="hs-identifier hs-var">ecid_as_word64</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-special">[</span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-comment">-- &quot;Currently, the GET, HEAD, and POST methods are supported for HTTP requests.&quot;</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span>    </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;GET call&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; IO ()) -&gt; TestTree)
-&gt; (ByteString -&gt; IO ()) -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679359632"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359632"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-130"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359630"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679359630"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hello_world&quot;</span></span><span>
</span><span id="line-131"></span><span>      </span><span id="local-6989586621679359629"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359629"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO
     (Rec
        ('R
           '[ &quot;body&quot; ':-&gt; ByteString,
              &quot;headers&quot;
              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
              &quot;status&quot; ':-&gt; Natural]))
forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;),
 HasAgentConfig) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_get_request"><span class="hs-identifier hs-var">ic_http_get_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359632"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ascii/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679359630"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Maybe Word64
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">666</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (String, ByteString)
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359632"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-132"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359629"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;status&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;status&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;status&quot; (Label &quot;status&quot;)
Label &quot;status&quot;
</span><a href="#local-6989586621679360642"><span class="hs-var">#status</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; IO ()
forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">200</span></span><span>
</span><span id="line-133"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359629"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;body&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;body&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;body&quot; (Label &quot;body&quot;)
Label &quot;body&quot;
</span><a href="#local-6989586621679360631"><span class="hs-var">#body</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; IO ()
forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><a href="file:///nix/store/parkwiz24n4dcrhpl7lzfmjfrwqql3ls-utf8-string-1.0.2-doc/share/doc/utf8-string-1.0.2/html/src/Data.ByteString.Lazy.UTF8.html#fromString"><span class="hs-identifier hs-var">BLU.fromString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679359630"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-134"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
HttpResponse
</span><a href="#local-6989586621679359629"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;POST call&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; IO ()) -&gt; TestTree)
-&gt; (ByteString -&gt; IO ()) -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679359624"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359624"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-137"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359623"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679359623"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="IC.Utils.html#toUtf8"><span class="hs-identifier hs-var">toUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ByteString) -&gt; Text -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Hello, world!&quot;</span></span><span>
</span><span id="line-138"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359622"><span class="annot"><span class="annottext">hs :: [(Text, Text)]
</span><a href="#local-6989586621679359622"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Name1&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value1&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Name2&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value2&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-139"></span><span>      </span><span id="local-6989586621679359621"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359621"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO
     (Rec
        ('R
           '[ &quot;body&quot; ':-&gt; ByteString,
              &quot;headers&quot;
              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
              &quot;status&quot; ':-&gt; Natural]))
forall a b.
(HasAgentConfig,
 (a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;)) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_post_request"><span class="hs-identifier hs-var">ic_http_post_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359624"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;anything&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Maybe Word64
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">666</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359623"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; Vector HttpHeader
</span><a href="IC.Test.Spec.Utils.html#vec_header_from_list_text"><span class="hs-identifier hs-var">vec_header_from_list_text</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679359622"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (String, ByteString)
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359624"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-140"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359621"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;status&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;status&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;status&quot; (Label &quot;status&quot;)
Label &quot;status&quot;
</span><a href="#local-6989586621679360613"><span class="hs-var">#status</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; IO ()
forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">200</span></span><span>
</span><span id="line-141"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
HttpResponse
</span><a href="#local-6989586621679359621"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-142"></span><span>      </span><span class="annot"><span class="annottext">String
-&gt; [(Text, Text)] -&gt; ByteString -&gt; Maybe HttpRequest -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_json"><span class="hs-identifier hs-var">check_http_json</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;POST&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679359622"><span class="hs-identifier hs-var">hs</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359623"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe HttpRequest -&gt; IO ()) -&gt; Maybe HttpRequest -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Maybe HttpRequest
forall a. FromJSON a =&gt; ByteString -&gt; Maybe a
</span><a href="file:///nix/store/lrgc0409r3969xpx8sr161n8fp0b2amn-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.html#decode"><span class="hs-identifier hs-var">decode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359621"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;body&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;body&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;body&quot; (Label &quot;body&quot;)
Label &quot;body&quot;
</span><a href="#local-6989586621679360607"><span class="hs-var">#body</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequest"><span class="hs-identifier hs-type">HttpRequest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;HEAD call&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; IO ()) -&gt; TestTree)
-&gt; (ByteString -&gt; IO ()) -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679359617"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359617"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-145"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359615"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679359615"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6666</span></span><span>
</span><span id="line-146"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359614"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679359614"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="IC.Utils.html#toUtf8"><span class="hs-identifier hs-var">toUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ByteString) -&gt; Text -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679359615"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'x'</span></span><span>
</span><span id="line-147"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359612"><span class="annot"><span class="annottext">hs :: [(Text, Text)]
</span><a href="#local-6989586621679359612"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Name1&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value1&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Name2&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value2&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-148"></span><span>      </span><span id="local-6989586621679359611"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359611"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO
     (Rec
        ('R
           '[ &quot;body&quot; ':-&gt; ByteString,
              &quot;headers&quot;
              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
              &quot;status&quot; ':-&gt; Natural]))
forall a b.
(HasAgentConfig,
 (a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;)) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_head_request"><span class="hs-identifier hs-var">ic_http_head_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359617"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;anything&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Maybe Word64
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">666</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359614"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; Vector HttpHeader
</span><a href="IC.Test.Spec.Utils.html#vec_header_from_list_text"><span class="hs-identifier hs-var">vec_header_from_list_text</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679359612"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (String, ByteString)
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359617"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-149"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359611"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;status&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;status&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;status&quot; (Label &quot;status&quot;)
Label &quot;status&quot;
</span><a href="#local-6989586621679360589"><span class="hs-var">#status</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; IO ()
forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">200</span></span><span>
</span><span id="line-150"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359611"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;body&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;body&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;body&quot; (Label &quot;body&quot;)
Label &quot;body&quot;
</span><a href="#local-6989586621679360580"><span class="hs-var">#body</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; IO ()
forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="IC.Utils.html#toUtf8"><span class="hs-identifier hs-var">toUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ByteString) -&gt; Text -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>      </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;HTTP response header names must be distinct&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; IO ()) -&gt; Bool -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Vector HttpHeader -&gt; Bool
</span><a href="IC.Test.Spec.HTTP.html#check_distinct_headers"><span class="hs-identifier hs-var">check_distinct_headers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359611"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;headers&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;headers&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;headers&quot; (Label &quot;headers&quot;)
Label &quot;headers&quot;
</span><a href="#local-6989586621679360574"><span class="hs-var">#headers</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359605"><span class="annot"><span class="annottext">h :: Maybe Text
</span><a href="#local-6989586621679359605"><span class="hs-identifier hs-var hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector HttpHeader -&gt; Text -&gt; Maybe Text
</span><a href="IC.Test.Spec.HTTP.html#http_headers_to_map"><span class="hs-identifier hs-var">http_headers_to_map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359611"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;headers&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;headers&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;headers&quot; (Label &quot;headers&quot;)
Label &quot;headers&quot;
</span><a href="#local-6989586621679359608"><span class="hs-var">#headers</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;content-length&quot;</span></span><span>
</span><span id="line-153"></span><span>      </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Content-Length must be present and at least &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679359615"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; IO ()) -&gt; Bool -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-154"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679359605"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-155"></span><span>                  </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679359604"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679359604"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Int
forall a. Read a =&gt; String -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/Text.Read.html#read"><span class="hs-identifier hs-var">read</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; String
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Show.html#unpack"><span class="hs-identifier hs-var">T.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679359604"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679359615"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-comment">-- &quot;For security reasons, only HTTPS connections are allowed (URLs must start with https://).&quot;</span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO () -&gt; TestTree
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.html#testCase"><span class="hs-identifier hs-var">testCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;url must start with https://&quot;</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; TestTree) -&gt; IO () -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-160"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359600"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679359600"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hello_world&quot;</span></span><span>
</span><span id="line-161"></span><span>      </span><span id="local-6989586621679359599"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359599"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
ByteString -&gt; Prog -&gt; IO ByteString
ByteString -&gt; Prog -&gt; IO ByteString
</span><a href="IC.Test.Spec.Utils.html#install"><span class="hs-identifier hs-var">install</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="IC.Test.Universal.html#noop"><span class="hs-identifier hs-var">noop</span></a></span><span>
</span><span id="line-162"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_get_request%27"><span class="hs-identifier hs-var">ic_http_get_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359599"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;http://&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ascii/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679359600"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (String, ByteString)
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359599"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">IO ReqResponse -&gt; (ReqResponse -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
[Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-comment">-- &quot;The size of an HTTP request from the canister is the total number of bytes representing the names and values of HTTP headers and the HTTP body. The maximal size for the request from the canister is 2MB (2,000,000B).&quot;</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum possible request size&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; IO ()) -&gt; TestTree)
-&gt; (ByteString -&gt; IO ()) -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679359594"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359594"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-167"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359593"><span class="annot"><span class="annottext">hs :: [(Text, Text)]
</span><a href="#local-6989586621679359593"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Name1&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value1&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Name2&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value2&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Content-Type&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;text/html; charset=utf-8&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-168"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359589"><span class="annot"><span class="annottext">len_hs :: Word64
</span><a href="#local-6989586621679359589"><span class="hs-identifier hs-var hs-var">len_hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word64] -&gt; Word64
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/Data.Foldable.html#sum"><span class="hs-identifier hs-var">sum</span></a></span><span> </span><span class="annot"><span class="annottext">([Word64] -&gt; Word64) -&gt; [Word64] -&gt; Word64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((Text, Text) -&gt; Word64) -&gt; [(Text, Text)] -&gt; [Word64]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679359587"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679359587"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679359586"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679359586"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Word64
</span><a href="IC.Utils.html#utf8_length"><span class="hs-identifier hs-var">utf8_length</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679359587"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Word64
</span><a href="IC.Utils.html#utf8_length"><span class="hs-identifier hs-var">utf8_length</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679359586"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679359593"><span class="hs-identifier hs-var">hs</span></a></span><span>
</span><span id="line-169"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359581"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679359581"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="IC.Utils.html#toUtf8"><span class="hs-identifier hs-var">toUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ByteString) -&gt; Text -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Int) -&gt; Word64 -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#max_request_bytes_limit"><span class="hs-identifier hs-var">max_request_bytes_limit</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359589"><span class="hs-identifier hs-var">len_hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'x'</span></span><span>
</span><span id="line-170"></span><span>      </span><span id="local-6989586621679359579"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359579"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO
     (Rec
        ('R
           '[ &quot;body&quot; ':-&gt; ByteString,
              &quot;headers&quot;
              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
              &quot;status&quot; ':-&gt; Natural]))
forall a b.
(HasAgentConfig,
 (a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;)) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_post_request"><span class="hs-identifier hs-var">ic_http_post_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359594"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;request_size&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359581"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; Vector HttpHeader
</span><a href="IC.Test.Spec.Utils.html#vec_header_from_list_text"><span class="hs-identifier hs-var">vec_header_from_list_text</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679359593"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (String, ByteString)
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359594"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-171"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359579"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;status&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;status&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;status&quot; (Label &quot;status&quot;)
Label &quot;status&quot;
</span><a href="#local-6989586621679360536"><span class="hs-var">#status</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; IO ()
forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">200</span></span><span>
</span><span id="line-172"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
HttpResponse
</span><a href="#local-6989586621679359579"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-173"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359571"><span class="annot"><span class="annottext">n :: Word64
</span><a href="#local-6989586621679359571"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Word64
forall a. Read a =&gt; String -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/Text.Read.html#read"><span class="hs-identifier hs-var">read</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; String
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Show.html#unpack"><span class="hs-identifier hs-var">T.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; String) -&gt; Text -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; Text
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/Data.Maybe.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Text) -&gt; Maybe Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe Text
</span><a href="IC.Utils.html#fromUtf8"><span class="hs-identifier hs-var">fromUtf8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359579"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;body&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;body&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;body&quot; (Label &quot;body&quot;)
Label &quot;body&quot;
</span><a href="#local-6989586621679359573"><span class="hs-var">#body</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-174"></span><span>      </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Request size must be at least (the HTTP client can add more headers) &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#max_request_bytes_limit"><span class="hs-identifier hs-var">max_request_bytes_limit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; IO ()) -&gt; Bool -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359571"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359589"><span class="hs-identifier hs-var">len_hs</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Int64
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/bytestring-0.10.12.1/src/Data.ByteString.Lazy.html#length"><span class="hs-identifier hs-var">BS.length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359581"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum possible request size exceeded&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; IO ()) -&gt; TestTree)
-&gt; (ByteString -&gt; IO ()) -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679359569"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359569"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-177"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359568"><span class="annot"><span class="annottext">hs :: [(Text, Text)]
</span><a href="#local-6989586621679359568"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Name1&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value1&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Name2&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value2&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Content-Type&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;text/html; charset=utf-8&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-178"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359564"><span class="annot"><span class="annottext">len_hs :: Word64
</span><a href="#local-6989586621679359564"><span class="hs-identifier hs-var hs-var">len_hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word64] -&gt; Word64
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/Data.Foldable.html#sum"><span class="hs-identifier hs-var">sum</span></a></span><span> </span><span class="annot"><span class="annottext">([Word64] -&gt; Word64) -&gt; [Word64] -&gt; Word64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((Text, Text) -&gt; Word64) -&gt; [(Text, Text)] -&gt; [Word64]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679359563"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679359563"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679359562"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679359562"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Word64
</span><a href="IC.Utils.html#utf8_length"><span class="hs-identifier hs-var">utf8_length</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679359563"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Word64
</span><a href="IC.Utils.html#utf8_length"><span class="hs-identifier hs-var">utf8_length</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679359562"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679359568"><span class="hs-identifier hs-var">hs</span></a></span><span>
</span><span id="line-179"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359556"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679359556"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="IC.Utils.html#toUtf8"><span class="hs-identifier hs-var">toUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ByteString) -&gt; Text -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Int) -&gt; Word64 -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#max_request_bytes_limit"><span class="hs-identifier hs-var">max_request_bytes_limit</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359564"><span class="hs-identifier hs-var">len_hs</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'x'</span></span><span>
</span><span id="line-180"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_post_request%27"><span class="hs-identifier hs-var">ic_http_post_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679359554"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359554"><span class="hs-identifier hs-var">fee</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359554"><span class="hs-identifier hs-var">fee</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359569"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359554"><span class="hs-identifier hs-var">fee</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;request_size&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359556"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; Vector HttpHeader
</span><a href="IC.Test.Spec.Utils.html#vec_header_from_list_text"><span class="hs-identifier hs-var">vec_header_from_list_text</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679359568"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (String, ByteString)
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359569"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">IO ReqResponse -&gt; (ReqResponse -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
[Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">4</span></span><span class="hs-special">]</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-comment">-- &quot;The size of an HTTP response from the remote server is the total number of bytes representing the names and values of HTTP headers and the HTTP body. Each request can specify a maximal size for the response from the remote HTTP server.&quot;</span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;small maximum possible response size&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; IO ()) -&gt; TestTree)
-&gt; (ByteString -&gt; IO ()) -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679359553"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359553"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-185"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359551"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679359551"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hello_world&quot;</span></span><span>
</span><span id="line-186"></span><span>      </span><span class="hs-comment">{- Response headers (size: 136)
          Connection: keep-alive
          Content-Type: text/html; charset=utf-8
          Content-Length: 12
          Access-Control-Allow-Origin: *
          Access-Control-Allow-Credentials: true
      -}</span><span>
</span><span id="line-193"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359549"><span class="annot"><span class="annottext">header_size :: Int
</span><a href="#local-6989586621679359549"><span class="hs-identifier hs-var hs-var">header_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">136</span></span><span>
</span><span id="line-194"></span><span>      </span><span id="local-6989586621679359548"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359548"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO
     (Rec
        ('R
           '[ &quot;body&quot; ':-&gt; ByteString,
              &quot;headers&quot;
              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
              &quot;status&quot; ':-&gt; Natural]))
forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;),
 HasAgentConfig) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_get_request"><span class="hs-identifier hs-var">ic_http_get_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359553"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ascii/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679359551"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Maybe Word64
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Maybe Word64) -&gt; Word64 -&gt; Maybe Word64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word64) -&gt; Int -&gt; Word64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679359551"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679359549"><span class="hs-identifier hs-var">header_size</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (String, ByteString)
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359553"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-195"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359548"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;status&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;status&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;status&quot; (Label &quot;status&quot;)
Label &quot;status&quot;
</span><a href="#local-6989586621679360491"><span class="hs-var">#status</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; IO ()
forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">200</span></span><span>
</span><span id="line-196"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359548"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;body&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;body&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;body&quot; (Label &quot;body&quot;)
Label &quot;body&quot;
</span><a href="#local-6989586621679360482"><span class="hs-var">#body</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; IO ()
forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><a href="file:///nix/store/parkwiz24n4dcrhpl7lzfmjfrwqql3ls-utf8-string-1.0.2-doc/share/doc/utf8-string-1.0.2/html/src/Data.ByteString.Lazy.UTF8.html#fromString"><span class="hs-identifier hs-var">BLU.fromString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679359551"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-197"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
HttpResponse
</span><a href="#local-6989586621679359548"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;small maximum possible response size exceeded&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; IO ()) -&gt; TestTree)
-&gt; (ByteString -&gt; IO ()) -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679359547"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359547"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-200"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359545"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679359545"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hello_world&quot;</span></span><span>
</span><span id="line-201"></span><span>      </span><span class="hs-comment">{- Response headers (size: 136)
          Connection: keep-alive
          Content-Type: text/html; charset=utf-8
          Content-Length: 12
          Access-Control-Allow-Origin: *
          Access-Control-Allow-Credentials: true
      -}</span><span>
</span><span id="line-208"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359543"><span class="annot"><span class="annottext">header_size :: Int
</span><a href="#local-6989586621679359543"><span class="hs-identifier hs-var hs-var">header_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">136</span></span><span>
</span><span id="line-209"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_get_request%27"><span class="hs-identifier hs-var">ic_http_get_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359547"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ascii/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679359545"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Maybe Word64
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Maybe Word64) -&gt; Word64 -&gt; Maybe Word64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word64) -&gt; Int -&gt; Word64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679359545"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679359543"><span class="hs-identifier hs-var">header_size</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (String, ByteString)
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359547"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">IO ReqResponse -&gt; (ReqResponse -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
[Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;small maximum possible response size (only headers)&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; IO ()) -&gt; TestTree)
-&gt; (ByteString -&gt; IO ()) -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679359542"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359542"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-212"></span><span>      </span><span class="hs-comment">{- Response headers (size: 136)
          Connection: keep-alive
          Content-Type: application/octet-stream
          Content-Length: 0
          Access-Control-Allow-Origin: *
          Access-Control-Allow-Credentials: true
      -}</span><span>
</span><span id="line-219"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359540"><span class="annot"><span class="annottext">header_size :: Word64
</span><a href="#local-6989586621679359540"><span class="hs-identifier hs-var hs-var">header_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">135</span></span><span>
</span><span id="line-220"></span><span>      </span><span id="local-6989586621679359539"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359539"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO
     (Rec
        ('R
           '[ &quot;body&quot; ':-&gt; ByteString,
              &quot;headers&quot;
              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
              &quot;status&quot; ':-&gt; Natural]))
forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;),
 HasAgentConfig) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_get_request"><span class="hs-identifier hs-var">ic_http_get_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359542"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;equal_bytes/0&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Maybe Word64
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359540"><span class="hs-identifier hs-var">header_size</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (String, ByteString)
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359542"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-221"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359539"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;status&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;status&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;status&quot; (Label &quot;status&quot;)
Label &quot;status&quot;
</span><a href="#local-6989586621679360448"><span class="hs-var">#status</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; IO ()
forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">200</span></span><span>
</span><span id="line-222"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359539"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;body&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;body&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;body&quot; (Label &quot;body&quot;)
Label &quot;body&quot;
</span><a href="#local-6989586621679360439"><span class="hs-var">#body</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; IO ()
forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/bytestring-0.10.12.1/src/Data.ByteString.Lazy.html#empty"><span class="hs-identifier hs-var">BS.empty</span></a></span><span>
</span><span id="line-223"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
HttpResponse
</span><a href="#local-6989586621679359539"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;small maximum possible response size (only headers) exceeded&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; IO ()) -&gt; TestTree)
-&gt; (ByteString -&gt; IO ()) -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679359537"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359537"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-226"></span><span>      </span><span class="hs-comment">{- Response headers (size: 136)
          Connection: keep-alive
          Content-Type: application/octet-stream
          Content-Length: 0
          Access-Control-Allow-Origin: *
          Access-Control-Allow-Credentials: true
      -}</span><span>
</span><span id="line-233"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359535"><span class="annot"><span class="annottext">header_size :: Word64
</span><a href="#local-6989586621679359535"><span class="hs-identifier hs-var hs-var">header_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">135</span></span><span>
</span><span id="line-234"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_get_request%27"><span class="hs-identifier hs-var">ic_http_get_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359537"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;equal_bytes/0&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Maybe Word64
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Maybe Word64) -&gt; Word64 -&gt; Maybe Word64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359535"><span class="hs-identifier hs-var">header_size</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (String, ByteString)
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359537"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">IO ReqResponse -&gt; (ReqResponse -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
[Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-comment">-- &quot;The upper limit on the maximal size for the response is 2MB (2,000,000B) and this value also applies if no maximal size value is specified.&quot;</span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO () -&gt; TestTree
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.html#testCase"><span class="hs-identifier hs-var">testCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;large maximum possible response size&quot;</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; TestTree) -&gt; IO () -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-239"></span><span>      </span><span class="hs-comment">{- Response headers (size: 141)
          Connection: keep-alive
          Content-Type: application/octet-stream
          Content-Length: 1999859
          Access-Control-Allow-Origin: *
          Access-Control-Allow-Credentials: true
      -}</span><span>
</span><span id="line-246"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359533"><span class="annot"><span class="annottext">header_size :: Word64
</span><a href="#local-6989586621679359533"><span class="hs-identifier hs-var hs-var">header_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">141</span></span><span>
</span><span id="line-247"></span><span>      </span><span id="local-6989586621679359532"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359532"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
ByteString -&gt; Prog -&gt; IO ByteString
ByteString -&gt; Prog -&gt; IO ByteString
</span><a href="IC.Test.Spec.Utils.html#install"><span class="hs-identifier hs-var">install</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#onTransform"><span class="hs-identifier hs-var">onTransform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#callback"><span class="hs-identifier hs-var">callback</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#replyData"><span class="hs-identifier hs-var">replyData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; ByteString
forall a. CandidArg a =&gt; a -&gt; ByteString
</span><a href="file:///nix/store/5q8knwbpcq1xjhfifih1jfwmvd2jr0sg-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Class.html#encode"><span class="hs-identifier hs-var">Candid.encode</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
HttpResponse
</span><a href="IC.Test.Spec.Utils.html#dummyResponse"><span class="hs-identifier hs-var">dummyResponse</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>      </span><span id="local-6989586621679359525"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359525"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO
     (Rec
        ('R
           '[ &quot;body&quot; ':-&gt; ByteString,
              &quot;headers&quot;
              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
              &quot;status&quot; ':-&gt; Natural]))
forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;),
 HasAgentConfig) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_get_request"><span class="hs-identifier hs-var">ic_http_get_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359532"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;equal_bytes/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#max_response_bytes_limit"><span class="hs-identifier hs-var">max_response_bytes_limit</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359533"><span class="hs-identifier hs-var">header_size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String, ByteString) -&gt; Maybe (String, ByteString)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;transform&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359532"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-249"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359525"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;status&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;status&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;status&quot; (Label &quot;status&quot;)
Label &quot;status&quot;
</span><a href="#local-6989586621679360401"><span class="hs-var">#status</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; IO ()
forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">202</span></span><span>
</span><span id="line-250"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359525"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;body&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;body&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;body&quot; (Label &quot;body&quot;)
Label &quot;body&quot;
</span><a href="#local-6989586621679360392"><span class="hs-var">#body</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; IO ()
forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Dummy!&quot;</span></span><span>
</span><span id="line-251"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
HttpResponse
</span><a href="#local-6989586621679359525"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO () -&gt; TestTree
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.html#testCase"><span class="hs-identifier hs-var">testCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;large maximum possible response size exceeded&quot;</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; TestTree) -&gt; IO () -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-254"></span><span>      </span><span class="hs-comment">{- Response headers (size: 141)
          Connection: keep-alive
          Content-Type: application/octet-stream
          Content-Length: 1999860
          Access-Control-Allow-Origin: *
          Access-Control-Allow-Credentials: true
      -}</span><span>
</span><span id="line-261"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359522"><span class="annot"><span class="annottext">header_size :: Word64
</span><a href="#local-6989586621679359522"><span class="hs-identifier hs-var hs-var">header_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">141</span></span><span>
</span><span id="line-262"></span><span>      </span><span id="local-6989586621679359521"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359521"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
ByteString -&gt; Prog -&gt; IO ByteString
ByteString -&gt; Prog -&gt; IO ByteString
</span><a href="IC.Test.Spec.Utils.html#install"><span class="hs-identifier hs-var">install</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#onTransform"><span class="hs-identifier hs-var">onTransform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#callback"><span class="hs-identifier hs-var">callback</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#replyData"><span class="hs-identifier hs-var">replyData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; ByteString
forall a. CandidArg a =&gt; a -&gt; ByteString
</span><a href="file:///nix/store/5q8knwbpcq1xjhfifih1jfwmvd2jr0sg-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Class.html#encode"><span class="hs-identifier hs-var">Candid.encode</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
HttpResponse
</span><a href="IC.Test.Spec.Utils.html#dummyResponse"><span class="hs-identifier hs-var">dummyResponse</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_get_request%27"><span class="hs-identifier hs-var">ic_http_get_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359521"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;equal_bytes/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#max_response_bytes_limit"><span class="hs-identifier hs-var">max_response_bytes_limit</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359522"><span class="hs-identifier hs-var">header_size</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String, ByteString) -&gt; Maybe (String, ByteString)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;transform&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359521"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">IO ReqResponse -&gt; (ReqResponse -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
[Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span>    </span><span class="hs-comment">-- &quot;The URL must be valid according to RFC-3986 and its length must not exceed 8192.&quot;</span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;non-ascii URL&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; IO ()) -&gt; TestTree)
-&gt; (ByteString -&gt; IO ()) -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679359520"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359520"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-268"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_get_request%27"><span class="hs-identifier hs-var">ic_http_get_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359520"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ascii/&#50504;&#45397;&#54616;&#49464;&#50836;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (String, ByteString)
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359520"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">IO ReqResponse -&gt; (ReqResponse -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
[Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum possible url size&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; IO ()) -&gt; TestTree)
-&gt; (ByteString -&gt; IO ()) -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679359519"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359519"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-271"></span><span>      </span><span id="local-6989586621679359518"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359518"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b.
(HasAgentConfig,
 (a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;)) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO
     (Rec
        ('R
           '[ &quot;body&quot; ':-&gt; ByteString,
              &quot;headers&quot;
              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
              &quot;status&quot; ':-&gt; Natural]))
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_long_url_http_request"><span class="hs-identifier hs-var">ic_long_url_http_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359519"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#max_http_request_url_length"><span class="hs-identifier hs-var">max_http_request_url_length</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (String, ByteString)
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359519"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-272"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359518"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;status&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;status&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;status&quot; (Label &quot;status&quot;)
Label &quot;status&quot;
</span><a href="#local-6989586621679360345"><span class="hs-var">#status</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; IO ()
forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">200</span></span><span>
</span><span id="line-273"></span><span>      </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;HTTP response body is malformed&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; IO ()) -&gt; Bool -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><a href="IC.Test.Spec.HTTP.html#check_http_body"><span class="hs-identifier hs-var">check_http_body</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Bool) -&gt; ByteString -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359518"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;body&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;body&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;body&quot; (Label &quot;body&quot;)
Label &quot;body&quot;
</span><a href="#local-6989586621679360338"><span class="hs-var">#body</span></a></span><span>
</span><span id="line-274"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
HttpResponse
</span><a href="#local-6989586621679359518"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum possible url size exceeded&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; IO ()) -&gt; TestTree)
-&gt; (ByteString -&gt; IO ()) -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679359515"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359515"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-277"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_long_url_http_request%27"><span class="hs-identifier hs-var">ic_long_url_http_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679359513"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359513"><span class="hs-identifier hs-var">fee</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359513"><span class="hs-identifier hs-var">fee</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359515"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359513"><span class="hs-identifier hs-var">fee</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#max_http_request_url_length"><span class="hs-identifier hs-var">max_http_request_url_length</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (String, ByteString)
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359515"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">IO ReqResponse -&gt; (ReqResponse -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
[Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">4</span></span><span class="hs-special">]</span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span>    </span><span class="hs-comment">-- &quot;max_response_bytes - If provided, the value must not exceed 2MB (2,000,000B).&quot;</span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum possible value of max_response_bytes&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; IO ()) -&gt; TestTree)
-&gt; (ByteString -&gt; IO ()) -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679359512"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359512"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-282"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359510"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679359510"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hello_world&quot;</span></span><span>
</span><span id="line-283"></span><span>      </span><span id="local-6989586621679359509"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359509"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO
     (Rec
        ('R
           '[ &quot;body&quot; ':-&gt; ByteString,
              &quot;headers&quot;
              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
              &quot;status&quot; ':-&gt; Natural]))
forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;),
 HasAgentConfig) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_get_request"><span class="hs-identifier hs-var">ic_http_get_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359512"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ascii/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679359510"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Maybe Word64
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#max_response_bytes_limit"><span class="hs-identifier hs-var">max_response_bytes_limit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (String, ByteString)
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359512"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-284"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359509"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;status&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;status&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;status&quot; (Label &quot;status&quot;)
Label &quot;status&quot;
</span><a href="#local-6989586621679360309"><span class="hs-var">#status</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; IO ()
forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">200</span></span><span>
</span><span id="line-285"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359509"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;body&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;body&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;body&quot; (Label &quot;body&quot;)
Label &quot;body&quot;
</span><a href="#local-6989586621679360300"><span class="hs-var">#body</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; IO ()
forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><a href="file:///nix/store/parkwiz24n4dcrhpl7lzfmjfrwqql3ls-utf8-string-1.0.2-doc/share/doc/utf8-string-1.0.2/html/src/Data.ByteString.Lazy.UTF8.html#fromString"><span class="hs-identifier hs-var">BLU.fromString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679359510"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-286"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
HttpResponse
</span><a href="#local-6989586621679359509"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum possible value of max_response_bytes exceeded&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; IO ()) -&gt; TestTree)
-&gt; (ByteString -&gt; IO ()) -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679359508"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359508"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-289"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359506"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679359506"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hello_world&quot;</span></span><span>
</span><span id="line-290"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_get_request%27"><span class="hs-identifier hs-var">ic_http_get_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679359505"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359505"><span class="hs-identifier hs-var">fee</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359505"><span class="hs-identifier hs-var">fee</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359508"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359505"><span class="hs-identifier hs-var">fee</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ascii/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679359506"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Maybe Word64
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Maybe Word64) -&gt; Word64 -&gt; Maybe Word64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#max_response_bytes_limit"><span class="hs-identifier hs-var">max_response_bytes_limit</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (String, ByteString)
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359508"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">IO ReqResponse -&gt; (ReqResponse -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
[Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">4</span></span><span class="hs-special">]</span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span>    </span><span class="hs-comment">-- &quot;transform - an optional record that includes a function that transforms raw responses to sanitized responses, and a byte-encoded context that is provided to the function upon invocation, along with the response to be sanitized.&quot;</span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO () -&gt; TestTree
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.html#testCase"><span class="hs-identifier hs-var">testCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;call with simple transform&quot;</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; TestTree) -&gt; IO () -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-295"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359504"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679359504"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="IC.Utils.html#toUtf8"><span class="hs-identifier hs-var">toUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ByteString) -&gt; Text -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Hello, world!&quot;</span></span><span>
</span><span id="line-296"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359503"><span class="annot"><span class="annottext">hs :: Vector HttpHeader
</span><a href="#local-6989586621679359503"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; Vector HttpHeader
</span><a href="IC.Test.Spec.Utils.html#vec_header_from_list_text"><span class="hs-identifier hs-var">vec_header_from_list_text</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Name1&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value1&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Name2&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value2&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-297"></span><span>      </span><span id="local-6989586621679359502"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359502"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
ByteString -&gt; Prog -&gt; IO ByteString
ByteString -&gt; Prog -&gt; IO ByteString
</span><a href="IC.Test.Spec.Utils.html#install"><span class="hs-identifier hs-var">install</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#onTransform"><span class="hs-identifier hs-var">onTransform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#callback"><span class="hs-identifier hs-var">callback</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#replyData"><span class="hs-identifier hs-var">replyData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; ByteString
forall a. CandidArg a =&gt; a -&gt; ByteString
</span><a href="file:///nix/store/5q8knwbpcq1xjhfifih1jfwmvd2jr0sg-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Class.html#encode"><span class="hs-identifier hs-var">Candid.encode</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
HttpResponse
</span><a href="IC.Test.Spec.Utils.html#dummyResponse"><span class="hs-identifier hs-var">dummyResponse</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>      </span><span id="local-6989586621679359501"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359501"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO
     (Rec
        ('R
           '[ &quot;body&quot; ':-&gt; ByteString,
              &quot;headers&quot;
              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
              &quot;status&quot; ':-&gt; Natural]))
forall a b.
(HasAgentConfig,
 (a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;)) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_post_request"><span class="hs-identifier hs-var">ic_http_post_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359502"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;anything&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Maybe Word64
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">666</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359504"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text]))
Vector HttpHeader
</span><a href="#local-6989586621679359503"><span class="hs-identifier hs-var">hs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String, ByteString) -&gt; Maybe (String, ByteString)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;transform&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359502"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-299"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359501"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;status&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;status&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;status&quot; (Label &quot;status&quot;)
Label &quot;status&quot;
</span><a href="#local-6989586621679360266"><span class="hs-var">#status</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; IO ()
forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">202</span></span><span>
</span><span id="line-300"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359501"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;body&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;body&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;body&quot; (Label &quot;body&quot;)
Label &quot;body&quot;
</span><a href="#local-6989586621679360257"><span class="hs-var">#body</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; IO ()
forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Dummy!&quot;</span></span><span>
</span><span id="line-301"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
HttpResponse
</span><a href="#local-6989586621679359501"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO () -&gt; TestTree
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.html#testCase"><span class="hs-identifier hs-var">testCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;reflect transform context&quot;</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; TestTree) -&gt; IO () -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-304"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359499"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679359499"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hello_world&quot;</span></span><span>
</span><span id="line-305"></span><span>      </span><span id="local-6989586621679359498"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359498"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
ByteString -&gt; Prog -&gt; IO ByteString
ByteString -&gt; Prog -&gt; IO ByteString
</span><a href="IC.Test.Spec.Utils.html#install"><span class="hs-identifier hs-var">install</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#onTransform"><span class="hs-identifier hs-var">onTransform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#callback"><span class="hs-identifier hs-var">callback</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#replyData"><span class="hs-identifier hs-var">replyData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#getHttpReplyWithBody"><span class="hs-identifier hs-var">getHttpReplyWithBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#getHttpTransformContext"><span class="hs-identifier hs-var">getHttpTransformContext</span></a></span><span> </span><span class="annot"><span class="annottext">Exp 'B
</span><a href="IC.Test.Universal.html#argData"><span class="hs-identifier hs-var">argData</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>      </span><span id="local-6989586621679359494"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359494"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO
     (Rec
        ('R
           '[ &quot;body&quot; ':-&gt; ByteString,
              &quot;headers&quot;
              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
              &quot;status&quot; ':-&gt; Natural]))
forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;),
 HasAgentConfig) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_get_request"><span class="hs-identifier hs-var">ic_http_get_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359498"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ascii/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679359499"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String, ByteString) -&gt; Maybe (String, ByteString)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;transform&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;asdf&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359498"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-307"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359494"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;status&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;status&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;status&quot; (Label &quot;status&quot;)
Label &quot;status&quot;
</span><a href="#local-6989586621679360235"><span class="hs-var">#status</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; IO ()
forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">200</span></span><span>
</span><span id="line-308"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359494"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;body&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;body&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;body&quot; (Label &quot;body&quot;)
Label &quot;body&quot;
</span><a href="#local-6989586621679360227"><span class="hs-var">#body</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; IO ()
forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;asdf&quot;</span></span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span>    </span><span class="hs-comment">-- &quot;If provided, the calling canister itself must export this (transform) function.&quot;</span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO () -&gt; TestTree
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.html#testCase"><span class="hs-identifier hs-var">testCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;non-existent transform function&quot;</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; TestTree) -&gt; IO () -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-313"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359492"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679359492"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hello_world&quot;</span></span><span>
</span><span id="line-314"></span><span>      </span><span id="local-6989586621679359491"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359491"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
ByteString -&gt; Prog -&gt; IO ByteString
ByteString -&gt; Prog -&gt; IO ByteString
</span><a href="IC.Test.Spec.Utils.html#install"><span class="hs-identifier hs-var">install</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="IC.Test.Universal.html#noop"><span class="hs-identifier hs-var">noop</span></a></span><span>
</span><span id="line-315"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_get_request%27"><span class="hs-identifier hs-var">ic_http_get_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359491"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ascii/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679359492"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String, ByteString) -&gt; Maybe (String, ByteString)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;nonExistent&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359491"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">IO ReqResponse -&gt; (ReqResponse -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
[Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">3</span></span><span class="hs-special">]</span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO () -&gt; TestTree
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.html#testCase"><span class="hs-identifier hs-var">testCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;reference to a transform function exposed by another canister&quot;</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; TestTree) -&gt; IO () -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-318"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359489"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679359489"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hello_world&quot;</span></span><span>
</span><span id="line-319"></span><span>      </span><span id="local-6989586621679359488"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359488"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
ByteString -&gt; Prog -&gt; IO ByteString
ByteString -&gt; Prog -&gt; IO ByteString
</span><a href="IC.Test.Spec.Utils.html#install"><span class="hs-identifier hs-var">install</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="IC.Test.Universal.html#noop"><span class="hs-identifier hs-var">noop</span></a></span><span>
</span><span id="line-320"></span><span>      </span><span id="local-6989586621679359487"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359487"><span class="hs-identifier hs-var">cid2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
ByteString -&gt; Prog -&gt; IO ByteString
ByteString -&gt; Prog -&gt; IO ByteString
</span><a href="IC.Test.Spec.Utils.html#install"><span class="hs-identifier hs-var">install</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#onTransform"><span class="hs-identifier hs-var">onTransform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#callback"><span class="hs-identifier hs-var">callback</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#replyData"><span class="hs-identifier hs-var">replyData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; ByteString
forall a. CandidArg a =&gt; a -&gt; ByteString
</span><a href="file:///nix/store/5q8knwbpcq1xjhfifih1jfwmvd2jr0sg-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Class.html#encode"><span class="hs-identifier hs-var">Candid.encode</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
HttpResponse
</span><a href="IC.Test.Spec.Utils.html#dummyResponse"><span class="hs-identifier hs-var">dummyResponse</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_get_request%27"><span class="hs-identifier hs-var">ic_http_get_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679359486"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359486"><span class="hs-identifier hs-var">fee</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359486"><span class="hs-identifier hs-var">fee</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359488"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359486"><span class="hs-identifier hs-var">fee</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ascii/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679359489"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String, ByteString) -&gt; Maybe (String, ByteString)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;transform&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359487"><span class="hs-identifier hs-var">cid2</span></a></span><span> </span><span class="annot"><span class="annottext">IO ReqResponse -&gt; (ReqResponse -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
[Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">4</span></span><span class="hs-special">]</span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span>    </span><span class="hs-comment">-- &quot;The maximal number of bytes representing the response produced by the transform function is 2MB (2,000,000B).&quot;</span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO () -&gt; TestTree
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.html#testCase"><span class="hs-identifier hs-var">testCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum possible canister response size&quot;</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; TestTree) -&gt; IO () -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-326"></span><span>      </span><span class="hs-comment">{- Response headers (size: 141)
          Connection: keep-alive
          Content-Type: application/octet-stream
          Content-Length: 1999859
          Access-Control-Allow-Origin: *
          Access-Control-Allow-Credentials: true
      -}</span><span>
</span><span id="line-333"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359484"><span class="annot"><span class="annottext">header_size :: Word64
</span><a href="#local-6989586621679359484"><span class="hs-identifier hs-var hs-var">header_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">141</span></span><span>
</span><span id="line-334"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359483"><span class="annot"><span class="annottext">size :: Word32
</span><a href="#local-6989586621679359483"><span class="hs-identifier hs-var hs-var">size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="IC.Test.Spec.Utils.html#maximumSizeResponseBodySize"><span class="hs-identifier hs-var">maximumSizeResponseBodySize</span></a></span><span>
</span><span id="line-335"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359474"><span class="annot"><span class="annottext">new_pages :: Exp 'I
</span><a href="#local-6989586621679359474"><span class="hs-identifier hs-var hs-var">new_pages</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Exp 'I
</span><a href="IC.Test.Universal.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Exp 'I) -&gt; Word32 -&gt; Exp 'I
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679359483"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Real.html#div"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">64</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1024</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span>
</span><span id="line-336"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359470"><span class="annot"><span class="annottext">max_size :: Exp 'I
</span><a href="#local-6989586621679359470"><span class="hs-identifier hs-var hs-var">max_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Exp 'I
</span><a href="IC.Test.Universal.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Exp 'I) -&gt; Word32 -&gt; Exp 'I
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679359483"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-337"></span><span>      </span><span id="local-6989586621679359469"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359469"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
ByteString -&gt; Prog -&gt; IO ByteString
ByteString -&gt; Prog -&gt; IO ByteString
</span><a href="IC.Test.Spec.Utils.html#install"><span class="hs-identifier hs-var">install</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#onTransform"><span class="hs-identifier hs-var">onTransform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#callback"><span class="hs-identifier hs-var">callback</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'I -&gt; Prog
forall (t :: T). Exp t -&gt; Prog
</span><a href="IC.Test.Universal.html#ignore"><span class="hs-identifier hs-var">ignore</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'I -&gt; Exp 'I
</span><a href="IC.Test.Universal.html#stableGrow"><span class="hs-identifier hs-var">stableGrow</span></a></span><span> </span><span class="annot"><span class="annottext">Exp 'I
</span><a href="#local-6989586621679359474"><span class="hs-identifier hs-var">new_pages</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Prog -&gt; Prog
</span><a href="IC.Test.Universal.html#%3E%3E%3E"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp 'I -&gt; Exp 'I -&gt; Exp 'I -&gt; Prog
</span><a href="IC.Test.Universal.html#stableFill"><span class="hs-identifier hs-var">stableFill</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Exp 'I
</span><a href="IC.Test.Universal.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Exp 'I
</span><a href="IC.Test.Universal.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">120</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp 'I
</span><a href="#local-6989586621679359470"><span class="hs-identifier hs-var">max_size</span></a></span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Prog -&gt; Prog
</span><a href="IC.Test.Universal.html#%3E%3E%3E"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#replyData"><span class="hs-identifier hs-var">replyData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#getHttpReplyWithBody"><span class="hs-identifier hs-var">getHttpReplyWithBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'I -&gt; Exp 'I -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#stableRead"><span class="hs-identifier hs-var">stableRead</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Exp 'I
</span><a href="IC.Test.Universal.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp 'I
</span><a href="#local-6989586621679359470"><span class="hs-identifier hs-var">max_size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>      </span><span id="local-6989586621679359463"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359463"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO
     (Rec
        ('R
           '[ &quot;body&quot; ':-&gt; ByteString,
              &quot;headers&quot;
              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
              &quot;status&quot; ':-&gt; Natural]))
forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;),
 HasAgentConfig) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_get_request"><span class="hs-identifier hs-var">ic_http_get_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359469"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;equal_bytes/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#max_response_bytes_limit"><span class="hs-identifier hs-var">max_response_bytes_limit</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359484"><span class="hs-identifier hs-var">header_size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String, ByteString) -&gt; Maybe (String, ByteString)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;transform&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359469"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-339"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359463"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;status&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;status&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;status&quot; (Label &quot;status&quot;)
Label &quot;status&quot;
</span><a href="#local-6989586621679360167"><span class="hs-var">#status</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; IO ()
forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">200</span></span><span>
</span><span id="line-340"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359463"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;body&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;body&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;body&quot; (Label &quot;body&quot;)
Label &quot;body&quot;
</span><a href="#local-6989586621679360159"><span class="hs-var">#body</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; IO ()
forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; ByteString
</span><a href="IC.Test.Spec.Utils.html#bodyOfSize"><span class="hs-identifier hs-var">bodyOfSize</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="IC.Test.Spec.Utils.html#maximumSizeResponseBodySize"><span class="hs-identifier hs-var">maximumSizeResponseBodySize</span></a></span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO () -&gt; TestTree
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.html#testCase"><span class="hs-identifier hs-var">testCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum possible canister response size exceeded&quot;</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; TestTree) -&gt; IO () -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-343"></span><span>      </span><span class="hs-comment">{- Response headers (size: 141)
          Connection: keep-alive
          Content-Type: application/octet-stream
          Content-Length: 1999859
          Access-Control-Allow-Origin: *
          Access-Control-Allow-Credentials: true
      -}</span><span>
</span><span id="line-350"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359460"><span class="annot"><span class="annottext">header_size :: Word64
</span><a href="#local-6989586621679359460"><span class="hs-identifier hs-var hs-var">header_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">141</span></span><span>
</span><span id="line-351"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359457"><span class="annot"><span class="annottext">size :: Word32
</span><a href="#local-6989586621679359457"><span class="hs-identifier hs-var hs-var">size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="IC.Test.Spec.Utils.html#maximumSizeResponseBodySize"><span class="hs-identifier hs-var">maximumSizeResponseBodySize</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span>
</span><span id="line-352"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359450"><span class="annot"><span class="annottext">new_pages :: Exp 'I
</span><a href="#local-6989586621679359450"><span class="hs-identifier hs-var hs-var">new_pages</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Exp 'I
</span><a href="IC.Test.Universal.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Exp 'I) -&gt; Word32 -&gt; Exp 'I
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679359457"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Real.html#div"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">64</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1024</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span>
</span><span id="line-353"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359449"><span class="annot"><span class="annottext">max_size :: Exp 'I
</span><a href="#local-6989586621679359449"><span class="hs-identifier hs-var hs-var">max_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Exp 'I
</span><a href="IC.Test.Universal.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Exp 'I) -&gt; Word32 -&gt; Exp 'I
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679359457"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-354"></span><span>      </span><span id="local-6989586621679359448"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359448"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
ByteString -&gt; Prog -&gt; IO ByteString
ByteString -&gt; Prog -&gt; IO ByteString
</span><a href="IC.Test.Spec.Utils.html#install"><span class="hs-identifier hs-var">install</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#onTransform"><span class="hs-identifier hs-var">onTransform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#callback"><span class="hs-identifier hs-var">callback</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'I -&gt; Prog
forall (t :: T). Exp t -&gt; Prog
</span><a href="IC.Test.Universal.html#ignore"><span class="hs-identifier hs-var">ignore</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'I -&gt; Exp 'I
</span><a href="IC.Test.Universal.html#stableGrow"><span class="hs-identifier hs-var">stableGrow</span></a></span><span> </span><span class="annot"><span class="annottext">Exp 'I
</span><a href="#local-6989586621679359450"><span class="hs-identifier hs-var">new_pages</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Prog -&gt; Prog
</span><a href="IC.Test.Universal.html#%3E%3E%3E"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp 'I -&gt; Exp 'I -&gt; Exp 'I -&gt; Prog
</span><a href="IC.Test.Universal.html#stableFill"><span class="hs-identifier hs-var">stableFill</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Exp 'I
</span><a href="IC.Test.Universal.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Exp 'I
</span><a href="IC.Test.Universal.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">120</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp 'I
</span><a href="#local-6989586621679359449"><span class="hs-identifier hs-var">max_size</span></a></span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Prog -&gt; Prog
</span><a href="IC.Test.Universal.html#%3E%3E%3E"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#replyData"><span class="hs-identifier hs-var">replyData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#getHttpReplyWithBody"><span class="hs-identifier hs-var">getHttpReplyWithBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'I -&gt; Exp 'I -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#stableRead"><span class="hs-identifier hs-var">stableRead</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Exp 'I
</span><a href="IC.Test.Universal.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp 'I
</span><a href="#local-6989586621679359449"><span class="hs-identifier hs-var">max_size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_get_request%27"><span class="hs-identifier hs-var">ic_http_get_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359448"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;equal_bytes/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#max_response_bytes_limit"><span class="hs-identifier hs-var">max_response_bytes_limit</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359460"><span class="hs-identifier hs-var">header_size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String, ByteString) -&gt; Maybe (String, ByteString)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;transform&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359448"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">IO ReqResponse -&gt; (ReqResponse -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
[Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span>    </span><span class="hs-comment">-- &quot;When the transform function is invoked by the system due to a canister HTTP request, the caller's identity is the principal of the management canister.&quot;</span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO () -&gt; TestTree
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.html#testCase"><span class="hs-identifier hs-var">testCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;check caller of transform&quot;</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; TestTree) -&gt; IO () -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-360"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359446"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679359446"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hello_world&quot;</span></span><span>
</span><span id="line-361"></span><span>      </span><span id="local-6989586621679359445"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359445"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
ByteString -&gt; Prog -&gt; IO ByteString
ByteString -&gt; Prog -&gt; IO ByteString
</span><a href="IC.Test.Spec.Utils.html#install"><span class="hs-identifier hs-var">install</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#onTransform"><span class="hs-identifier hs-var">onTransform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#callback"><span class="hs-identifier hs-var">callback</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Prog
</span><a href="IC.Test.Universal.html#replyData"><span class="hs-identifier hs-var">replyData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#getHttpReplyWithBody"><span class="hs-identifier hs-var">getHttpReplyWithBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp 'B -&gt; Exp 'B
</span><a href="IC.Test.Universal.html#parsePrincipal"><span class="hs-identifier hs-var">parsePrincipal</span></a></span><span> </span><span class="annot"><span class="annottext">Exp 'B
</span><a href="IC.Test.Universal.html#caller"><span class="hs-identifier hs-var">caller</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>      </span><span id="local-6989586621679359442"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359442"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO
     (Rec
        ('R
           '[ &quot;body&quot; ':-&gt; ByteString,
              &quot;headers&quot;
              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
              &quot;status&quot; ':-&gt; Natural]))
forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;),
 HasAgentConfig) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_get_request"><span class="hs-identifier hs-var">ic_http_get_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359445"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ascii/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679359446"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String, ByteString) -&gt; Maybe (String, ByteString)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;transform&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;caller&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359445"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-363"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359442"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;status&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;status&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;status&quot; (Label &quot;status&quot;)
Label &quot;status&quot;
</span><a href="#local-6989586621679360119"><span class="hs-var">#status</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; IO ()
forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">200</span></span><span>
</span><span id="line-364"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359442"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;body&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;body&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;body&quot; (Label &quot;body&quot;)
Label &quot;body&quot;
</span><a href="#local-6989586621679360111"><span class="hs-var">#body</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; IO ()
forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;aaaaa-aa&quot;</span></span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span>    </span><span class="hs-comment">-- &quot;The following additional limits apply to HTTP requests and HTTP responses from the remote sever: the number of headers must not exceed 64.&quot;</span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum number of request headers&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; IO ()) -&gt; TestTree)
-&gt; (ByteString -&gt; IO ()) -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679359441"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359441"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-369"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359440"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679359440"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="IC.Utils.html#toUtf8"><span class="hs-identifier hs-var">toUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ByteString) -&gt; Text -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Hello, world!&quot;</span></span><span>
</span><span id="line-370"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359429"><span class="annot"><span class="annottext">hs :: [(Text, Text)]
</span><a href="#local-6989586621679359429"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Name&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679359428"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679359428"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679359428"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679359428"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="IC.Constants.html#http_headers_max_number"><span class="hs-identifier hs-var">http_headers_max_number</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-371"></span><span>      </span><span id="local-6989586621679359426"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359426"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO
     (Rec
        ('R
           '[ &quot;body&quot; ':-&gt; ByteString,
              &quot;headers&quot;
              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
              &quot;status&quot; ':-&gt; Natural]))
forall a b.
(HasAgentConfig,
 (a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;)) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_post_request"><span class="hs-identifier hs-var">ic_http_post_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359441"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;anything&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359440"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; Vector HttpHeader
</span><a href="IC.Test.Spec.Utils.html#vec_header_from_list_text"><span class="hs-identifier hs-var">vec_header_from_list_text</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679359429"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (String, ByteString)
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359441"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-372"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359426"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;status&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;status&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;status&quot; (Label &quot;status&quot;)
Label &quot;status&quot;
</span><a href="#local-6989586621679360093"><span class="hs-var">#status</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; IO ()
forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">200</span></span><span>
</span><span id="line-373"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
HttpResponse
</span><a href="#local-6989586621679359426"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-374"></span><span>      </span><span class="annot"><span class="annottext">String
-&gt; [(Text, Text)] -&gt; ByteString -&gt; Maybe HttpRequest -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_json"><span class="hs-identifier hs-var">check_http_json</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;POST&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679359429"><span class="hs-identifier hs-var">hs</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359440"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe HttpRequest -&gt; IO ()) -&gt; Maybe HttpRequest -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Maybe HttpRequest
forall a. FromJSON a =&gt; ByteString -&gt; Maybe a
</span><a href="file:///nix/store/lrgc0409r3969xpx8sr161n8fp0b2amn-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.html#decode"><span class="hs-identifier hs-var">decode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359426"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;body&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;body&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;body&quot; (Label &quot;body&quot;)
Label &quot;body&quot;
</span><a href="#local-6989586621679360087"><span class="hs-var">#body</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequest"><span class="hs-identifier hs-type">HttpRequest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum number of request headers exceeded&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; IO ()) -&gt; TestTree)
-&gt; (ByteString -&gt; IO ()) -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679359425"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359425"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-377"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359424"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679359424"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="IC.Utils.html#toUtf8"><span class="hs-identifier hs-var">toUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ByteString) -&gt; Text -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Hello, world!&quot;</span></span><span>
</span><span id="line-378"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359416"><span class="annot"><span class="annottext">hs :: [(Text, Text)]
</span><a href="#local-6989586621679359416"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Name&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679359415"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679359415"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679359415"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679359415"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="IC.Constants.html#http_headers_max_number"><span class="hs-identifier hs-var">http_headers_max_number</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-379"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_post_request%27"><span class="hs-identifier hs-var">ic_http_post_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679359414"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359414"><span class="hs-identifier hs-var">fee</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359414"><span class="hs-identifier hs-var">fee</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359425"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359414"><span class="hs-identifier hs-var">fee</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;anything&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359424"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; Vector HttpHeader
</span><a href="IC.Test.Spec.Utils.html#vec_header_from_list_text"><span class="hs-identifier hs-var">vec_header_from_list_text</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679359416"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (String, ByteString)
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359425"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">IO ReqResponse -&gt; (ReqResponse -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
[Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">4</span></span><span class="hs-special">]</span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum number of response headers&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; IO ()) -&gt; TestTree)
-&gt; (ByteString -&gt; IO ()) -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679359413"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359413"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-382"></span><span>      </span><span class="hs-comment">{- These 5 response headers are always included:
          Connection: keep-alive
          Content-Type: text/html; charset=utf-8
          Content-Length: 0
          Access-Control-Allow-Origin: *
          Access-Control-Allow-Credentials: true
      -}</span><span>
</span><span id="line-389"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359410"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679359410"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="IC.Constants.html#http_headers_max_number"><span class="hs-identifier hs-var">http_headers_max_number</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span>
</span><span id="line-390"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359400"><span class="annot"><span class="annottext">hs :: [(Text, Text)]
</span><a href="#local-6989586621679359400"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Name&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679359399"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679359399"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679359399"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679359399"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679359410"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-391"></span><span>      </span><span id="local-6989586621679359398"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359398"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO
     (Rec
        ('R
           '[ &quot;body&quot; ':-&gt; ByteString,
              &quot;headers&quot;
              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
              &quot;status&quot; ':-&gt; Natural]))
forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;),
 HasAgentConfig) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_get_request"><span class="hs-identifier hs-var">ic_http_get_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359413"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;many_response_headers/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679359410"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (String, ByteString)
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359413"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-392"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359398"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;status&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;status&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;status&quot; (Label &quot;status&quot;)
Label &quot;status&quot;
</span><a href="#local-6989586621679360059"><span class="hs-var">#status</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; IO ()
forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">200</span></span><span>
</span><span id="line-393"></span><span>      </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Response HTTP headers have not been received properly.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; IO ()) -&gt; Bool -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; [(Text, Text)] -&gt; Bool
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><a href="IC.Test.Spec.HTTP.html#list_subset"><span class="hs-identifier hs-var">list_subset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; [(Text, Text)]
</span><a href="IC.Test.Spec.HTTP.html#map_to_lower"><span class="hs-identifier hs-var">map_to_lower</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679359400"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; [(Text, Text)]
</span><a href="IC.Test.Spec.HTTP.html#map_to_lower"><span class="hs-identifier hs-var">map_to_lower</span></a></span><span> </span><span class="annot"><span class="annottext">([(Text, Text)] -&gt; [(Text, Text)])
-&gt; [(Text, Text)] -&gt; [(Text, Text)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; [(Text, Text)]
forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;)) =&gt;
b -&gt; [(Text, Text)]
</span><a href="IC.Utils.html#http_response_headers"><span class="hs-identifier hs-var">http_response_headers</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359398"><span class="hs-identifier hs-var">resp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
HttpResponse
</span><a href="#local-6989586621679359398"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum number of response headers exceeded&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; IO ()) -&gt; TestTree)
-&gt; (ByteString -&gt; IO ()) -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679359396"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359396"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-397"></span><span>      </span><span class="hs-comment">{- These 5 response headers are always included:
          Connection: keep-alive
          Content-Type: text/html; charset=utf-8
          Content-Length: 0
          Access-Control-Allow-Origin: *
          Access-Control-Allow-Credentials: true
      -}</span><span>
</span><span id="line-404"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359391"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679359391"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="IC.Constants.html#http_headers_max_number"><span class="hs-identifier hs-var">http_headers_max_number</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-405"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_get_request%27"><span class="hs-identifier hs-var">ic_http_get_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359396"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;many_response_headers/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679359391"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (String, ByteString)
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359396"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">IO ReqResponse -&gt; (ReqResponse -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
[Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span>    </span><span class="hs-comment">-- &quot;The following additional limits apply to HTTP requests and HTTP responses from the remote sever: the number of bytes representing a header name must not exceed 8KiB.&quot;</span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum request header name length&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; IO ()) -&gt; TestTree)
-&gt; (ByteString -&gt; IO ()) -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679359390"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359390"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-410"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359389"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679359389"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="IC.Utils.html#toUtf8"><span class="hs-identifier hs-var">toUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ByteString) -&gt; Text -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Hello, world!&quot;</span></span><span>
</span><span id="line-411"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359386"><span class="annot"><span class="annottext">hs :: [(Text, Text)]
</span><a href="#local-6989586621679359386"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_name_value_length"><span class="hs-identifier hs-var">http_headers_max_name_value_length</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'x'</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-412"></span><span>      </span><span id="local-6989586621679359384"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359384"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO
     (Rec
        ('R
           '[ &quot;body&quot; ':-&gt; ByteString,
              &quot;headers&quot;
              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
              &quot;status&quot; ':-&gt; Natural]))
forall a b.
(HasAgentConfig,
 (a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;)) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_post_request"><span class="hs-identifier hs-var">ic_http_post_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359390"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;anything&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359389"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; Vector HttpHeader
</span><a href="IC.Test.Spec.Utils.html#vec_header_from_list_text"><span class="hs-identifier hs-var">vec_header_from_list_text</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679359386"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (String, ByteString)
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359390"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-413"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359384"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;status&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;status&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;status&quot; (Label &quot;status&quot;)
Label &quot;status&quot;
</span><a href="#local-6989586621679360023"><span class="hs-var">#status</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; IO ()
forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">200</span></span><span>
</span><span id="line-414"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
HttpResponse
</span><a href="#local-6989586621679359384"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-415"></span><span>      </span><span class="annot"><span class="annottext">String
-&gt; [(Text, Text)] -&gt; ByteString -&gt; Maybe HttpRequest -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_json"><span class="hs-identifier hs-var">check_http_json</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;POST&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679359386"><span class="hs-identifier hs-var">hs</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359389"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe HttpRequest -&gt; IO ()) -&gt; Maybe HttpRequest -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Maybe HttpRequest
forall a. FromJSON a =&gt; ByteString -&gt; Maybe a
</span><a href="file:///nix/store/lrgc0409r3969xpx8sr161n8fp0b2amn-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.html#decode"><span class="hs-identifier hs-var">decode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359384"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;body&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;body&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;body&quot; (Label &quot;body&quot;)
Label &quot;body&quot;
</span><a href="#local-6989586621679360017"><span class="hs-var">#body</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequest"><span class="hs-identifier hs-type">HttpRequest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-416"></span><span>
</span><span id="line-417"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum request header name length exceeded&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; IO ()) -&gt; TestTree)
-&gt; (ByteString -&gt; IO ()) -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679359383"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359383"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-418"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359382"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679359382"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="IC.Utils.html#toUtf8"><span class="hs-identifier hs-var">toUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ByteString) -&gt; Text -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Hello, world!&quot;</span></span><span>
</span><span id="line-419"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359377"><span class="annot"><span class="annottext">hs :: [(Text, Text)]
</span><a href="#local-6989586621679359377"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Int) -&gt; Word64 -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_name_value_length"><span class="hs-identifier hs-var">http_headers_max_name_value_length</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'x'</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-420"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_post_request%27"><span class="hs-identifier hs-var">ic_http_post_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679359376"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359376"><span class="hs-identifier hs-var">fee</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359376"><span class="hs-identifier hs-var">fee</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359383"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359376"><span class="hs-identifier hs-var">fee</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;anything&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359382"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; Vector HttpHeader
</span><a href="IC.Test.Spec.Utils.html#vec_header_from_list_text"><span class="hs-identifier hs-var">vec_header_from_list_text</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679359377"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (String, ByteString)
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359383"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">IO ReqResponse -&gt; (ReqResponse -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
[Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">4</span></span><span class="hs-special">]</span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum response header name length&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; IO ()) -&gt; TestTree)
-&gt; (ByteString -&gt; IO ()) -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679359375"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359375"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-423"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359374"><span class="annot"><span class="annottext">n :: Word64
</span><a href="#local-6989586621679359374"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_name_value_length"><span class="hs-identifier hs-var">http_headers_max_name_value_length</span></a></span><span>
</span><span id="line-424"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359371"><span class="annot"><span class="annottext">hs :: [(Text, Text)]
</span><a href="#local-6989586621679359371"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359374"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'x'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-425"></span><span>      </span><span id="local-6989586621679359370"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359370"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO
     (Rec
        ('R
           '[ &quot;body&quot; ':-&gt; ByteString,
              &quot;headers&quot;
              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
              &quot;status&quot; ':-&gt; Natural]))
forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;),
 HasAgentConfig) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_get_request"><span class="hs-identifier hs-var">ic_http_get_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359375"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;long_response_header_name/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359374"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (String, ByteString)
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359375"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-426"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359370"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;status&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;status&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;status&quot; (Label &quot;status&quot;)
Label &quot;status&quot;
</span><a href="#local-6989586621679359989"><span class="hs-var">#status</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; IO ()
forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">200</span></span><span>
</span><span id="line-427"></span><span>      </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Response HTTP headers have not been received properly.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; IO ()) -&gt; Bool -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; [(Text, Text)] -&gt; Bool
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><a href="IC.Test.Spec.HTTP.html#list_subset"><span class="hs-identifier hs-var">list_subset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; [(Text, Text)]
</span><a href="IC.Test.Spec.HTTP.html#map_to_lower"><span class="hs-identifier hs-var">map_to_lower</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679359371"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; [(Text, Text)]
</span><a href="IC.Test.Spec.HTTP.html#map_to_lower"><span class="hs-identifier hs-var">map_to_lower</span></a></span><span> </span><span class="annot"><span class="annottext">([(Text, Text)] -&gt; [(Text, Text)])
-&gt; [(Text, Text)] -&gt; [(Text, Text)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; [(Text, Text)]
forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;)) =&gt;
b -&gt; [(Text, Text)]
</span><a href="IC.Utils.html#http_response_headers"><span class="hs-identifier hs-var">http_response_headers</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359370"><span class="hs-identifier hs-var">resp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-428"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
HttpResponse
</span><a href="#local-6989586621679359370"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-429"></span><span>
</span><span id="line-430"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum response header name length exceeded&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; IO ()) -&gt; TestTree)
-&gt; (ByteString -&gt; IO ()) -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679359369"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359369"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-431"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359366"><span class="annot"><span class="annottext">n :: Word64
</span><a href="#local-6989586621679359366"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_name_value_length"><span class="hs-identifier hs-var">http_headers_max_name_value_length</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span>
</span><span id="line-432"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_get_request%27"><span class="hs-identifier hs-var">ic_http_get_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359369"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;long_response_header_name/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359366"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (String, ByteString)
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359369"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">IO ReqResponse -&gt; (ReqResponse -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
[Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-433"></span><span>
</span><span id="line-434"></span><span>    </span><span class="hs-comment">-- &quot;The following additional limits apply to HTTP requests and HTTP responses from the remote sever: the number of bytes representing a header value must not exceed 8KiB.&quot;</span><span>
</span><span id="line-435"></span><span>
</span><span id="line-436"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum request header value length&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; IO ()) -&gt; TestTree)
-&gt; (ByteString -&gt; IO ()) -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679359365"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359365"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-437"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359364"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679359364"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="IC.Utils.html#toUtf8"><span class="hs-identifier hs-var">toUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ByteString) -&gt; Text -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Hello, world!&quot;</span></span><span>
</span><span id="line-438"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359361"><span class="annot"><span class="annottext">hs :: [(Text, Text)]
</span><a href="#local-6989586621679359361"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;name&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_name_value_length"><span class="hs-identifier hs-var">http_headers_max_name_value_length</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'x'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-439"></span><span>      </span><span id="local-6989586621679359360"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359360"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO
     (Rec
        ('R
           '[ &quot;body&quot; ':-&gt; ByteString,
              &quot;headers&quot;
              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
              &quot;status&quot; ':-&gt; Natural]))
forall a b.
(HasAgentConfig,
 (a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;)) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_post_request"><span class="hs-identifier hs-var">ic_http_post_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359365"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;anything&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359364"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; Vector HttpHeader
</span><a href="IC.Test.Spec.Utils.html#vec_header_from_list_text"><span class="hs-identifier hs-var">vec_header_from_list_text</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679359361"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (String, ByteString)
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359365"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-440"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359360"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;status&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;status&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;status&quot; (Label &quot;status&quot;)
Label &quot;status&quot;
</span><a href="#local-6989586621679359953"><span class="hs-var">#status</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; IO ()
forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">200</span></span><span>
</span><span id="line-441"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
HttpResponse
</span><a href="#local-6989586621679359360"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-442"></span><span>      </span><span class="annot"><span class="annottext">String
-&gt; [(Text, Text)] -&gt; ByteString -&gt; Maybe HttpRequest -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_json"><span class="hs-identifier hs-var">check_http_json</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;POST&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679359361"><span class="hs-identifier hs-var">hs</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359364"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe HttpRequest -&gt; IO ()) -&gt; Maybe HttpRequest -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Maybe HttpRequest
forall a. FromJSON a =&gt; ByteString -&gt; Maybe a
</span><a href="file:///nix/store/lrgc0409r3969xpx8sr161n8fp0b2amn-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.html#decode"><span class="hs-identifier hs-var">decode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359360"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;body&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;body&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;body&quot; (Label &quot;body&quot;)
Label &quot;body&quot;
</span><a href="#local-6989586621679359947"><span class="hs-var">#body</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequest"><span class="hs-identifier hs-type">HttpRequest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum request header value length exceeded&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; IO ()) -&gt; TestTree)
-&gt; (ByteString -&gt; IO ()) -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679359359"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359359"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-445"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359358"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679359358"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="IC.Utils.html#toUtf8"><span class="hs-identifier hs-var">toUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ByteString) -&gt; Text -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Hello, world!&quot;</span></span><span>
</span><span id="line-446"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359353"><span class="annot"><span class="annottext">hs :: [(Text, Text)]
</span><a href="#local-6989586621679359353"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;name&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Int) -&gt; Word64 -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_name_value_length"><span class="hs-identifier hs-var">http_headers_max_name_value_length</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'x'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-447"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_post_request%27"><span class="hs-identifier hs-var">ic_http_post_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679359352"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359352"><span class="hs-identifier hs-var">fee</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359352"><span class="hs-identifier hs-var">fee</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359359"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359352"><span class="hs-identifier hs-var">fee</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;anything&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359358"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; Vector HttpHeader
</span><a href="IC.Test.Spec.Utils.html#vec_header_from_list_text"><span class="hs-identifier hs-var">vec_header_from_list_text</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679359353"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (String, ByteString)
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359359"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">IO ReqResponse -&gt; (ReqResponse -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
[Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">4</span></span><span class="hs-special">]</span><span>
</span><span id="line-448"></span><span>
</span><span id="line-449"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum response header value length&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; IO ()) -&gt; TestTree)
-&gt; (ByteString -&gt; IO ()) -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679359351"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359351"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-450"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359350"><span class="annot"><span class="annottext">n :: Word64
</span><a href="#local-6989586621679359350"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_name_value_length"><span class="hs-identifier hs-var">http_headers_max_name_value_length</span></a></span><span>
</span><span id="line-451"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359347"><span class="annot"><span class="annottext">hs :: [(Text, Text)]
</span><a href="#local-6989586621679359347"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;name&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359350"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'x'</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-452"></span><span>      </span><span id="local-6989586621679359346"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359346"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO
     (Rec
        ('R
           '[ &quot;body&quot; ':-&gt; ByteString,
              &quot;headers&quot;
              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
              &quot;status&quot; ':-&gt; Natural]))
forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;),
 HasAgentConfig) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_get_request"><span class="hs-identifier hs-var">ic_http_get_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359351"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;long_response_header_value/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359350"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (String, ByteString)
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359351"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-453"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359346"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;status&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;status&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;status&quot; (Label &quot;status&quot;)
Label &quot;status&quot;
</span><a href="#local-6989586621679359919"><span class="hs-var">#status</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; IO ()
forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">200</span></span><span>
</span><span id="line-454"></span><span>      </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Response HTTP headers have not been received properly.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; IO ()) -&gt; Bool -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; [(Text, Text)] -&gt; Bool
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><a href="IC.Test.Spec.HTTP.html#list_subset"><span class="hs-identifier hs-var">list_subset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; [(Text, Text)]
</span><a href="IC.Test.Spec.HTTP.html#map_to_lower"><span class="hs-identifier hs-var">map_to_lower</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679359347"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; [(Text, Text)]
</span><a href="IC.Test.Spec.HTTP.html#map_to_lower"><span class="hs-identifier hs-var">map_to_lower</span></a></span><span> </span><span class="annot"><span class="annottext">([(Text, Text)] -&gt; [(Text, Text)])
-&gt; [(Text, Text)] -&gt; [(Text, Text)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; [(Text, Text)]
forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;)) =&gt;
b -&gt; [(Text, Text)]
</span><a href="IC.Utils.html#http_response_headers"><span class="hs-identifier hs-var">http_response_headers</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359346"><span class="hs-identifier hs-var">resp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
HttpResponse
</span><a href="#local-6989586621679359346"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum response header value length exceeded&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; IO ()) -&gt; TestTree)
-&gt; (ByteString -&gt; IO ()) -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679359345"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359345"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-458"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359342"><span class="annot"><span class="annottext">n :: Word64
</span><a href="#local-6989586621679359342"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_name_value_length"><span class="hs-identifier hs-var">http_headers_max_name_value_length</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span>
</span><span id="line-459"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_get_request%27"><span class="hs-identifier hs-var">ic_http_get_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359345"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;long_response_header_value/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359342"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (String, ByteString)
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359345"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">IO ReqResponse -&gt; (ReqResponse -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
[Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-460"></span><span>
</span><span id="line-461"></span><span>    </span><span class="hs-comment">-- &quot;The following additional limits apply to HTTP requests and HTTP responses from the remote sever: the total number of bytes representing the header names and values must not exceed 48KiB.&quot;</span><span>
</span><span id="line-462"></span><span>
</span><span id="line-463"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum request total header size&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; IO ()) -&gt; TestTree)
-&gt; (ByteString -&gt; IO ()) -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679359341"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359341"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-464"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359340"><span class="annot"><span class="annottext">chunk :: Word64
</span><a href="#local-6989586621679359340"><span class="hs-identifier hs-var hs-var">chunk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_name_value_length"><span class="hs-identifier hs-var">http_headers_max_name_value_length</span></a></span><span>
</span><span id="line-465"></span><span>      </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Maximum number of bytes to represent all request header names and value is not divisible by &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359340"><span class="hs-identifier hs-var">chunk</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_total_size"><span class="hs-identifier hs-var">http_headers_max_total_size</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Real.html#mod"><span class="hs-operator hs-var">`mod`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359340"><span class="hs-identifier hs-var">chunk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span>      </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Maximum number of bytes to represent all request header names and value exceeds &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359340"><span class="hs-identifier hs-var">chunk</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">26</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_total_size"><span class="hs-identifier hs-var">http_headers_max_total_size</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Real.html#div"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359340"><span class="hs-identifier hs-var">chunk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Classes.html#min"><span class="hs-identifier hs-var">min</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">26</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="IC.Constants.html#http_headers_max_number"><span class="hs-identifier hs-var">http_headers_max_number</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-467"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359332"><span class="annot"><span class="annottext">n :: Word64
</span><a href="#local-6989586621679359332"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_total_size"><span class="hs-identifier hs-var">http_headers_max_total_size</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Real.html#div"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359340"><span class="hs-identifier hs-var">chunk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-468"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359331"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679359331"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="IC.Utils.html#toUtf8"><span class="hs-identifier hs-var">toUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ByteString) -&gt; Text -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Hello, world!&quot;</span></span><span>
</span><span id="line-469"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359318"><span class="annot"><span class="annottext">hs :: [(Text, Text)]
</span><a href="#local-6989586621679359318"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Char
</span><a href="IC.Test.Spec.HTTP.html#charFromInt"><span class="hs-identifier hs-var">charFromInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679359317"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359340"><span class="hs-identifier hs-var">chunk</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'x'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359340"><span class="hs-identifier hs-var">chunk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'x'</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679359317"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679359317"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359332"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-470"></span><span>      </span><span id="local-6989586621679359316"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359316"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO
     (Rec
        ('R
           '[ &quot;body&quot; ':-&gt; ByteString,
              &quot;headers&quot;
              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
              &quot;status&quot; ':-&gt; Natural]))
forall a b.
(HasAgentConfig,
 (a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;)) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_post_request"><span class="hs-identifier hs-var">ic_http_post_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359341"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;anything&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359331"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; Vector HttpHeader
</span><a href="IC.Test.Spec.Utils.html#vec_header_from_list_text"><span class="hs-identifier hs-var">vec_header_from_list_text</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679359318"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (String, ByteString)
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359341"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-471"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359316"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;status&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;status&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;status&quot; (Label &quot;status&quot;)
Label &quot;status&quot;
</span><a href="#local-6989586621679359852"><span class="hs-var">#status</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; IO ()
forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">200</span></span><span>
</span><span id="line-472"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
HttpResponse
</span><a href="#local-6989586621679359316"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-473"></span><span>      </span><span class="annot"><span class="annottext">String
-&gt; [(Text, Text)] -&gt; ByteString -&gt; Maybe HttpRequest -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_json"><span class="hs-identifier hs-var">check_http_json</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;POST&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679359318"><span class="hs-identifier hs-var">hs</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359331"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe HttpRequest -&gt; IO ()) -&gt; Maybe HttpRequest -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Maybe HttpRequest
forall a. FromJSON a =&gt; ByteString -&gt; Maybe a
</span><a href="file:///nix/store/lrgc0409r3969xpx8sr161n8fp0b2amn-aeson-2.0.3.0-doc/share/doc/aeson-2.0.3.0/html/src/Data.Aeson.html#decode"><span class="hs-identifier hs-var">decode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359316"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;body&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;body&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;body&quot; (Label &quot;body&quot;)
Label &quot;body&quot;
</span><a href="#local-6989586621679359846"><span class="hs-var">#body</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Test.Spec.HTTP.html#HttpRequest"><span class="hs-identifier hs-type">HttpRequest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span>
</span><span id="line-475"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum request total header size exceeded&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; IO ()) -&gt; TestTree)
-&gt; (ByteString -&gt; IO ()) -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679359315"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359315"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-476"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359314"><span class="annot"><span class="annottext">chunk :: Word64
</span><a href="#local-6989586621679359314"><span class="hs-identifier hs-var hs-var">chunk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_name_value_length"><span class="hs-identifier hs-var">http_headers_max_name_value_length</span></a></span><span>
</span><span id="line-477"></span><span>      </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Maximum number of bytes to represent all request header names and value is not divisible by &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359314"><span class="hs-identifier hs-var">chunk</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_total_size"><span class="hs-identifier hs-var">http_headers_max_total_size</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Real.html#mod"><span class="hs-operator hs-var">`mod`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359314"><span class="hs-identifier hs-var">chunk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-478"></span><span>      </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Maximum number of bytes to represent all request header names and value exceeds &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359314"><span class="hs-identifier hs-var">chunk</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">26</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_total_size"><span class="hs-identifier hs-var">http_headers_max_total_size</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Real.html#div"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359314"><span class="hs-identifier hs-var">chunk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Classes.html#min"><span class="hs-identifier hs-var">min</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">26</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="IC.Constants.html#http_headers_max_number"><span class="hs-identifier hs-var">http_headers_max_number</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359310"><span class="annot"><span class="annottext">n :: Word64
</span><a href="#local-6989586621679359310"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_total_size"><span class="hs-identifier hs-var">http_headers_max_total_size</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Real.html#div"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359314"><span class="hs-identifier hs-var">chunk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-480"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359309"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679359309"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="IC.Utils.html#toUtf8"><span class="hs-identifier hs-var">toUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ByteString) -&gt; Text -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Hello, world!&quot;</span></span><span>
</span><span id="line-481"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359296"><span class="annot"><span class="annottext">hs :: [(Text, Text)]
</span><a href="#local-6989586621679359296"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;x&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#empty"><span class="hs-identifier hs-var">T.empty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text, Text) -&gt; [(Text, Text)] -&gt; [(Text, Text)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Char
</span><a href="IC.Test.Spec.HTTP.html#charFromInt"><span class="hs-identifier hs-var">charFromInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679359294"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359314"><span class="hs-identifier hs-var">chunk</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'x'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359314"><span class="hs-identifier hs-var">chunk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'x'</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679359294"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679359294"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359310"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-482"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe ByteString
-&gt; Vector HttpHeader
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_post_request%27"><span class="hs-identifier hs-var">ic_http_post_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679359293"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359293"><span class="hs-identifier hs-var">fee</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359293"><span class="hs-identifier hs-var">fee</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359315"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359293"><span class="hs-identifier hs-var">fee</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;anything&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359309"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Text, Text)] -&gt; Vector HttpHeader
</span><a href="IC.Test.Spec.Utils.html#vec_header_from_list_text"><span class="hs-identifier hs-var">vec_header_from_list_text</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Text)]
</span><a href="#local-6989586621679359296"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (String, ByteString)
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359315"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">IO ReqResponse -&gt; (ReqResponse -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
[Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">4</span></span><span class="hs-special">]</span><span>
</span><span id="line-483"></span><span>
</span><span id="line-484"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum response total header size&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; IO ()) -&gt; TestTree)
-&gt; (ByteString -&gt; IO ()) -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679359292"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359292"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-485"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359291"><span class="annot"><span class="annottext">n :: Word64
</span><a href="#local-6989586621679359291"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_total_size"><span class="hs-identifier hs-var">http_headers_max_total_size</span></a></span><span>
</span><span id="line-486"></span><span>      </span><span id="local-6989586621679359290"><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359290"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO
     (Rec
        ('R
           '[ &quot;body&quot; ':-&gt; ByteString,
              &quot;headers&quot;
              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
              &quot;status&quot; ':-&gt; Natural]))
forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;),
 HasAgentConfig) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_get_request"><span class="hs-identifier hs-var">ic_http_get_request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359292"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;large_response_total_header_size/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_name_value_length"><span class="hs-identifier hs-var">http_headers_max_name_value_length</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359291"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (String, ByteString)
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359292"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-487"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359290"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Label &quot;status&quot;
-&gt; 'R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural]
   .! &quot;status&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;status&quot; (Label &quot;status&quot;)
Label &quot;status&quot;
</span><a href="#local-6989586621679359787"><span class="hs-var">#status</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; IO ()
forall a. (Eq a, Show a, HasCallStack) =&gt; a -&gt; a -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">200</span></span><span>
</span><span id="line-488"></span><span>      </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; IO ()
String -&gt; Bool -&gt; IO ()
</span><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.Orig.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Total header size is not equal to &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359291"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; IO ()) -&gt; Bool -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
-&gt; Word64
forall a b c.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;), Integral c) =&gt;
b -&gt; c
</span><a href="IC.Utils.html#http_response_headers_total_size"><span class="hs-identifier hs-var">http_response_headers_total_size</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
</span><a href="#local-6989586621679359290"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359291"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-489"></span><span>      </span><span class="annot"><span class="annottext">HttpResponse -&gt; IO ()
</span><a href="IC.Test.Spec.HTTP.html#check_http_response"><span class="hs-identifier hs-var">check_http_response</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; ByteString,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;status&quot; ':-&gt; Natural])
HttpResponse
</span><a href="#local-6989586621679359290"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-490"></span><span>
</span><span id="line-491"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HasCallStack, HasAgentConfig) =&gt;
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
String -&gt; ByteString -&gt; (ByteString -&gt; IO ()) -&gt; TestTree
</span><a href="IC.Test.Spec.Utils.html#simpleTestCase"><span class="hs-identifier hs-var">simpleTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;maximum response total header size exceeded&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359636"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; IO ()) -&gt; TestTree)
-&gt; (ByteString -&gt; IO ()) -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679359288"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359288"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-492"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679359285"><span class="annot"><span class="annottext">n :: Word64
</span><a href="#local-6989586621679359285"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_total_size"><span class="hs-identifier hs-var">http_headers_max_total_size</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span>
</span><span id="line-493"></span><span>      </span><span class="annot"><span class="annottext">HasAgentConfig =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, ByteString)
-&gt; ByteString
-&gt; IO ReqResponse
</span><a href="IC.Test.Agent.SafeCalls.html#ic_http_get_request%27"><span class="hs-identifier hs-var">ic_http_get_request'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasAgentConfig =&gt; Word64 -&gt; ByteString -&gt; IC00WithCycles
Word64 -&gt; ByteString -&gt; IC00WithCycles
</span><a href="IC.Test.Spec.Utils.html#ic00viaWithCyclesRefund"><span class="hs-identifier hs-var">ic00viaWithCyclesRefund</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359288"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestSubnetConfig
</span><a href="#local-6989586621679359638"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;large_response_total_header_size/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="IC.Constants.html#http_headers_max_name_value_length"><span class="hs-identifier hs-var">http_headers_max_name_value_length</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679359285"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (String, ByteString)
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679359288"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">IO ReqResponse -&gt; (ReqResponse -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; [Natural] -&gt; ReqResponse -&gt; IO ()
[Natural] -&gt; ReqResponse -&gt; IO ()
</span><a href="IC.Test.Agent.html#isReject"><span class="hs-identifier hs-var">isReject</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-494"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-495"></span></pre></body></html>