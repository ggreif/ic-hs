<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ImplicitParams #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE BlockArguments #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE OverloadedLabels #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE NumericUnderscores #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">IC.Test.Agent.UnsafeCalls</span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">(</span><span>
</span><span id="line-18"></span><span>      </span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_canister_status"><span class="hs-identifier">ic_canister_status</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>      </span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_create"><span class="hs-identifier">ic_create</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>      </span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_delete_canister"><span class="hs-identifier">ic_delete_canister</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>      </span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_deposit_cycles"><span class="hs-identifier">ic_deposit_cycles</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>      </span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_ecdsa_public_key"><span class="hs-identifier">ic_ecdsa_public_key</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>      </span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_get_request"><span class="hs-identifier">ic_http_get_request</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>      </span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_post_request"><span class="hs-identifier">ic_http_post_request</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>      </span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_head_request"><span class="hs-identifier">ic_http_head_request</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>      </span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_long_url_http_request"><span class="hs-identifier">ic_long_url_http_request</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>      </span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_install"><span class="hs-identifier">ic_install</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>      </span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_provisional_create"><span class="hs-identifier">ic_provisional_create</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>      </span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_raw_rand"><span class="hs-identifier">ic_raw_rand</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>      </span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_set_controllers"><span class="hs-identifier">ic_set_controllers</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>      </span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_sign_with_ecdsa"><span class="hs-identifier">ic_sign_with_ecdsa</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>      </span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_start_canister"><span class="hs-identifier">ic_start_canister</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>      </span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_stop_canister"><span class="hs-identifier">ic_stop_canister</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>      </span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_top_up"><span class="hs-identifier">ic_top_up</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>      </span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_uninstall"><span class="hs-identifier">ic_uninstall</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>      </span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_update_settings"><span class="hs-identifier">ic_update_settings</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/bytestring-0.10.12.1/src/Data.ByteString.Lazy.html"><span class="hs-identifier">Data.ByteString.Lazy</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/5xj65cipwzdnpp6y5z9vwld366h065w2-vector-0.12.3.1-doc/share/doc/vector-0.12.3.1/html/src/Data.Vector.html"><span class="hs-identifier">Data.Vector</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Vec</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/Numeric.Natural.html"><span class="hs-identifier">Numeric.Natural</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/lhdkvldidwlynr81ncjifgrr9janbdq8-tasty-hunit-0.10.0.3-doc/share/doc/tasty-hunit-0.10.0.3/html/src/Test.Tasty.HUnit.html"><span class="hs-identifier">Test.Tasty.HUnit</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/5q8knwbpcq1xjhfifih1jfwmvd2jr0sg-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.html"><span class="hs-identifier">Codec.Candid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/5q8knwbpcq1xjhfifih1jfwmvd2jr0sg-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Data.html#Principal"><span class="hs-identifier">Principal</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.html"><span class="hs-identifier">Data.Row</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/Data.Word.html"><span class="hs-identifier">Data.Word</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">W</span></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Management.html"><span class="hs-identifier">IC.Management</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Id.Forms.html"><span class="hs-identifier">IC.Id.Forms</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Test.Agent.html"><span class="hs-identifier">IC.Test.Agent</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Types.html"><span class="hs-identifier">IC.Types</span></a></span><span class="hs-special">(</span><span class="annot"><a href="IC.Types.html#TestSubnetConfig"><span class="hs-identifier">TestSubnetConfig</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Utils.html"><span class="hs-identifier">IC.Utils</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IC.Test.Agent.Calls.html"><span class="hs-identifier">IC.Test.Agent.Calls</span></a></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span id="local-6989586621679353674"><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_create"><span class="hs-identifier hs-type">ic_create</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Test.Agent.html#HasAgentConfig"><span class="hs-identifier hs-type">HasAgentConfig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Test.Agent.Calls.html#PartialSettings"><span class="hs-identifier hs-type">PartialSettings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679353674"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Test.Agent.html#IC00"><span class="hs-identifier hs-type">IC00</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Id.Forms.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#Rec"><span class="hs-identifier hs-type">Rec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679353674"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="IC.Id.Forms.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span></span><span>
</span><span id="line-56"></span><span id="ic_create"><span class="annot"><span class="annottext">ic_create :: forall (r :: Row (*)).
(HasCallStack, HasAgentConfig, PartialSettings r) =&gt;
IC00 -&gt; Blob -&gt; Rec r -&gt; IO Blob
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_create"><span class="hs-identifier hs-var hs-var">ic_create</span></a></span></span><span> </span><span id="local-6989586621679353310"><span class="annot"><span class="annottext">IC00
</span><a href="#local-6989586621679353310"><span class="hs-identifier hs-var">ic00</span></a></span></span><span> </span><span id="local-6989586621679353309"><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679353309"><span class="hs-identifier hs-var">ecid</span></a></span></span><span> </span><span id="local-6989586621679353308"><span class="annot"><span class="annottext">Rec r
</span><a href="#local-6989586621679353308"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-57"></span><span>  </span><span id="local-6989586621679353307"><span class="annot"><span class="annottext">Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
</span><a href="#local-6989586621679353307"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IC00
-&gt; Blob
-&gt; Label &quot;create_canister&quot;
-&gt; Rec
     ('R
        '[ &quot;settings&quot;
           ':-&gt; Maybe
                  (Rec
                     ('R
                        '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                           &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                           &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                           &quot;memory_allocation&quot; ':-&gt; Maybe Natural]))])
-&gt; IO (Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal]))
forall (s :: Symbol) a b.
(HasCallStack, HasAgentConfig, KnownSymbol s,
 (a -&gt; IO b) ~ (ICManagement IO .! s), CandidArg a, CandidArg b) =&gt;
IC00 -&gt; Blob -&gt; Label s -&gt; a -&gt; IO b
</span><a href="IC.Test.Agent.html#callIC"><span class="hs-identifier hs-var">callIC</span></a></span><span> </span><span class="annot"><span class="annottext">IC00
</span><a href="#local-6989586621679353310"><span class="hs-identifier hs-var">ic00</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679353309"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;create_canister&quot; (Label &quot;create_canister&quot;)
Label &quot;create_canister&quot;
</span><a href="#local-6989586621679353492"><span class="hs-var">#create_canister</span></a></span><span> </span><span class="annot"><span class="annottext">(Rec
   ('R
      '[ &quot;settings&quot;
         ':-&gt; Maybe
                (Rec
                   ('R
                      '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                         &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                         &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                         &quot;memory_allocation&quot; ':-&gt; Maybe Natural]))])
 -&gt; IO (Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])))
-&gt; Rec
     ('R
        '[ &quot;settings&quot;
           ':-&gt; Maybe
                  (Rec
                     ('R
                        '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                           &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                           &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                           &quot;memory_allocation&quot; ':-&gt; Maybe Natural]))])
-&gt; IO (Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec Empty
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><span class="annottext">Rec Empty
-&gt; Rec
     ('R
        '[ &quot;settings&quot;
           ':-&gt; Maybe
                  (Rec
                     ('R
                        '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                           &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                           &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                           &quot;memory_allocation&quot; ':-&gt; Maybe Natural]))])
-&gt; Rec
     (Empty
      .+ 'R
           '[ &quot;settings&quot;
              ':-&gt; Maybe
                     (Rec
                        ('R
                           '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                              &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                              &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                              &quot;memory_allocation&quot; ':-&gt; Maybe Natural]))])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;settings&quot; (Label &quot;settings&quot;)
Label &quot;settings&quot;
</span><a href="#local-6989586621679353485"><span class="hs-var">#settings</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;settings&quot;
-&gt; Maybe
     (Rec
        ('R
           '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
              &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
              &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
              &quot;memory_allocation&quot; ':-&gt; Maybe Natural]))
-&gt; Rec
     (Extend
        &quot;settings&quot;
        (Maybe
           (Rec
              ('R
                 '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                    &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                    &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                    &quot;memory_allocation&quot; ':-&gt; Maybe Natural])))
        Empty)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
        &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
        &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
        &quot;memory_allocation&quot; ':-&gt; Maybe Natural])
-&gt; Maybe
     (Rec
        ('R
           '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
              &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
              &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
              &quot;memory_allocation&quot; ':-&gt; Maybe Natural]))
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec r -&gt; Settings
forall (r :: Row (*)). PartialSettings r =&gt; Rec r -&gt; Settings
</span><a href="IC.Test.Agent.Calls.html#fromPartialSettings"><span class="hs-identifier hs-var">fromPartialSettings</span></a></span><span> </span><span class="annot"><span class="annottext">Rec r
</span><a href="#local-6989586621679353308"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>  </span><span class="annot"><span class="annottext">Blob -&gt; IO Blob
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Principal -&gt; Blob
</span><a href="file:///nix/store/5q8knwbpcq1xjhfifih1jfwmvd2jr0sg-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Data.html#rawPrincipal"><span class="hs-identifier hs-var hs-var">rawPrincipal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
</span><a href="#local-6989586621679353307"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
-&gt; Label &quot;canister_id&quot;
-&gt; 'R '[ &quot;canister_id&quot; ':-&gt; Principal] .! &quot;canister_id&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;canister_id&quot; (Label &quot;canister_id&quot;)
Label &quot;canister_id&quot;
</span><a href="#local-6989586621679353475"><span class="hs-var">#canister_id</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span id="local-6989586621679353598"><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_provisional_create"><span class="hs-identifier hs-type">ic_provisional_create</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Test.Agent.html#HasAgentConfig"><span class="hs-identifier hs-type">HasAgentConfig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Test.Agent.Calls.html#PartialSettings"><span class="hs-identifier hs-type">PartialSettings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679353598"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-63"></span><span>    </span><span class="annot"><a href="IC.Test.Agent.html#IC00"><span class="hs-identifier hs-type">IC00</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Id.Forms.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/5q8knwbpcq1xjhfifih1jfwmvd2jr0sg-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Data.html#Principal"><span class="hs-identifier hs-type">Principal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-bignum-1.1/src/GHC.Num.Natural.html#Natural"><span class="hs-identifier hs-type">Natural</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#Rec"><span class="hs-identifier hs-type">Rec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679353598"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="IC.Id.Forms.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span></span><span>
</span><span id="line-64"></span><span id="ic_provisional_create"><span class="annot"><span class="annottext">ic_provisional_create :: forall (r :: Row (*)).
(HasCallStack, HasAgentConfig, PartialSettings r) =&gt;
IC00
-&gt; Blob -&gt; Maybe Principal -&gt; Maybe Natural -&gt; Rec r -&gt; IO Blob
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_provisional_create"><span class="hs-identifier hs-var hs-var">ic_provisional_create</span></a></span></span><span> </span><span id="local-6989586621679353059"><span class="annot"><span class="annottext">IC00
</span><a href="#local-6989586621679353059"><span class="hs-identifier hs-var">ic00</span></a></span></span><span> </span><span id="local-6989586621679353058"><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679353058"><span class="hs-identifier hs-var">ecid</span></a></span></span><span> </span><span id="local-6989586621679353057"><span class="annot"><span class="annottext">Maybe Principal
</span><a href="#local-6989586621679353057"><span class="hs-identifier hs-var">specified_id</span></a></span></span><span> </span><span id="local-6989586621679353056"><span class="annot"><span class="annottext">Maybe Natural
</span><a href="#local-6989586621679353056"><span class="hs-identifier hs-var">cycles</span></a></span></span><span> </span><span id="local-6989586621679353055"><span class="annot"><span class="annottext">Rec r
</span><a href="#local-6989586621679353055"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-65"></span><span>  </span><span id="local-6989586621679353054"><span class="annot"><span class="annottext">Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
</span><a href="#local-6989586621679353054"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IC00
-&gt; Blob
-&gt; Label &quot;provisional_create_canister_with_cycles&quot;
-&gt; Rec
     ('R
        '[ &quot;amount&quot; ':-&gt; Maybe Natural,
           &quot;settings&quot;
           ':-&gt; Maybe
                  (Rec
                     ('R
                        '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                           &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                           &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                           &quot;memory_allocation&quot; ':-&gt; Maybe Natural])),
           &quot;specified_id&quot; ':-&gt; Maybe Principal])
-&gt; IO (Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal]))
forall (s :: Symbol) a b.
(HasCallStack, HasAgentConfig, KnownSymbol s,
 (a -&gt; IO b) ~ (ICManagement IO .! s), CandidArg a, CandidArg b) =&gt;
IC00 -&gt; Blob -&gt; Label s -&gt; a -&gt; IO b
</span><a href="IC.Test.Agent.html#callIC"><span class="hs-identifier hs-var">callIC</span></a></span><span> </span><span class="annot"><span class="annottext">IC00
</span><a href="#local-6989586621679353059"><span class="hs-identifier hs-var">ic00</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679353058"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;provisional_create_canister_with_cycles&quot;
  (Label &quot;provisional_create_canister_with_cycles&quot;)
Label &quot;provisional_create_canister_with_cycles&quot;
</span><a href="#local-6989586621679353285"><span class="hs-var">#provisional_create_canister_with_cycles</span></a></span><span> </span><span class="annot"><span class="annottext">(Rec
   ('R
      '[ &quot;amount&quot; ':-&gt; Maybe Natural,
         &quot;settings&quot;
         ':-&gt; Maybe
                (Rec
                   ('R
                      '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                         &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                         &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                         &quot;memory_allocation&quot; ':-&gt; Maybe Natural])),
         &quot;specified_id&quot; ':-&gt; Maybe Principal])
 -&gt; IO (Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])))
-&gt; Rec
     ('R
        '[ &quot;amount&quot; ':-&gt; Maybe Natural,
           &quot;settings&quot;
           ':-&gt; Maybe
                  (Rec
                     ('R
                        '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                           &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                           &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                           &quot;memory_allocation&quot; ':-&gt; Maybe Natural])),
           &quot;specified_id&quot; ':-&gt; Maybe Principal])
-&gt; IO (Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec Empty
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><span class="annottext">Rec Empty
-&gt; Rec ('R '[ &quot;amount&quot; ':-&gt; Maybe Natural])
-&gt; Rec (Empty .+ 'R '[ &quot;amount&quot; ':-&gt; Maybe Natural])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;amount&quot; (Label &quot;amount&quot;)
Label &quot;amount&quot;
</span><a href="#local-6989586621679353271"><span class="hs-var">#amount</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;amount&quot;
-&gt; Maybe Natural -&gt; Rec (Extend &quot;amount&quot; (Maybe Natural) Empty)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Natural
</span><a href="#local-6989586621679353056"><span class="hs-identifier hs-var">cycles</span></a></span><span>
</span><span id="line-67"></span><span>    </span><span class="annot"><span class="annottext">Rec ('R '[ &quot;amount&quot; ':-&gt; Maybe Natural])
-&gt; Rec
     ('R
        '[ &quot;settings&quot;
           ':-&gt; Maybe
                  (Rec
                     ('R
                        '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                           &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                           &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                           &quot;memory_allocation&quot; ':-&gt; Maybe Natural]))])
-&gt; Rec
     ('R '[ &quot;amount&quot; ':-&gt; Maybe Natural]
      .+ 'R
           '[ &quot;settings&quot;
              ':-&gt; Maybe
                     (Rec
                        ('R
                           '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                              &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                              &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                              &quot;memory_allocation&quot; ':-&gt; Maybe Natural]))])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;settings&quot; (Label &quot;settings&quot;)
Label &quot;settings&quot;
</span><a href="#local-6989586621679353267"><span class="hs-var">#settings</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;settings&quot;
-&gt; Maybe
     (Rec
        ('R
           '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
              &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
              &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
              &quot;memory_allocation&quot; ':-&gt; Maybe Natural]))
-&gt; Rec
     (Extend
        &quot;settings&quot;
        (Maybe
           (Rec
              ('R
                 '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                    &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                    &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                    &quot;memory_allocation&quot; ':-&gt; Maybe Natural])))
        Empty)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
        &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
        &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
        &quot;memory_allocation&quot; ':-&gt; Maybe Natural])
-&gt; Maybe
     (Rec
        ('R
           '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
              &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
              &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
              &quot;memory_allocation&quot; ':-&gt; Maybe Natural]))
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec r -&gt; Settings
forall (r :: Row (*)). PartialSettings r =&gt; Rec r -&gt; Settings
</span><a href="IC.Test.Agent.Calls.html#fromPartialSettings"><span class="hs-identifier hs-var">fromPartialSettings</span></a></span><span> </span><span class="annot"><span class="annottext">Rec r
</span><a href="#local-6989586621679353055"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;amount&quot; ':-&gt; Maybe Natural,
        &quot;settings&quot;
        ':-&gt; Maybe
               (Rec
                  ('R
                     '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                        &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                        &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                        &quot;memory_allocation&quot; ':-&gt; Maybe Natural]))])
-&gt; Rec ('R '[ &quot;specified_id&quot; ':-&gt; Maybe Principal])
-&gt; Rec
     ('R
        '[ &quot;amount&quot; ':-&gt; Maybe Natural,
           &quot;settings&quot;
           ':-&gt; Maybe
                  (Rec
                     ('R
                        '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                           &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                           &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                           &quot;memory_allocation&quot; ':-&gt; Maybe Natural]))]
      .+ 'R '[ &quot;specified_id&quot; ':-&gt; Maybe Principal])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;specified_id&quot; (Label &quot;specified_id&quot;)
Label &quot;specified_id&quot;
</span><a href="#local-6989586621679353258"><span class="hs-var">#specified_id</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;specified_id&quot;
-&gt; Maybe Principal
-&gt; Rec (Extend &quot;specified_id&quot; (Maybe Principal) Empty)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Principal
</span><a href="#local-6989586621679353057"><span class="hs-identifier hs-var">specified_id</span></a></span><span>
</span><span id="line-69"></span><span>  </span><span class="annot"><span class="annottext">Blob -&gt; IO Blob
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Principal -&gt; Blob
</span><a href="file:///nix/store/5q8knwbpcq1xjhfifih1jfwmvd2jr0sg-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Data.html#rawPrincipal"><span class="hs-identifier hs-var hs-var">rawPrincipal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
</span><a href="#local-6989586621679353054"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
-&gt; Label &quot;canister_id&quot;
-&gt; 'R '[ &quot;canister_id&quot; ':-&gt; Principal] .! &quot;canister_id&quot;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;canister_id&quot; (Label &quot;canister_id&quot;)
Label &quot;canister_id&quot;
</span><a href="#local-6989586621679353253"><span class="hs-var">#canister_id</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_install"><span class="hs-identifier hs-type">ic_install</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Test.Agent.html#HasAgentConfig"><span class="hs-identifier hs-type">HasAgentConfig</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Test.Agent.html#IC00"><span class="hs-identifier hs-type">IC00</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Management.html#InstallMode"><span class="hs-identifier hs-type">InstallMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Id.Forms.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Id.Forms.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Id.Forms.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span id="ic_install"><span class="annot"><span class="annottext">ic_install :: (HasCallStack, HasAgentConfig) =&gt;
IC00 -&gt; InstallMode -&gt; Blob -&gt; Blob -&gt; Blob -&gt; IO ()
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_install"><span class="hs-identifier hs-var hs-var">ic_install</span></a></span></span><span> </span><span id="local-6989586621679352851"><span class="annot"><span class="annottext">IC00
</span><a href="#local-6989586621679352851"><span class="hs-identifier hs-var">ic00</span></a></span></span><span> </span><span id="local-6989586621679352850"><span class="annot"><span class="annottext">InstallMode
</span><a href="#local-6989586621679352850"><span class="hs-identifier hs-var">mode</span></a></span></span><span> </span><span id="local-6989586621679352849"><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679352849"><span class="hs-identifier hs-var">canister_id</span></a></span></span><span> </span><span id="local-6989586621679352848"><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679352848"><span class="hs-identifier hs-var">wasm_module</span></a></span></span><span> </span><span id="local-6989586621679352847"><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679352847"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-73"></span><span>  </span><span class="annot"><span class="annottext">IC00
-&gt; Blob
-&gt; Label &quot;install_code&quot;
-&gt; Rec
     ('R
        '[ &quot;arg&quot; ':-&gt; Blob, &quot;canister_id&quot; ':-&gt; Principal,
           &quot;mode&quot;
           ':-&gt; Var
                  ('R '[ &quot;install&quot; ':-&gt; (), &quot;reinstall&quot; ':-&gt; (), &quot;upgrade&quot; ':-&gt; ()]),
           &quot;wasm_module&quot; ':-&gt; Blob])
-&gt; IO ()
forall (s :: Symbol) a b.
(HasCallStack, HasAgentConfig, KnownSymbol s,
 (a -&gt; IO b) ~ (ICManagement IO .! s), CandidArg a, CandidArg b) =&gt;
IC00 -&gt; Blob -&gt; Label s -&gt; a -&gt; IO b
</span><a href="IC.Test.Agent.html#callIC"><span class="hs-identifier hs-var">callIC</span></a></span><span> </span><span class="annot"><span class="annottext">IC00
</span><a href="#local-6989586621679352851"><span class="hs-identifier hs-var">ic00</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679352849"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;install_code&quot; (Label &quot;install_code&quot;)
Label &quot;install_code&quot;
</span><a href="#local-6989586621679353041"><span class="hs-var">#install_code</span></a></span><span> </span><span class="annot"><span class="annottext">(Rec
   ('R
      '[ &quot;arg&quot; ':-&gt; Blob, &quot;canister_id&quot; ':-&gt; Principal,
         &quot;mode&quot;
         ':-&gt; Var
                ('R '[ &quot;install&quot; ':-&gt; (), &quot;reinstall&quot; ':-&gt; (), &quot;upgrade&quot; ':-&gt; ()]),
         &quot;wasm_module&quot; ':-&gt; Blob])
 -&gt; IO ())
-&gt; Rec
     ('R
        '[ &quot;arg&quot; ':-&gt; Blob, &quot;canister_id&quot; ':-&gt; Principal,
           &quot;mode&quot;
           ':-&gt; Var
                  ('R '[ &quot;install&quot; ':-&gt; (), &quot;reinstall&quot; ':-&gt; (), &quot;upgrade&quot; ':-&gt; ()]),
           &quot;wasm_module&quot; ':-&gt; Blob])
-&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec Empty
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-74"></span><span>    </span><span class="annot"><span class="annottext">Rec Empty
-&gt; Rec
     ('R
        '[ &quot;mode&quot;
           ':-&gt; Var
                  ('R
                     '[ &quot;install&quot; ':-&gt; (), &quot;reinstall&quot; ':-&gt; (), &quot;upgrade&quot; ':-&gt; ()])])
-&gt; Rec
     (Empty
      .+ 'R
           '[ &quot;mode&quot;
              ':-&gt; Var
                     ('R
                        '[ &quot;install&quot; ':-&gt; (), &quot;reinstall&quot; ':-&gt; (), &quot;upgrade&quot; ':-&gt; ()])])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;mode&quot; (Label &quot;mode&quot;)
Label &quot;mode&quot;
</span><a href="#local-6989586621679353021"><span class="hs-var">#mode</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;mode&quot;
-&gt; Var
     ('R '[ &quot;install&quot; ':-&gt; (), &quot;reinstall&quot; ':-&gt; (), &quot;upgrade&quot; ':-&gt; ()])
-&gt; Rec
     (Extend
        &quot;mode&quot;
        (Var
           ('R '[ &quot;install&quot; ':-&gt; (), &quot;reinstall&quot; ':-&gt; (), &quot;upgrade&quot; ':-&gt; ()]))
        Empty)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Var
  ('R '[ &quot;install&quot; ':-&gt; (), &quot;reinstall&quot; ':-&gt; (), &quot;upgrade&quot; ':-&gt; ()])
InstallMode
</span><a href="#local-6989586621679352850"><span class="hs-identifier hs-var">mode</span></a></span><span>
</span><span id="line-75"></span><span>    </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;mode&quot;
        ':-&gt; Var
               ('R
                  '[ &quot;install&quot; ':-&gt; (), &quot;reinstall&quot; ':-&gt; (), &quot;upgrade&quot; ':-&gt; ()])])
-&gt; Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
-&gt; Rec
     ('R
        '[ &quot;mode&quot;
           ':-&gt; Var
                  ('R '[ &quot;install&quot; ':-&gt; (), &quot;reinstall&quot; ':-&gt; (), &quot;upgrade&quot; ':-&gt; ()])]
      .+ 'R '[ &quot;canister_id&quot; ':-&gt; Principal])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;canister_id&quot; (Label &quot;canister_id&quot;)
Label &quot;canister_id&quot;
</span><a href="#local-6989586621679353018"><span class="hs-var">#canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;canister_id&quot;
-&gt; Principal -&gt; Rec (Extend &quot;canister_id&quot; Principal Empty)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Blob -&gt; Principal
</span><a href="file:///nix/store/5q8knwbpcq1xjhfifih1jfwmvd2jr0sg-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Data.html#Principal"><span class="hs-identifier hs-var">Principal</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679352849"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;canister_id&quot; ':-&gt; Principal,
        &quot;mode&quot;
        ':-&gt; Var
               ('R
                  '[ &quot;install&quot; ':-&gt; (), &quot;reinstall&quot; ':-&gt; (), &quot;upgrade&quot; ':-&gt; ()])])
-&gt; Rec ('R '[ &quot;wasm_module&quot; ':-&gt; Blob])
-&gt; Rec
     ('R
        '[ &quot;canister_id&quot; ':-&gt; Principal,
           &quot;mode&quot;
           ':-&gt; Var
                  ('R '[ &quot;install&quot; ':-&gt; (), &quot;reinstall&quot; ':-&gt; (), &quot;upgrade&quot; ':-&gt; ()])]
      .+ 'R '[ &quot;wasm_module&quot; ':-&gt; Blob])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;wasm_module&quot; (Label &quot;wasm_module&quot;)
Label &quot;wasm_module&quot;
</span><a href="#local-6989586621679353014"><span class="hs-var">#wasm_module</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;wasm_module&quot;
-&gt; Blob -&gt; Rec (Extend &quot;wasm_module&quot; Blob Empty)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679352848"><span class="hs-identifier hs-var">wasm_module</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;canister_id&quot; ':-&gt; Principal,
        &quot;mode&quot;
        ':-&gt; Var
               ('R '[ &quot;install&quot; ':-&gt; (), &quot;reinstall&quot; ':-&gt; (), &quot;upgrade&quot; ':-&gt; ()]),
        &quot;wasm_module&quot; ':-&gt; Blob])
-&gt; Rec ('R '[ &quot;arg&quot; ':-&gt; Blob])
-&gt; Rec
     ('R
        '[ &quot;canister_id&quot; ':-&gt; Principal,
           &quot;mode&quot;
           ':-&gt; Var
                  ('R '[ &quot;install&quot; ':-&gt; (), &quot;reinstall&quot; ':-&gt; (), &quot;upgrade&quot; ':-&gt; ()]),
           &quot;wasm_module&quot; ':-&gt; Blob]
      .+ 'R '[ &quot;arg&quot; ':-&gt; Blob])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;arg&quot; (Label &quot;arg&quot;)
Label &quot;arg&quot;
</span><a href="#local-6989586621679353010"><span class="hs-var">#arg</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;arg&quot; -&gt; Blob -&gt; Rec (&quot;arg&quot; .== Blob)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679352847"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_uninstall"><span class="hs-identifier hs-type">ic_uninstall</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Test.Agent.html#HasAgentConfig"><span class="hs-identifier hs-type">HasAgentConfig</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Test.Agent.html#IC00"><span class="hs-identifier hs-type">IC00</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Id.Forms.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span id="ic_uninstall"><span class="annot"><span class="annottext">ic_uninstall :: (HasCallStack, HasAgentConfig) =&gt; IC00 -&gt; Blob -&gt; IO ()
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_uninstall"><span class="hs-identifier hs-var hs-var">ic_uninstall</span></a></span></span><span> </span><span id="local-6989586621679352781"><span class="annot"><span class="annottext">IC00
</span><a href="#local-6989586621679352781"><span class="hs-identifier hs-var">ic00</span></a></span></span><span> </span><span id="local-6989586621679352780"><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679352780"><span class="hs-identifier hs-var">canister_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-81"></span><span>  </span><span class="annot"><span class="annottext">IC00
-&gt; Blob
-&gt; Label &quot;uninstall_code&quot;
-&gt; Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
-&gt; IO ()
forall (s :: Symbol) a b.
(HasCallStack, HasAgentConfig, KnownSymbol s,
 (a -&gt; IO b) ~ (ICManagement IO .! s), CandidArg a, CandidArg b) =&gt;
IC00 -&gt; Blob -&gt; Label s -&gt; a -&gt; IO b
</span><a href="IC.Test.Agent.html#callIC"><span class="hs-identifier hs-var">callIC</span></a></span><span> </span><span class="annot"><span class="annottext">IC00
</span><a href="#local-6989586621679352781"><span class="hs-identifier hs-var">ic00</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679352780"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;uninstall_code&quot; (Label &quot;uninstall_code&quot;)
Label &quot;uninstall_code&quot;
</span><a href="#local-6989586621679352833"><span class="hs-var">#uninstall_code</span></a></span><span> </span><span class="annot"><span class="annottext">(Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal]) -&gt; IO ())
-&gt; Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal]) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec Empty
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><span class="annottext">Rec Empty
-&gt; Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
-&gt; Rec (Empty .+ 'R '[ &quot;canister_id&quot; ':-&gt; Principal])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;canister_id&quot; (Label &quot;canister_id&quot;)
Label &quot;canister_id&quot;
</span><a href="#local-6989586621679352827"><span class="hs-var">#canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;canister_id&quot;
-&gt; Principal -&gt; Rec (Extend &quot;canister_id&quot; Principal Empty)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Blob -&gt; Principal
</span><a href="file:///nix/store/5q8knwbpcq1xjhfifih1jfwmvd2jr0sg-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Data.html#Principal"><span class="hs-identifier hs-var">Principal</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679352780"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span id="local-6989586621679353592"><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_update_settings"><span class="hs-identifier hs-type">ic_update_settings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Test.Agent.html#HasAgentConfig"><span class="hs-identifier hs-type">HasAgentConfig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Test.Agent.Calls.html#PartialSettings"><span class="hs-identifier hs-type">PartialSettings</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679353592"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Test.Agent.html#IC00"><span class="hs-identifier hs-type">IC00</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Id.Forms.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#Rec"><span class="hs-identifier hs-type">Rec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679353592"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-85"></span><span id="ic_update_settings"><span class="annot"><span class="annottext">ic_update_settings :: forall (r :: Row (*)).
(HasAgentConfig, PartialSettings r) =&gt;
IC00 -&gt; Blob -&gt; Rec r -&gt; IO ()
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_update_settings"><span class="hs-identifier hs-var hs-var">ic_update_settings</span></a></span></span><span> </span><span id="local-6989586621679352601"><span class="annot"><span class="annottext">IC00
</span><a href="#local-6989586621679352601"><span class="hs-identifier hs-var">ic00</span></a></span></span><span> </span><span id="local-6989586621679352600"><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679352600"><span class="hs-identifier hs-var">canister_id</span></a></span></span><span> </span><span id="local-6989586621679352599"><span class="annot"><span class="annottext">Rec r
</span><a href="#local-6989586621679352599"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-86"></span><span>  </span><span class="annot"><span class="annottext">IC00
-&gt; Blob
-&gt; Label &quot;update_settings&quot;
-&gt; Rec
     ('R
        '[ &quot;canister_id&quot; ':-&gt; Principal,
           &quot;settings&quot;
           ':-&gt; Rec
                  ('R
                     '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                        &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                        &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                        &quot;memory_allocation&quot; ':-&gt; Maybe Natural])])
-&gt; IO ()
forall (s :: Symbol) a b.
(HasCallStack, HasAgentConfig, KnownSymbol s,
 (a -&gt; IO b) ~ (ICManagement IO .! s), CandidArg a, CandidArg b) =&gt;
IC00 -&gt; Blob -&gt; Label s -&gt; a -&gt; IO b
</span><a href="IC.Test.Agent.html#callIC"><span class="hs-identifier hs-var">callIC</span></a></span><span> </span><span class="annot"><span class="annottext">IC00
</span><a href="#local-6989586621679352601"><span class="hs-identifier hs-var">ic00</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679352600"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;update_settings&quot; (Label &quot;update_settings&quot;)
Label &quot;update_settings&quot;
</span><a href="#local-6989586621679352767"><span class="hs-var">#update_settings</span></a></span><span> </span><span class="annot"><span class="annottext">(Rec
   ('R
      '[ &quot;canister_id&quot; ':-&gt; Principal,
         &quot;settings&quot;
         ':-&gt; Rec
                ('R
                   '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                      &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                      &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                      &quot;memory_allocation&quot; ':-&gt; Maybe Natural])])
 -&gt; IO ())
-&gt; Rec
     ('R
        '[ &quot;canister_id&quot; ':-&gt; Principal,
           &quot;settings&quot;
           ':-&gt; Rec
                  ('R
                     '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                        &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                        &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                        &quot;memory_allocation&quot; ':-&gt; Maybe Natural])])
-&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec Empty
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><span class="annottext">Rec Empty
-&gt; Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
-&gt; Rec (Empty .+ 'R '[ &quot;canister_id&quot; ':-&gt; Principal])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;canister_id&quot; (Label &quot;canister_id&quot;)
Label &quot;canister_id&quot;
</span><a href="#local-6989586621679352757"><span class="hs-var">#canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;canister_id&quot;
-&gt; Principal -&gt; Rec (Extend &quot;canister_id&quot; Principal Empty)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Blob -&gt; Principal
</span><a href="file:///nix/store/5q8knwbpcq1xjhfifih1jfwmvd2jr0sg-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Data.html#Principal"><span class="hs-identifier hs-var">Principal</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679352600"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-88"></span><span>    </span><span class="annot"><span class="annottext">Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
-&gt; Rec
     ('R
        '[ &quot;settings&quot;
           ':-&gt; Rec
                  ('R
                     '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                        &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                        &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                        &quot;memory_allocation&quot; ':-&gt; Maybe Natural])])
-&gt; Rec
     ('R '[ &quot;canister_id&quot; ':-&gt; Principal]
      .+ 'R
           '[ &quot;settings&quot;
              ':-&gt; Rec
                     ('R
                        '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                           &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                           &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                           &quot;memory_allocation&quot; ':-&gt; Maybe Natural])])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;settings&quot; (Label &quot;settings&quot;)
Label &quot;settings&quot;
</span><a href="#local-6989586621679352753"><span class="hs-var">#settings</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;settings&quot;
-&gt; Rec
     ('R
        '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
           &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
           &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
           &quot;memory_allocation&quot; ':-&gt; Maybe Natural])
-&gt; Rec
     (Extend
        &quot;settings&quot;
        (Rec
           ('R
              '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                 &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                 &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                 &quot;memory_allocation&quot; ':-&gt; Maybe Natural]))
        Empty)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Rec r -&gt; Settings
forall (r :: Row (*)). PartialSettings r =&gt; Rec r -&gt; Settings
</span><a href="IC.Test.Agent.Calls.html#fromPartialSettings"><span class="hs-identifier hs-var">fromPartialSettings</span></a></span><span> </span><span class="annot"><span class="annottext">Rec r
</span><a href="#local-6989586621679352599"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_set_controllers"><span class="hs-identifier hs-type">ic_set_controllers</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Agent.html#HasAgentConfig"><span class="hs-identifier hs-type">HasAgentConfig</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Test.Agent.html#IC00"><span class="hs-identifier hs-type">IC00</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Id.Forms.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="IC.Id.Forms.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span id="ic_set_controllers"><span class="annot"><span class="annottext">ic_set_controllers :: HasAgentConfig =&gt; IC00 -&gt; Blob -&gt; [Blob] -&gt; IO ()
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_set_controllers"><span class="hs-identifier hs-var hs-var">ic_set_controllers</span></a></span></span><span> </span><span id="local-6989586621679352415"><span class="annot"><span class="annottext">IC00
</span><a href="#local-6989586621679352415"><span class="hs-identifier hs-var">ic00</span></a></span></span><span> </span><span id="local-6989586621679352414"><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679352414"><span class="hs-identifier hs-var">canister_id</span></a></span></span><span> </span><span id="local-6989586621679352413"><span class="annot"><span class="annottext">[Blob]
</span><a href="#local-6989586621679352413"><span class="hs-identifier hs-var">new_controllers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-92"></span><span>  </span><span class="annot"><span class="annottext">IC00
-&gt; Blob
-&gt; Label &quot;update_settings&quot;
-&gt; Rec
     ('R
        '[ &quot;canister_id&quot; ':-&gt; Principal,
           &quot;settings&quot;
           ':-&gt; Rec
                  ('R
                     '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                        &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                        &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                        &quot;memory_allocation&quot; ':-&gt; Maybe Natural])])
-&gt; IO ()
forall (s :: Symbol) a b.
(HasCallStack, HasAgentConfig, KnownSymbol s,
 (a -&gt; IO b) ~ (ICManagement IO .! s), CandidArg a, CandidArg b) =&gt;
IC00 -&gt; Blob -&gt; Label s -&gt; a -&gt; IO b
</span><a href="IC.Test.Agent.html#callIC"><span class="hs-identifier hs-var">callIC</span></a></span><span> </span><span class="annot"><span class="annottext">IC00
</span><a href="#local-6989586621679352415"><span class="hs-identifier hs-var">ic00</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679352414"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;update_settings&quot; (Label &quot;update_settings&quot;)
Label &quot;update_settings&quot;
</span><a href="#local-6989586621679352587"><span class="hs-var">#update_settings</span></a></span><span> </span><span class="annot"><span class="annottext">(Rec
   ('R
      '[ &quot;canister_id&quot; ':-&gt; Principal,
         &quot;settings&quot;
         ':-&gt; Rec
                ('R
                   '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                      &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                      &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                      &quot;memory_allocation&quot; ':-&gt; Maybe Natural])])
 -&gt; IO ())
-&gt; Rec
     ('R
        '[ &quot;canister_id&quot; ':-&gt; Principal,
           &quot;settings&quot;
           ':-&gt; Rec
                  ('R
                     '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                        &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                        &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                        &quot;memory_allocation&quot; ':-&gt; Maybe Natural])])
-&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec Empty
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><span class="annottext">Rec Empty
-&gt; Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
-&gt; Rec (Empty .+ 'R '[ &quot;canister_id&quot; ':-&gt; Principal])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;canister_id&quot; (Label &quot;canister_id&quot;)
Label &quot;canister_id&quot;
</span><a href="#local-6989586621679352577"><span class="hs-var">#canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;canister_id&quot;
-&gt; Principal -&gt; Rec (Extend &quot;canister_id&quot; Principal Empty)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Blob -&gt; Principal
</span><a href="file:///nix/store/5q8knwbpcq1xjhfifih1jfwmvd2jr0sg-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Data.html#Principal"><span class="hs-identifier hs-var">Principal</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679352414"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><span class="annottext">Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
-&gt; Rec
     ('R
        '[ &quot;settings&quot;
           ':-&gt; Rec
                  ('R
                     '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                        &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                        &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                        &quot;memory_allocation&quot; ':-&gt; Maybe Natural])])
-&gt; Rec
     ('R '[ &quot;canister_id&quot; ':-&gt; Principal]
      .+ 'R
           '[ &quot;settings&quot;
              ':-&gt; Rec
                     ('R
                        '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                           &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                           &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                           &quot;memory_allocation&quot; ':-&gt; Maybe Natural])])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;settings&quot; (Label &quot;settings&quot;)
Label &quot;settings&quot;
</span><a href="#local-6989586621679352573"><span class="hs-var">#settings</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;settings&quot;
-&gt; Rec
     ('R
        '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
           &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
           &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
           &quot;memory_allocation&quot; ':-&gt; Maybe Natural])
-&gt; Rec
     (Extend
        &quot;settings&quot;
        (Rec
           ('R
              '[ &quot;compute_allocation&quot; ':-&gt; Maybe Natural,
                 &quot;controllers&quot; ':-&gt; Maybe (Vector Principal),
                 &quot;freezing_threshold&quot; ':-&gt; Maybe Natural,
                 &quot;memory_allocation&quot; ':-&gt; Maybe Natural]))
        Empty)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ('R '[ &quot;controllers&quot; ':-&gt; Vector Principal]) -&gt; Settings
forall (r :: Row (*)). PartialSettings r =&gt; Rec r -&gt; Settings
</span><a href="IC.Test.Agent.Calls.html#fromPartialSettings"><span class="hs-identifier hs-var">fromPartialSettings</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IsLabel &quot;controllers&quot; (Label &quot;controllers&quot;)
Label &quot;controllers&quot;
</span><a href="#local-6989586621679352567"><span class="hs-var">#controllers</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;controllers&quot;
-&gt; Vector Principal
-&gt; Rec (Extend &quot;controllers&quot; (Vector Principal) Empty)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">[Principal] -&gt; Vector Principal
forall a. [a] -&gt; Vector a
</span><a href="file:///nix/store/5xj65cipwzdnpp6y5z9vwld366h065w2-vector-0.12.3.1-doc/share/doc/vector-0.12.3.1/html/src/Data.Vector.html#fromList"><span class="hs-identifier hs-var">Vec.fromList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Blob -&gt; Principal) -&gt; [Blob] -&gt; [Principal]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Blob -&gt; Principal
</span><a href="file:///nix/store/5q8knwbpcq1xjhfifih1jfwmvd2jr0sg-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Data.html#Principal"><span class="hs-identifier hs-var">Principal</span></a></span><span> </span><span class="annot"><span class="annottext">[Blob]
</span><a href="#local-6989586621679352413"><span class="hs-identifier hs-var">new_controllers</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_start_canister"><span class="hs-identifier hs-type">ic_start_canister</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Agent.html#HasAgentConfig"><span class="hs-identifier hs-type">HasAgentConfig</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Test.Agent.html#IC00"><span class="hs-identifier hs-type">IC00</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Id.Forms.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span id="ic_start_canister"><span class="annot"><span class="annottext">ic_start_canister :: HasAgentConfig =&gt; IC00 -&gt; Blob -&gt; IO ()
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_start_canister"><span class="hs-identifier hs-var hs-var">ic_start_canister</span></a></span></span><span> </span><span id="local-6989586621679352348"><span class="annot"><span class="annottext">IC00
</span><a href="#local-6989586621679352348"><span class="hs-identifier hs-var">ic00</span></a></span></span><span> </span><span id="local-6989586621679352347"><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679352347"><span class="hs-identifier hs-var">canister_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-98"></span><span>  </span><span class="annot"><span class="annottext">IC00
-&gt; Blob
-&gt; Label &quot;start_canister&quot;
-&gt; Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
-&gt; IO ()
forall (s :: Symbol) a b.
(HasCallStack, HasAgentConfig, KnownSymbol s,
 (a -&gt; IO b) ~ (ICManagement IO .! s), CandidArg a, CandidArg b) =&gt;
IC00 -&gt; Blob -&gt; Label s -&gt; a -&gt; IO b
</span><a href="IC.Test.Agent.html#callIC"><span class="hs-identifier hs-var">callIC</span></a></span><span> </span><span class="annot"><span class="annottext">IC00
</span><a href="#local-6989586621679352348"><span class="hs-identifier hs-var">ic00</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679352347"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;start_canister&quot; (Label &quot;start_canister&quot;)
Label &quot;start_canister&quot;
</span><a href="#local-6989586621679352400"><span class="hs-var">#start_canister</span></a></span><span> </span><span class="annot"><span class="annottext">(Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal]) -&gt; IO ())
-&gt; Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal]) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec Empty
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-99"></span><span>    </span><span class="annot"><span class="annottext">Rec Empty
-&gt; Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
-&gt; Rec (Empty .+ 'R '[ &quot;canister_id&quot; ':-&gt; Principal])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;canister_id&quot; (Label &quot;canister_id&quot;)
Label &quot;canister_id&quot;
</span><a href="#local-6989586621679352394"><span class="hs-var">#canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;canister_id&quot;
-&gt; Principal -&gt; Rec (Extend &quot;canister_id&quot; Principal Empty)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Blob -&gt; Principal
</span><a href="file:///nix/store/5q8knwbpcq1xjhfifih1jfwmvd2jr0sg-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Data.html#Principal"><span class="hs-identifier hs-var">Principal</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679352347"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_stop_canister"><span class="hs-identifier hs-type">ic_stop_canister</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Agent.html#HasAgentConfig"><span class="hs-identifier hs-type">HasAgentConfig</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Test.Agent.html#IC00"><span class="hs-identifier hs-type">IC00</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Id.Forms.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span id="ic_stop_canister"><span class="annot"><span class="annottext">ic_stop_canister :: HasAgentConfig =&gt; IC00 -&gt; Blob -&gt; IO ()
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_stop_canister"><span class="hs-identifier hs-var hs-var">ic_stop_canister</span></a></span></span><span> </span><span id="local-6989586621679352283"><span class="annot"><span class="annottext">IC00
</span><a href="#local-6989586621679352283"><span class="hs-identifier hs-var">ic00</span></a></span></span><span> </span><span id="local-6989586621679352282"><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679352282"><span class="hs-identifier hs-var">canister_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-103"></span><span>  </span><span class="annot"><span class="annottext">IC00
-&gt; Blob
-&gt; Label &quot;stop_canister&quot;
-&gt; Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
-&gt; IO ()
forall (s :: Symbol) a b.
(HasCallStack, HasAgentConfig, KnownSymbol s,
 (a -&gt; IO b) ~ (ICManagement IO .! s), CandidArg a, CandidArg b) =&gt;
IC00 -&gt; Blob -&gt; Label s -&gt; a -&gt; IO b
</span><a href="IC.Test.Agent.html#callIC"><span class="hs-identifier hs-var">callIC</span></a></span><span> </span><span class="annot"><span class="annottext">IC00
</span><a href="#local-6989586621679352283"><span class="hs-identifier hs-var">ic00</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679352282"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;stop_canister&quot; (Label &quot;stop_canister&quot;)
Label &quot;stop_canister&quot;
</span><a href="#local-6989586621679352335"><span class="hs-var">#stop_canister</span></a></span><span> </span><span class="annot"><span class="annottext">(Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal]) -&gt; IO ())
-&gt; Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal]) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec Empty
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><span class="annottext">Rec Empty
-&gt; Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
-&gt; Rec (Empty .+ 'R '[ &quot;canister_id&quot; ':-&gt; Principal])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;canister_id&quot; (Label &quot;canister_id&quot;)
Label &quot;canister_id&quot;
</span><a href="#local-6989586621679352329"><span class="hs-var">#canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;canister_id&quot;
-&gt; Principal -&gt; Rec (Extend &quot;canister_id&quot; Principal Empty)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Blob -&gt; Principal
</span><a href="file:///nix/store/5q8knwbpcq1xjhfifih1jfwmvd2jr0sg-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Data.html#Principal"><span class="hs-identifier hs-var">Principal</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679352282"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_canister_status"><span class="hs-identifier hs-type">ic_canister_status</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679353587"><span class="annot"><a href="#local-6989586621679353587"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679353586"><span class="annot"><a href="#local-6989586621679353586"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679353587"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679353586"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Management.html#ICManagement"><span class="hs-identifier hs-type">ICManagement</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Internal.html#.%21"><span class="hs-operator hs-type">.!</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;canister_status&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-108"></span><span>    </span><span class="annot"><a href="IC.Test.Agent.html#HasAgentConfig"><span class="hs-identifier hs-type">HasAgentConfig</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Test.Agent.html#IC00"><span class="hs-identifier hs-type">IC00</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Id.Forms.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679353586"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-109"></span><span id="ic_canister_status"><span class="annot"><span class="annottext">ic_canister_status :: forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;canister_status&quot;),
 HasAgentConfig) =&gt;
IC00 -&gt; Blob -&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_canister_status"><span class="hs-identifier hs-var hs-var">ic_canister_status</span></a></span></span><span> </span><span id="local-6989586621679351985"><span class="annot"><span class="annottext">IC00
</span><a href="#local-6989586621679351985"><span class="hs-identifier hs-var">ic00</span></a></span></span><span> </span><span id="local-6989586621679351984"><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679351984"><span class="hs-identifier hs-var">canister_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-110"></span><span>  </span><span class="annot"><span class="annottext">IC00
-&gt; Blob
-&gt; Label &quot;canister_status&quot;
-&gt; Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
-&gt; IO b
forall (s :: Symbol) a b.
(HasCallStack, HasAgentConfig, KnownSymbol s,
 (a -&gt; IO b) ~ (ICManagement IO .! s), CandidArg a, CandidArg b) =&gt;
IC00 -&gt; Blob -&gt; Label s -&gt; a -&gt; IO b
</span><a href="IC.Test.Agent.html#callIC"><span class="hs-identifier hs-var">callIC</span></a></span><span> </span><span class="annot"><span class="annottext">IC00
</span><a href="#local-6989586621679351985"><span class="hs-identifier hs-var">ic00</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679351984"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;canister_status&quot; (Label &quot;canister_status&quot;)
Label &quot;canister_status&quot;
</span><a href="#local-6989586621679352268"><span class="hs-var">#canister_status</span></a></span><span> </span><span class="annot"><span class="annottext">(Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal]) -&gt; IO b)
-&gt; Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal]) -&gt; IO b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec Empty
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-111"></span><span>    </span><span class="annot"><span class="annottext">Rec Empty
-&gt; Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
-&gt; Rec (Empty .+ 'R '[ &quot;canister_id&quot; ':-&gt; Principal])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;canister_id&quot; (Label &quot;canister_id&quot;)
Label &quot;canister_id&quot;
</span><a href="#local-6989586621679352262"><span class="hs-var">#canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;canister_id&quot;
-&gt; Principal -&gt; Rec (Extend &quot;canister_id&quot; Principal Empty)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Blob -&gt; Principal
</span><a href="file:///nix/store/5q8knwbpcq1xjhfifih1jfwmvd2jr0sg-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Data.html#Principal"><span class="hs-identifier hs-var">Principal</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679351984"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_deposit_cycles"><span class="hs-identifier hs-type">ic_deposit_cycles</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Agent.html#HasAgentConfig"><span class="hs-identifier hs-type">HasAgentConfig</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Test.Agent.html#IC00"><span class="hs-identifier hs-type">IC00</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Id.Forms.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span id="ic_deposit_cycles"><span class="annot"><span class="annottext">ic_deposit_cycles :: HasAgentConfig =&gt; IC00 -&gt; Blob -&gt; IO ()
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_deposit_cycles"><span class="hs-identifier hs-var hs-var">ic_deposit_cycles</span></a></span></span><span> </span><span id="local-6989586621679351920"><span class="annot"><span class="annottext">IC00
</span><a href="#local-6989586621679351920"><span class="hs-identifier hs-var">ic00</span></a></span></span><span> </span><span id="local-6989586621679351919"><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679351919"><span class="hs-identifier hs-var">canister_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-115"></span><span>  </span><span class="annot"><span class="annottext">IC00
-&gt; Blob
-&gt; Label &quot;deposit_cycles&quot;
-&gt; Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
-&gt; IO ()
forall (s :: Symbol) a b.
(HasCallStack, HasAgentConfig, KnownSymbol s,
 (a -&gt; IO b) ~ (ICManagement IO .! s), CandidArg a, CandidArg b) =&gt;
IC00 -&gt; Blob -&gt; Label s -&gt; a -&gt; IO b
</span><a href="IC.Test.Agent.html#callIC"><span class="hs-identifier hs-var">callIC</span></a></span><span> </span><span class="annot"><span class="annottext">IC00
</span><a href="#local-6989586621679351920"><span class="hs-identifier hs-var">ic00</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679351919"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;deposit_cycles&quot; (Label &quot;deposit_cycles&quot;)
Label &quot;deposit_cycles&quot;
</span><a href="#local-6989586621679351972"><span class="hs-var">#deposit_cycles</span></a></span><span> </span><span class="annot"><span class="annottext">(Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal]) -&gt; IO ())
-&gt; Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal]) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec Empty
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span class="annot"><span class="annottext">Rec Empty
-&gt; Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
-&gt; Rec (Empty .+ 'R '[ &quot;canister_id&quot; ':-&gt; Principal])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;canister_id&quot; (Label &quot;canister_id&quot;)
Label &quot;canister_id&quot;
</span><a href="#local-6989586621679351966"><span class="hs-var">#canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;canister_id&quot;
-&gt; Principal -&gt; Rec (Extend &quot;canister_id&quot; Principal Empty)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Blob -&gt; Principal
</span><a href="file:///nix/store/5q8knwbpcq1xjhfifih1jfwmvd2jr0sg-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Data.html#Principal"><span class="hs-identifier hs-var">Principal</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679351919"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_top_up"><span class="hs-identifier hs-type">ic_top_up</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Agent.html#HasAgentConfig"><span class="hs-identifier hs-type">HasAgentConfig</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Test.Agent.html#IC00"><span class="hs-identifier hs-type">IC00</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Id.Forms.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-bignum-1.1/src/GHC.Num.Natural.html#Natural"><span class="hs-identifier hs-type">Natural</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span id="ic_top_up"><span class="annot"><span class="annottext">ic_top_up :: HasAgentConfig =&gt; IC00 -&gt; Blob -&gt; Natural -&gt; IO ()
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_top_up"><span class="hs-identifier hs-var hs-var">ic_top_up</span></a></span></span><span> </span><span id="local-6989586621679351826"><span class="annot"><span class="annottext">IC00
</span><a href="#local-6989586621679351826"><span class="hs-identifier hs-var">ic00</span></a></span></span><span> </span><span id="local-6989586621679351825"><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679351825"><span class="hs-identifier hs-var">canister_id</span></a></span></span><span> </span><span id="local-6989586621679351824"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679351824"><span class="hs-identifier hs-var">amount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-120"></span><span>  </span><span class="annot"><span class="annottext">IC00
-&gt; Blob
-&gt; Label &quot;provisional_top_up_canister&quot;
-&gt; Rec ('R '[ &quot;amount&quot; ':-&gt; Natural, &quot;canister_id&quot; ':-&gt; Principal])
-&gt; IO ()
forall (s :: Symbol) a b.
(HasCallStack, HasAgentConfig, KnownSymbol s,
 (a -&gt; IO b) ~ (ICManagement IO .! s), CandidArg a, CandidArg b) =&gt;
IC00 -&gt; Blob -&gt; Label s -&gt; a -&gt; IO b
</span><a href="IC.Test.Agent.html#callIC"><span class="hs-identifier hs-var">callIC</span></a></span><span> </span><span class="annot"><span class="annottext">IC00
</span><a href="#local-6989586621679351826"><span class="hs-identifier hs-var">ic00</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679351825"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;provisional_top_up_canister&quot; (Label &quot;provisional_top_up_canister&quot;)
Label &quot;provisional_top_up_canister&quot;
</span><a href="#local-6989586621679351907"><span class="hs-var">#provisional_top_up_canister</span></a></span><span> </span><span class="annot"><span class="annottext">(Rec ('R '[ &quot;amount&quot; ':-&gt; Natural, &quot;canister_id&quot; ':-&gt; Principal])
 -&gt; IO ())
-&gt; Rec ('R '[ &quot;amount&quot; ':-&gt; Natural, &quot;canister_id&quot; ':-&gt; Principal])
-&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec Empty
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><span class="annottext">Rec Empty
-&gt; Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
-&gt; Rec (Empty .+ 'R '[ &quot;canister_id&quot; ':-&gt; Principal])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;canister_id&quot; (Label &quot;canister_id&quot;)
Label &quot;canister_id&quot;
</span><a href="#local-6989586621679351897"><span class="hs-var">#canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;canister_id&quot;
-&gt; Principal -&gt; Rec (Extend &quot;canister_id&quot; Principal Empty)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Blob -&gt; Principal
</span><a href="file:///nix/store/5q8knwbpcq1xjhfifih1jfwmvd2jr0sg-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Data.html#Principal"><span class="hs-identifier hs-var">Principal</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679351825"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-122"></span><span>    </span><span class="annot"><span class="annottext">Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
-&gt; Rec ('R '[ &quot;amount&quot; ':-&gt; Natural])
-&gt; Rec
     ('R '[ &quot;canister_id&quot; ':-&gt; Principal]
      .+ 'R '[ &quot;amount&quot; ':-&gt; Natural])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;amount&quot; (Label &quot;amount&quot;)
Label &quot;amount&quot;
</span><a href="#local-6989586621679351893"><span class="hs-var">#amount</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;amount&quot; -&gt; Natural -&gt; Rec (&quot;amount&quot; .== Natural)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679351824"><span class="hs-identifier hs-var">amount</span></a></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_delete_canister"><span class="hs-identifier hs-type">ic_delete_canister</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Agent.html#HasAgentConfig"><span class="hs-identifier hs-type">HasAgentConfig</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Test.Agent.html#IC00"><span class="hs-identifier hs-type">IC00</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Id.Forms.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span id="ic_delete_canister"><span class="annot"><span class="annottext">ic_delete_canister :: HasAgentConfig =&gt; IC00 -&gt; Blob -&gt; IO ()
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_delete_canister"><span class="hs-identifier hs-var hs-var">ic_delete_canister</span></a></span></span><span> </span><span id="local-6989586621679351760"><span class="annot"><span class="annottext">IC00
</span><a href="#local-6989586621679351760"><span class="hs-identifier hs-var">ic00</span></a></span></span><span> </span><span id="local-6989586621679351759"><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679351759"><span class="hs-identifier hs-var">canister_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-126"></span><span>  </span><span class="annot"><span class="annottext">IC00
-&gt; Blob
-&gt; Label &quot;delete_canister&quot;
-&gt; Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
-&gt; IO ()
forall (s :: Symbol) a b.
(HasCallStack, HasAgentConfig, KnownSymbol s,
 (a -&gt; IO b) ~ (ICManagement IO .! s), CandidArg a, CandidArg b) =&gt;
IC00 -&gt; Blob -&gt; Label s -&gt; a -&gt; IO b
</span><a href="IC.Test.Agent.html#callIC"><span class="hs-identifier hs-var">callIC</span></a></span><span> </span><span class="annot"><span class="annottext">IC00
</span><a href="#local-6989586621679351760"><span class="hs-identifier hs-var">ic00</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679351759"><span class="hs-identifier hs-var">canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;delete_canister&quot; (Label &quot;delete_canister&quot;)
Label &quot;delete_canister&quot;
</span><a href="#local-6989586621679351812"><span class="hs-var">#delete_canister</span></a></span><span> </span><span class="annot"><span class="annottext">(Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal]) -&gt; IO ())
-&gt; Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal]) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec Empty
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-127"></span><span>    </span><span class="annot"><span class="annottext">Rec Empty
-&gt; Rec ('R '[ &quot;canister_id&quot; ':-&gt; Principal])
-&gt; Rec (Empty .+ 'R '[ &quot;canister_id&quot; ':-&gt; Principal])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;canister_id&quot; (Label &quot;canister_id&quot;)
Label &quot;canister_id&quot;
</span><a href="#local-6989586621679351806"><span class="hs-var">#canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;canister_id&quot;
-&gt; Principal -&gt; Rec (Extend &quot;canister_id&quot; Principal Empty)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Blob -&gt; Principal
</span><a href="file:///nix/store/5q8knwbpcq1xjhfifih1jfwmvd2jr0sg-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Data.html#Principal"><span class="hs-identifier hs-var">Principal</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679351759"><span class="hs-identifier hs-var">canister_id</span></a></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_raw_rand"><span class="hs-identifier hs-type">ic_raw_rand</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Agent.html#HasAgentConfig"><span class="hs-identifier hs-type">HasAgentConfig</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Test.Agent.html#IC00"><span class="hs-identifier hs-type">IC00</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Id.Forms.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="IC.Id.Forms.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span>
</span><span id="line-130"></span><span id="ic_raw_rand"><span class="annot"><span class="annottext">ic_raw_rand :: HasAgentConfig =&gt; IC00 -&gt; Blob -&gt; IO Blob
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_raw_rand"><span class="hs-identifier hs-var hs-var">ic_raw_rand</span></a></span></span><span> </span><span id="local-6989586621679351734"><span class="annot"><span class="annottext">IC00
</span><a href="#local-6989586621679351734"><span class="hs-identifier hs-var">ic00</span></a></span></span><span> </span><span id="local-6989586621679351733"><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679351733"><span class="hs-identifier hs-var">ecid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-131"></span><span>  </span><span class="annot"><span class="annottext">IC00 -&gt; Blob -&gt; Label &quot;raw_rand&quot; -&gt; () -&gt; IO Blob
forall (s :: Symbol) a b.
(HasCallStack, HasAgentConfig, KnownSymbol s,
 (a -&gt; IO b) ~ (ICManagement IO .! s), CandidArg a, CandidArg b) =&gt;
IC00 -&gt; Blob -&gt; Label s -&gt; a -&gt; IO b
</span><a href="IC.Test.Agent.html#callIC"><span class="hs-identifier hs-var">callIC</span></a></span><span> </span><span class="annot"><span class="annottext">IC00
</span><a href="#local-6989586621679351734"><span class="hs-identifier hs-var">ic00</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679351733"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;raw_rand&quot; (Label &quot;raw_rand&quot;)
Label &quot;raw_rand&quot;
</span><a href="#local-6989586621679351747"><span class="hs-var">#raw_rand</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_get_request"><span class="hs-identifier hs-type">ic_http_get_request</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679353583"><span class="annot"><a href="#local-6989586621679353583"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679353582"><span class="annot"><a href="#local-6989586621679353582"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679353583"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679353582"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Management.html#ICManagement"><span class="hs-identifier hs-type">ICManagement</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Internal.html#.%21"><span class="hs-operator hs-type">.!</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;http_request&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-135"></span><span>    </span><span class="annot"><a href="IC.Test.Agent.html#HasAgentConfig"><span class="hs-identifier hs-type">HasAgentConfig</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Test.Agent.html#IC00WithCycles"><span class="hs-identifier hs-type">IC00WithCycles</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#TestSubnetConfig"><span class="hs-identifier hs-type">TestSubnetConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">W.Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Id.Forms.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Id.Forms.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679353582"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-136"></span><span id="ic_http_get_request"><span class="annot"><span class="annottext">ic_http_get_request :: forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;),
 HasAgentConfig) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe (String, Blob)
-&gt; Blob
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_get_request"><span class="hs-identifier hs-var hs-var">ic_http_get_request</span></a></span></span><span> </span><span id="local-6989586621679351269"><span class="annot"><span class="annottext">IC00WithCycles
</span><a href="#local-6989586621679351269"><span class="hs-identifier hs-var">ic00</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EntityId
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679351268"><span class="annot"><span class="annottext">SubnetType
</span><a href="#local-6989586621679351268"><span class="hs-identifier hs-var">subnet_type</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679351267"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679351267"><span class="hs-identifier hs-var">subnet_size</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Word64, Word64)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679351266"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679351266"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span id="local-6989586621679351265"><span class="annot"><span class="annottext">Maybe Word64
</span><a href="#local-6989586621679351265"><span class="hs-identifier hs-var">max_response_bytes</span></a></span></span><span> </span><span id="local-6989586621679351264"><span class="annot"><span class="annottext">Maybe (String, Blob)
</span><a href="#local-6989586621679351264"><span class="hs-identifier hs-var">transform</span></a></span></span><span> </span><span id="local-6989586621679351263"><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679351263"><span class="hs-identifier hs-var">canister_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-137"></span><span>  </span><span class="annot"><span class="annottext">IC00
-&gt; Blob
-&gt; Label &quot;http_request&quot;
-&gt; Rec
     ('R
        '[ &quot;body&quot; ':-&gt; Maybe Blob,
           &quot;headers&quot;
           ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
           &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
           &quot;method&quot;
           ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
           &quot;transform&quot;
           ':-&gt; Maybe
                  (Rec
                     ('R
                        '[ &quot;context&quot; ':-&gt; Blob,
                           &quot;function&quot;
                           ':-&gt; FuncRef
                                  (Rec
                                     ('R
                                        '[ &quot;context&quot; ':-&gt; Blob,
                                           &quot;response&quot;
                                           ':-&gt; Rec
                                                  ('R
                                                     '[ &quot;body&quot; ':-&gt; Blob,
                                                        &quot;headers&quot;
                                                        ':-&gt; Vector
                                                               (Rec
                                                                  ('R
                                                                     '[ &quot;name&quot; ':-&gt; Text,
                                                                        &quot;value&quot; ':-&gt; Text])),
                                                        &quot;status&quot; ':-&gt; Natural])]),
                                   Rec
                                     ('R
                                        '[ &quot;body&quot; ':-&gt; Blob,
                                           &quot;headers&quot;
                                           ':-&gt; Vector
                                                  (Rec
                                                     ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                           &quot;status&quot; ':-&gt; Natural]),
                                   AnnTrue, AnnFalse)])),
           &quot;url&quot; ':-&gt; Text])
-&gt; IO b
forall (s :: Symbol) a b.
(HasCallStack, HasAgentConfig, KnownSymbol s,
 (a -&gt; IO b) ~ (ICManagement IO .! s), CandidArg a, CandidArg b) =&gt;
IC00 -&gt; Blob -&gt; Label s -&gt; a -&gt; IO b
</span><a href="IC.Test.Agent.html#callIC"><span class="hs-identifier hs-var">callIC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IC00WithCycles
</span><a href="#local-6989586621679351269"><span class="hs-identifier hs-var">ic00</span></a></span><span> </span><span class="annot"><span class="annottext">IC00WithCycles -&gt; IC00WithCycles
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; Maybe Blob,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;transform&quot;
        ':-&gt; Maybe
               (Rec
                  ('R
                     '[ &quot;context&quot; ':-&gt; Blob,
                        &quot;function&quot;
                        ':-&gt; FuncRef
                               (Rec
                                  ('R
                                     '[ &quot;context&quot; ':-&gt; Blob,
                                        &quot;response&quot;
                                        ':-&gt; Rec
                                               ('R
                                                  '[ &quot;body&quot; ':-&gt; Blob,
                                                     &quot;headers&quot;
                                                     ':-&gt; Vector
                                                            (Rec
                                                               ('R
                                                                  '[ &quot;name&quot; ':-&gt; Text,
                                                                     &quot;value&quot; ':-&gt; Text])),
                                                     &quot;status&quot; ':-&gt; Natural])]),
                                Rec
                                  ('R
                                     '[ &quot;body&quot; ':-&gt; Blob,
                                        &quot;headers&quot;
                                        ':-&gt; Vector
                                               (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                        &quot;status&quot; ':-&gt; Natural]),
                                AnnTrue, AnnFalse)])),
        &quot;url&quot; ':-&gt; Text])
-&gt; (SubnetType, Word64) -&gt; Word64
forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;)) =&gt;
a -&gt; (SubnetType, Word64) -&gt; Word64
</span><a href="IC.Utils.html#http_request_fee"><span class="hs-identifier hs-var">http_request_fee</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; Maybe Blob,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;transform&quot;
        ':-&gt; Maybe
               (Rec
                  ('R
                     '[ &quot;context&quot; ':-&gt; Blob,
                        &quot;function&quot;
                        ':-&gt; FuncRef
                               (Rec
                                  ('R
                                     '[ &quot;context&quot; ':-&gt; Blob,
                                        &quot;response&quot;
                                        ':-&gt; Rec
                                               ('R
                                                  '[ &quot;body&quot; ':-&gt; Blob,
                                                     &quot;headers&quot;
                                                     ':-&gt; Vector
                                                            (Rec
                                                               ('R
                                                                  '[ &quot;name&quot; ':-&gt; Text,
                                                                     &quot;value&quot; ':-&gt; Text])),
                                                     &quot;status&quot; ':-&gt; Natural])]),
                                Rec
                                  ('R
                                     '[ &quot;body&quot; ':-&gt; Blob,
                                        &quot;headers&quot;
                                        ':-&gt; Vector
                                               (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                        &quot;status&quot; ':-&gt; Natural]),
                                AnnTrue, AnnFalse)])),
        &quot;url&quot; ':-&gt; Text])
Rec
  ('R
     '[ &quot;body&quot; ':-&gt; Maybe Blob,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;url&quot; ':-&gt; Text]
   .+ 'R
        '[ &quot;transform&quot;
           ':-&gt; Maybe
                  (Rec
                     ('R
                        '[ &quot;context&quot; ':-&gt; Blob,
                           &quot;function&quot;
                           ':-&gt; FuncRef
                                  (Rec
                                     ('R
                                        '[ &quot;context&quot; ':-&gt; Blob,
                                           &quot;response&quot;
                                           ':-&gt; Rec
                                                  ('R
                                                     '[ &quot;body&quot; ':-&gt; Blob,
                                                        &quot;headers&quot;
                                                        ':-&gt; Vector
                                                               (Rec
                                                                  ('R
                                                                     '[ &quot;name&quot; ':-&gt; Text,
                                                                        &quot;value&quot; ':-&gt; Text])),
                                                        &quot;status&quot; ':-&gt; Natural])]),
                                   Rec
                                     ('R
                                        '[ &quot;body&quot; ':-&gt; Blob,
                                           &quot;headers&quot;
                                           ':-&gt; Vector
                                                  (Rec
                                                     ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                           &quot;status&quot; ':-&gt; Natural]),
                                   AnnTrue, AnnFalse)]))])
</span><a href="#local-6989586621679351261"><span class="hs-identifier hs-var">request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SubnetType
</span><a href="#local-6989586621679351268"><span class="hs-identifier hs-var">subnet_type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679351267"><span class="hs-identifier hs-var">subnet_size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Blob
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;http_request&quot; (Label &quot;http_request&quot;)
Label &quot;http_request&quot;
</span><a href="#local-6989586621679351657"><span class="hs-var">#http_request</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; Maybe Blob,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;transform&quot;
        ':-&gt; Maybe
               (Rec
                  ('R
                     '[ &quot;context&quot; ':-&gt; Blob,
                        &quot;function&quot;
                        ':-&gt; FuncRef
                               (Rec
                                  ('R
                                     '[ &quot;context&quot; ':-&gt; Blob,
                                        &quot;response&quot;
                                        ':-&gt; Rec
                                               ('R
                                                  '[ &quot;body&quot; ':-&gt; Blob,
                                                     &quot;headers&quot;
                                                     ':-&gt; Vector
                                                            (Rec
                                                               ('R
                                                                  '[ &quot;name&quot; ':-&gt; Text,
                                                                     &quot;value&quot; ':-&gt; Text])),
                                                     &quot;status&quot; ':-&gt; Natural])]),
                                Rec
                                  ('R
                                     '[ &quot;body&quot; ':-&gt; Blob,
                                        &quot;headers&quot;
                                        ':-&gt; Vector
                                               (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                        &quot;status&quot; ':-&gt; Natural]),
                                AnnTrue, AnnFalse)])),
        &quot;url&quot; ':-&gt; Text])
Rec
  ('R
     '[ &quot;body&quot; ':-&gt; Maybe Blob,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;url&quot; ':-&gt; Text]
   .+ 'R
        '[ &quot;transform&quot;
           ':-&gt; Maybe
                  (Rec
                     ('R
                        '[ &quot;context&quot; ':-&gt; Blob,
                           &quot;function&quot;
                           ':-&gt; FuncRef
                                  (Rec
                                     ('R
                                        '[ &quot;context&quot; ':-&gt; Blob,
                                           &quot;response&quot;
                                           ':-&gt; Rec
                                                  ('R
                                                     '[ &quot;body&quot; ':-&gt; Blob,
                                                        &quot;headers&quot;
                                                        ':-&gt; Vector
                                                               (Rec
                                                                  ('R
                                                                     '[ &quot;name&quot; ':-&gt; Text,
                                                                        &quot;value&quot; ':-&gt; Text])),
                                                        &quot;status&quot; ':-&gt; Natural])]),
                                   Rec
                                     ('R
                                        '[ &quot;body&quot; ':-&gt; Blob,
                                           &quot;headers&quot;
                                           ':-&gt; Vector
                                                  (Rec
                                                     ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                           &quot;status&quot; ':-&gt; Natural]),
                                   AnnTrue, AnnFalse)]))])
</span><a href="#local-6989586621679351261"><span class="hs-identifier hs-var">request</span></a></span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-139"></span><span>    </span><span id="local-6989586621679351261"><span class="annot"><span class="annottext">request :: Rec
  ('R
     '[ &quot;body&quot; ':-&gt; Maybe Blob,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;url&quot; ':-&gt; Text]
   .+ 'R
        '[ &quot;transform&quot;
           ':-&gt; Maybe
                  (Rec
                     ('R
                        '[ &quot;context&quot; ':-&gt; Blob,
                           &quot;function&quot;
                           ':-&gt; FuncRef
                                  (Rec
                                     ('R
                                        '[ &quot;context&quot; ':-&gt; Blob,
                                           &quot;response&quot;
                                           ':-&gt; Rec
                                                  ('R
                                                     '[ &quot;body&quot; ':-&gt; Blob,
                                                        &quot;headers&quot;
                                                        ':-&gt; Vector
                                                               (Rec
                                                                  ('R
                                                                     '[ &quot;name&quot; ':-&gt; Text,
                                                                        &quot;value&quot; ':-&gt; Text])),
                                                        &quot;status&quot; ':-&gt; Natural])]),
                                   Rec
                                     ('R
                                        '[ &quot;body&quot; ':-&gt; Blob,
                                           &quot;headers&quot;
                                           ':-&gt; Vector
                                                  (Rec
                                                     ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                           &quot;status&quot; ':-&gt; Natural]),
                                   AnnTrue, AnnFalse)]))])
</span><a href="#local-6989586621679351261"><span class="hs-identifier hs-var hs-var">request</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rec Empty
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-140"></span><span>      </span><span class="annot"><span class="annottext">Rec Empty
-&gt; Rec ('R '[ &quot;url&quot; ':-&gt; Text])
-&gt; Rec (Empty .+ 'R '[ &quot;url&quot; ':-&gt; Text])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;url&quot; (Label &quot;url&quot;)
Label &quot;url&quot;
</span><a href="#local-6989586621679351702"><span class="hs-var">#url</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;url&quot; -&gt; Text -&gt; Rec (Extend &quot;url&quot; Text Empty)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
HasAgentConfig =&gt; String
</span><a href="IC.Test.Agent.Calls.html#httpbin"><span class="hs-identifier hs-var">httpbin</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679351266"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>      </span><span class="annot"><span class="annottext">Rec ('R '[ &quot;url&quot; ':-&gt; Text])
-&gt; Rec ('R '[ &quot;max_response_bytes&quot; ':-&gt; Maybe Word64])
-&gt; Rec
     ('R '[ &quot;url&quot; ':-&gt; Text]
      .+ 'R '[ &quot;max_response_bytes&quot; ':-&gt; Maybe Word64])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;max_response_bytes&quot; (Label &quot;max_response_bytes&quot;)
Label &quot;max_response_bytes&quot;
</span><a href="#local-6989586621679351694"><span class="hs-var">#max_response_bytes</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;max_response_bytes&quot;
-&gt; Maybe Word64 -&gt; Rec (&quot;max_response_bytes&quot; .== Maybe Word64)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Word64
</span><a href="#local-6989586621679351265"><span class="hs-identifier hs-var">max_response_bytes</span></a></span><span>
</span><span id="line-142"></span><span>      </span><span class="annot"><span class="annottext">Rec
  ('R '[ &quot;max_response_bytes&quot; ':-&gt; Maybe Word64, &quot;url&quot; ':-&gt; Text])
-&gt; Rec
     ('R
        '[ &quot;method&quot;
           ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()])])
-&gt; Rec
     ('R '[ &quot;max_response_bytes&quot; ':-&gt; Maybe Word64, &quot;url&quot; ':-&gt; Text]
      .+ 'R
           '[ &quot;method&quot;
              ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()])])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;method&quot; (Label &quot;method&quot;)
Label &quot;method&quot;
</span><a href="#local-6989586621679351690"><span class="hs-var">#method</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;method&quot;
-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()])
-&gt; Rec
     (&quot;method&quot;
      .== Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]))
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;get&quot;
-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()])
forall (r :: Row (*)) (l :: Symbol).
(AllUniqueLabels r, KnownSymbol l, (r .! l) ~ ()) =&gt;
Label l -&gt; Var r
</span><a href="IC.Test.Agent.html#enum"><span class="hs-identifier hs-var">enum</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;get&quot; (Label &quot;get&quot;)
Label &quot;get&quot;
</span><a href="#local-6989586621679351683"><span class="hs-var">#get</span></a></span><span>
</span><span id="line-143"></span><span>      </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;url&quot; ':-&gt; Text])
-&gt; Rec
     ('R
        '[ &quot;headers&quot;
           ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text]))])
-&gt; Rec
     ('R
        '[ &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
           &quot;method&quot;
           ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
           &quot;url&quot; ':-&gt; Text]
      .+ 'R
           '[ &quot;headers&quot;
              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text]))])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;headers&quot; (Label &quot;headers&quot;)
Label &quot;headers&quot;
</span><a href="#local-6989586621679351680"><span class="hs-var">#headers</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;headers&quot;
-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text]))
-&gt; Rec
     (&quot;headers&quot;
      .== Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])))
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text]))
forall a. Vector a
</span><a href="file:///nix/store/5xj65cipwzdnpp6y5z9vwld366h065w2-vector-0.12.3.1-doc/share/doc/vector-0.12.3.1/html/src/Data.Vector.html#empty"><span class="hs-identifier hs-var">Vec.empty</span></a></span><span>
</span><span id="line-144"></span><span>      </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;url&quot; ':-&gt; Text])
-&gt; Rec ('R '[ &quot;body&quot; ':-&gt; Maybe Blob])
-&gt; Rec
     ('R
        '[ &quot;headers&quot;
           ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
           &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
           &quot;method&quot;
           ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
           &quot;url&quot; ':-&gt; Text]
      .+ 'R '[ &quot;body&quot; ':-&gt; Maybe Blob])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;body&quot; (Label &quot;body&quot;)
Label &quot;body&quot;
</span><a href="#local-6989586621679351677"><span class="hs-var">#body</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;body&quot; -&gt; Maybe Blob -&gt; Rec (&quot;body&quot; .== Maybe Blob)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Blob
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-145"></span><span>      </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; Maybe Blob,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;url&quot; ':-&gt; Text])
-&gt; Rec
     ('R
        '[ &quot;transform&quot;
           ':-&gt; Maybe
                  (Rec
                     ('R
                        '[ &quot;context&quot; ':-&gt; Blob,
                           &quot;function&quot;
                           ':-&gt; FuncRef
                                  (Rec
                                     ('R
                                        '[ &quot;context&quot; ':-&gt; Blob,
                                           &quot;response&quot;
                                           ':-&gt; Rec
                                                  ('R
                                                     '[ &quot;body&quot; ':-&gt; Blob,
                                                        &quot;headers&quot;
                                                        ':-&gt; Vector
                                                               (Rec
                                                                  ('R
                                                                     '[ &quot;name&quot; ':-&gt; Text,
                                                                        &quot;value&quot; ':-&gt; Text])),
                                                        &quot;status&quot; ':-&gt; Natural])]),
                                   Rec
                                     ('R
                                        '[ &quot;body&quot; ':-&gt; Blob,
                                           &quot;headers&quot;
                                           ':-&gt; Vector
                                                  (Rec
                                                     ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                           &quot;status&quot; ':-&gt; Natural]),
                                   AnnTrue, AnnFalse)]))])
-&gt; Rec
     ('R
        '[ &quot;body&quot; ':-&gt; Maybe Blob,
           &quot;headers&quot;
           ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
           &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
           &quot;method&quot;
           ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
           &quot;url&quot; ':-&gt; Text]
      .+ 'R
           '[ &quot;transform&quot;
              ':-&gt; Maybe
                     (Rec
                        ('R
                           '[ &quot;context&quot; ':-&gt; Blob,
                              &quot;function&quot;
                              ':-&gt; FuncRef
                                     (Rec
                                        ('R
                                           '[ &quot;context&quot; ':-&gt; Blob,
                                              &quot;response&quot;
                                              ':-&gt; Rec
                                                     ('R
                                                        '[ &quot;body&quot; ':-&gt; Blob,
                                                           &quot;headers&quot;
                                                           ':-&gt; Vector
                                                                  (Rec
                                                                     ('R
                                                                        '[ &quot;name&quot; ':-&gt; Text,
                                                                           &quot;value&quot; ':-&gt; Text])),
                                                           &quot;status&quot; ':-&gt; Natural])]),
                                      Rec
                                        ('R
                                           '[ &quot;body&quot; ':-&gt; Blob,
                                              &quot;headers&quot;
                                              ':-&gt; Vector
                                                     (Rec
                                                        ('R
                                                           '[ &quot;name&quot; ':-&gt; Text,
                                                              &quot;value&quot; ':-&gt; Text])),
                                              &quot;status&quot; ':-&gt; Natural]),
                                      AnnTrue, AnnFalse)]))])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;transform&quot; (Label &quot;transform&quot;)
Label &quot;transform&quot;
</span><a href="#local-6989586621679351674"><span class="hs-var">#transform</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;transform&quot;
-&gt; Maybe
     (Rec
        ('R
           '[ &quot;context&quot; ':-&gt; Blob,
              &quot;function&quot;
              ':-&gt; FuncRef
                     (Rec
                        ('R
                           '[ &quot;context&quot; ':-&gt; Blob,
                              &quot;response&quot;
                              ':-&gt; Rec
                                     ('R
                                        '[ &quot;body&quot; ':-&gt; Blob,
                                           &quot;headers&quot;
                                           ':-&gt; Vector
                                                  (Rec
                                                     ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                           &quot;status&quot; ':-&gt; Natural])]),
                      Rec
                        ('R
                           '[ &quot;body&quot; ':-&gt; Blob,
                              &quot;headers&quot;
                              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                              &quot;status&quot; ':-&gt; Natural]),
                      AnnTrue, AnnFalse)]))
-&gt; Rec
     (&quot;transform&quot;
      .== Maybe
            (Rec
               ('R
                  '[ &quot;context&quot; ':-&gt; Blob,
                     &quot;function&quot;
                     ':-&gt; FuncRef
                            (Rec
                               ('R
                                  '[ &quot;context&quot; ':-&gt; Blob,
                                     &quot;response&quot;
                                     ':-&gt; Rec
                                            ('R
                                               '[ &quot;body&quot; ':-&gt; Blob,
                                                  &quot;headers&quot;
                                                  ':-&gt; Vector
                                                         (Rec
                                                            ('R
                                                               '[ &quot;name&quot; ':-&gt; Text,
                                                                  &quot;value&quot; ':-&gt; Text])),
                                                  &quot;status&quot; ':-&gt; Natural])]),
                             Rec
                               ('R
                                  '[ &quot;body&quot; ':-&gt; Blob,
                                     &quot;headers&quot;
                                     ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                     &quot;status&quot; ':-&gt; Natural]),
                             AnnTrue, AnnFalse)])))
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (String, Blob)
-&gt; Blob
-&gt; Maybe
     (Rec
        ('R
           '[ &quot;context&quot; ':-&gt; Blob,
              &quot;function&quot;
              ':-&gt; FuncRef
                     (Rec
                        ('R
                           '[ &quot;context&quot; ':-&gt; Blob,
                              &quot;response&quot;
                              ':-&gt; Rec
                                     ('R
                                        '[ &quot;body&quot; ':-&gt; Blob,
                                           &quot;headers&quot;
                                           ':-&gt; Vector
                                                  (Rec
                                                     ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                           &quot;status&quot; ':-&gt; Natural])]),
                      Rec
                        ('R
                           '[ &quot;body&quot; ':-&gt; Blob,
                              &quot;headers&quot;
                              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                              &quot;status&quot; ':-&gt; Natural]),
                      AnnTrue, AnnFalse)]))
forall a r.
Maybe (String, a)
-&gt; Blob
-&gt; Maybe (Rec ('R '[ &quot;context&quot; ':-&gt; a, &quot;function&quot; ':-&gt; FuncRef r]))
</span><a href="IC.Test.Agent.Calls.html#toTransformFn"><span class="hs-identifier hs-var">toTransformFn</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (String, Blob)
</span><a href="#local-6989586621679351264"><span class="hs-identifier hs-var">transform</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679351263"><span class="hs-identifier hs-var">canister_id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span id="local-6989586621679353554"><span id="local-6989586621679353555"><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_post_request"><span class="hs-identifier hs-type">ic_http_post_request</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Agent.html#HasAgentConfig"><span class="hs-identifier hs-type">HasAgentConfig</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679353555"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679353554"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Management.html#ICManagement"><span class="hs-identifier hs-type">ICManagement</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Internal.html#.%21"><span class="hs-operator hs-type">.!</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;http_request&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-149"></span><span>    </span><span class="annot"><a href="IC.Test.Agent.html#IC00WithCycles"><span class="hs-identifier hs-type">IC00WithCycles</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#TestSubnetConfig"><span class="hs-identifier hs-type">TestSubnetConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">W.Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/bytestring-0.10.12.1/src/Data.ByteString.Lazy.Internal.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/5xj65cipwzdnpp6y5z9vwld366h065w2-vector-0.12.3.1-doc/share/doc/vector-0.12.3.1/html/src/Data.Vector.html#Vector"><span class="hs-identifier hs-type">Vec.Vector</span></a></span><span> </span><span class="annot"><a href="IC.Management.html#HttpHeader"><span class="hs-identifier hs-type">HttpHeader</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Id.Forms.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Id.Forms.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679353554"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-150"></span><span id="ic_http_post_request"><span class="annot"><span class="annottext">ic_http_post_request :: forall a b.
(HasAgentConfig,
 (a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;)) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe Blob
-&gt; Vector HttpHeader
-&gt; Maybe (String, Blob)
-&gt; Blob
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_post_request"><span class="hs-identifier hs-var hs-var">ic_http_post_request</span></a></span></span><span> </span><span id="local-6989586621679350801"><span class="annot"><span class="annottext">IC00WithCycles
</span><a href="#local-6989586621679350801"><span class="hs-identifier hs-var">ic00</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EntityId
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679350800"><span class="annot"><span class="annottext">SubnetType
</span><a href="#local-6989586621679350800"><span class="hs-identifier hs-var">subnet_type</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679350799"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679350799"><span class="hs-identifier hs-var">subnet_size</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Word64, Word64)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679350798"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679350798"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span id="local-6989586621679350797"><span class="annot"><span class="annottext">Maybe Word64
</span><a href="#local-6989586621679350797"><span class="hs-identifier hs-var">max_response_bytes</span></a></span></span><span> </span><span id="local-6989586621679350796"><span class="annot"><span class="annottext">Maybe Blob
</span><a href="#local-6989586621679350796"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span id="local-6989586621679350795"><span class="annot"><span class="annottext">Vector HttpHeader
</span><a href="#local-6989586621679350795"><span class="hs-identifier hs-var">headers</span></a></span></span><span> </span><span id="local-6989586621679350794"><span class="annot"><span class="annottext">Maybe (String, Blob)
</span><a href="#local-6989586621679350794"><span class="hs-identifier hs-var">transform</span></a></span></span><span> </span><span id="local-6989586621679350793"><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679350793"><span class="hs-identifier hs-var">canister_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-151"></span><span>  </span><span class="annot"><span class="annottext">IC00
-&gt; Blob
-&gt; Label &quot;http_request&quot;
-&gt; Rec
     ('R
        '[ &quot;body&quot; ':-&gt; Maybe Blob,
           &quot;headers&quot;
           ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
           &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
           &quot;method&quot;
           ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
           &quot;transform&quot;
           ':-&gt; Maybe
                  (Rec
                     ('R
                        '[ &quot;context&quot; ':-&gt; Blob,
                           &quot;function&quot;
                           ':-&gt; FuncRef
                                  (Rec
                                     ('R
                                        '[ &quot;context&quot; ':-&gt; Blob,
                                           &quot;response&quot;
                                           ':-&gt; Rec
                                                  ('R
                                                     '[ &quot;body&quot; ':-&gt; Blob,
                                                        &quot;headers&quot;
                                                        ':-&gt; Vector
                                                               (Rec
                                                                  ('R
                                                                     '[ &quot;name&quot; ':-&gt; Text,
                                                                        &quot;value&quot; ':-&gt; Text])),
                                                        &quot;status&quot; ':-&gt; Natural])]),
                                   Rec
                                     ('R
                                        '[ &quot;body&quot; ':-&gt; Blob,
                                           &quot;headers&quot;
                                           ':-&gt; Vector
                                                  (Rec
                                                     ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                           &quot;status&quot; ':-&gt; Natural]),
                                   AnnTrue, AnnFalse)])),
           &quot;url&quot; ':-&gt; Text])
-&gt; IO b
forall (s :: Symbol) a b.
(HasCallStack, HasAgentConfig, KnownSymbol s,
 (a -&gt; IO b) ~ (ICManagement IO .! s), CandidArg a, CandidArg b) =&gt;
IC00 -&gt; Blob -&gt; Label s -&gt; a -&gt; IO b
</span><a href="IC.Test.Agent.html#callIC"><span class="hs-identifier hs-var">callIC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IC00WithCycles
</span><a href="#local-6989586621679350801"><span class="hs-identifier hs-var">ic00</span></a></span><span> </span><span class="annot"><span class="annottext">IC00WithCycles -&gt; IC00WithCycles
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; Maybe Blob,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;transform&quot;
        ':-&gt; Maybe
               (Rec
                  ('R
                     '[ &quot;context&quot; ':-&gt; Blob,
                        &quot;function&quot;
                        ':-&gt; FuncRef
                               (Rec
                                  ('R
                                     '[ &quot;context&quot; ':-&gt; Blob,
                                        &quot;response&quot;
                                        ':-&gt; Rec
                                               ('R
                                                  '[ &quot;body&quot; ':-&gt; Blob,
                                                     &quot;headers&quot;
                                                     ':-&gt; Vector
                                                            (Rec
                                                               ('R
                                                                  '[ &quot;name&quot; ':-&gt; Text,
                                                                     &quot;value&quot; ':-&gt; Text])),
                                                     &quot;status&quot; ':-&gt; Natural])]),
                                Rec
                                  ('R
                                     '[ &quot;body&quot; ':-&gt; Blob,
                                        &quot;headers&quot;
                                        ':-&gt; Vector
                                               (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                        &quot;status&quot; ':-&gt; Natural]),
                                AnnTrue, AnnFalse)])),
        &quot;url&quot; ':-&gt; Text])
-&gt; (SubnetType, Word64) -&gt; Word64
forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;)) =&gt;
a -&gt; (SubnetType, Word64) -&gt; Word64
</span><a href="IC.Utils.html#http_request_fee"><span class="hs-identifier hs-var">http_request_fee</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; Maybe Blob,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;transform&quot;
        ':-&gt; Maybe
               (Rec
                  ('R
                     '[ &quot;context&quot; ':-&gt; Blob,
                        &quot;function&quot;
                        ':-&gt; FuncRef
                               (Rec
                                  ('R
                                     '[ &quot;context&quot; ':-&gt; Blob,
                                        &quot;response&quot;
                                        ':-&gt; Rec
                                               ('R
                                                  '[ &quot;body&quot; ':-&gt; Blob,
                                                     &quot;headers&quot;
                                                     ':-&gt; Vector
                                                            (Rec
                                                               ('R
                                                                  '[ &quot;name&quot; ':-&gt; Text,
                                                                     &quot;value&quot; ':-&gt; Text])),
                                                     &quot;status&quot; ':-&gt; Natural])]),
                                Rec
                                  ('R
                                     '[ &quot;body&quot; ':-&gt; Blob,
                                        &quot;headers&quot;
                                        ':-&gt; Vector
                                               (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                        &quot;status&quot; ':-&gt; Natural]),
                                AnnTrue, AnnFalse)])),
        &quot;url&quot; ':-&gt; Text])
Rec
  ('R
     '[ &quot;body&quot; ':-&gt; Maybe Blob,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;url&quot; ':-&gt; Text]
   .+ 'R
        '[ &quot;transform&quot;
           ':-&gt; Maybe
                  (Rec
                     ('R
                        '[ &quot;context&quot; ':-&gt; Blob,
                           &quot;function&quot;
                           ':-&gt; FuncRef
                                  (Rec
                                     ('R
                                        '[ &quot;context&quot; ':-&gt; Blob,
                                           &quot;response&quot;
                                           ':-&gt; Rec
                                                  ('R
                                                     '[ &quot;body&quot; ':-&gt; Blob,
                                                        &quot;headers&quot;
                                                        ':-&gt; Vector
                                                               (Rec
                                                                  ('R
                                                                     '[ &quot;name&quot; ':-&gt; Text,
                                                                        &quot;value&quot; ':-&gt; Text])),
                                                        &quot;status&quot; ':-&gt; Natural])]),
                                   Rec
                                     ('R
                                        '[ &quot;body&quot; ':-&gt; Blob,
                                           &quot;headers&quot;
                                           ':-&gt; Vector
                                                  (Rec
                                                     ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                           &quot;status&quot; ':-&gt; Natural]),
                                   AnnTrue, AnnFalse)]))])
</span><a href="#local-6989586621679350792"><span class="hs-identifier hs-var">request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SubnetType
</span><a href="#local-6989586621679350800"><span class="hs-identifier hs-var">subnet_type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679350799"><span class="hs-identifier hs-var">subnet_size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Blob
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;http_request&quot; (Label &quot;http_request&quot;)
Label &quot;http_request&quot;
</span><a href="#local-6989586621679351181"><span class="hs-var">#http_request</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; Maybe Blob,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;transform&quot;
        ':-&gt; Maybe
               (Rec
                  ('R
                     '[ &quot;context&quot; ':-&gt; Blob,
                        &quot;function&quot;
                        ':-&gt; FuncRef
                               (Rec
                                  ('R
                                     '[ &quot;context&quot; ':-&gt; Blob,
                                        &quot;response&quot;
                                        ':-&gt; Rec
                                               ('R
                                                  '[ &quot;body&quot; ':-&gt; Blob,
                                                     &quot;headers&quot;
                                                     ':-&gt; Vector
                                                            (Rec
                                                               ('R
                                                                  '[ &quot;name&quot; ':-&gt; Text,
                                                                     &quot;value&quot; ':-&gt; Text])),
                                                     &quot;status&quot; ':-&gt; Natural])]),
                                Rec
                                  ('R
                                     '[ &quot;body&quot; ':-&gt; Blob,
                                        &quot;headers&quot;
                                        ':-&gt; Vector
                                               (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                        &quot;status&quot; ':-&gt; Natural]),
                                AnnTrue, AnnFalse)])),
        &quot;url&quot; ':-&gt; Text])
Rec
  ('R
     '[ &quot;body&quot; ':-&gt; Maybe Blob,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;url&quot; ':-&gt; Text]
   .+ 'R
        '[ &quot;transform&quot;
           ':-&gt; Maybe
                  (Rec
                     ('R
                        '[ &quot;context&quot; ':-&gt; Blob,
                           &quot;function&quot;
                           ':-&gt; FuncRef
                                  (Rec
                                     ('R
                                        '[ &quot;context&quot; ':-&gt; Blob,
                                           &quot;response&quot;
                                           ':-&gt; Rec
                                                  ('R
                                                     '[ &quot;body&quot; ':-&gt; Blob,
                                                        &quot;headers&quot;
                                                        ':-&gt; Vector
                                                               (Rec
                                                                  ('R
                                                                     '[ &quot;name&quot; ':-&gt; Text,
                                                                        &quot;value&quot; ':-&gt; Text])),
                                                        &quot;status&quot; ':-&gt; Natural])]),
                                   Rec
                                     ('R
                                        '[ &quot;body&quot; ':-&gt; Blob,
                                           &quot;headers&quot;
                                           ':-&gt; Vector
                                                  (Rec
                                                     ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                           &quot;status&quot; ':-&gt; Natural]),
                                   AnnTrue, AnnFalse)]))])
</span><a href="#local-6989586621679350792"><span class="hs-identifier hs-var">request</span></a></span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-153"></span><span>    </span><span id="local-6989586621679350792"><span class="annot"><span class="annottext">request :: Rec
  ('R
     '[ &quot;body&quot; ':-&gt; Maybe Blob,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;url&quot; ':-&gt; Text]
   .+ 'R
        '[ &quot;transform&quot;
           ':-&gt; Maybe
                  (Rec
                     ('R
                        '[ &quot;context&quot; ':-&gt; Blob,
                           &quot;function&quot;
                           ':-&gt; FuncRef
                                  (Rec
                                     ('R
                                        '[ &quot;context&quot; ':-&gt; Blob,
                                           &quot;response&quot;
                                           ':-&gt; Rec
                                                  ('R
                                                     '[ &quot;body&quot; ':-&gt; Blob,
                                                        &quot;headers&quot;
                                                        ':-&gt; Vector
                                                               (Rec
                                                                  ('R
                                                                     '[ &quot;name&quot; ':-&gt; Text,
                                                                        &quot;value&quot; ':-&gt; Text])),
                                                        &quot;status&quot; ':-&gt; Natural])]),
                                   Rec
                                     ('R
                                        '[ &quot;body&quot; ':-&gt; Blob,
                                           &quot;headers&quot;
                                           ':-&gt; Vector
                                                  (Rec
                                                     ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                           &quot;status&quot; ':-&gt; Natural]),
                                   AnnTrue, AnnFalse)]))])
</span><a href="#local-6989586621679350792"><span class="hs-identifier hs-var hs-var">request</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rec Empty
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-154"></span><span>      </span><span class="annot"><span class="annottext">Rec Empty
-&gt; Rec ('R '[ &quot;url&quot; ':-&gt; Text])
-&gt; Rec (Empty .+ 'R '[ &quot;url&quot; ':-&gt; Text])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;url&quot; (Label &quot;url&quot;)
Label &quot;url&quot;
</span><a href="#local-6989586621679351224"><span class="hs-var">#url</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;url&quot; -&gt; Text -&gt; Rec (Extend &quot;url&quot; Text Empty)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
HasAgentConfig =&gt; String
</span><a href="IC.Test.Agent.Calls.html#httpbin"><span class="hs-identifier hs-var">httpbin</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679350798"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>      </span><span class="annot"><span class="annottext">Rec ('R '[ &quot;url&quot; ':-&gt; Text])
-&gt; Rec ('R '[ &quot;max_response_bytes&quot; ':-&gt; Maybe Word64])
-&gt; Rec
     ('R '[ &quot;url&quot; ':-&gt; Text]
      .+ 'R '[ &quot;max_response_bytes&quot; ':-&gt; Maybe Word64])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;max_response_bytes&quot; (Label &quot;max_response_bytes&quot;)
Label &quot;max_response_bytes&quot;
</span><a href="#local-6989586621679351217"><span class="hs-var">#max_response_bytes</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;max_response_bytes&quot;
-&gt; Maybe Word64 -&gt; Rec (&quot;max_response_bytes&quot; .== Maybe Word64)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Word64
</span><a href="#local-6989586621679350797"><span class="hs-identifier hs-var">max_response_bytes</span></a></span><span>
</span><span id="line-156"></span><span>      </span><span class="annot"><span class="annottext">Rec
  ('R '[ &quot;max_response_bytes&quot; ':-&gt; Maybe Word64, &quot;url&quot; ':-&gt; Text])
-&gt; Rec
     ('R
        '[ &quot;method&quot;
           ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()])])
-&gt; Rec
     ('R '[ &quot;max_response_bytes&quot; ':-&gt; Maybe Word64, &quot;url&quot; ':-&gt; Text]
      .+ 'R
           '[ &quot;method&quot;
              ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()])])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;method&quot; (Label &quot;method&quot;)
Label &quot;method&quot;
</span><a href="#local-6989586621679351213"><span class="hs-var">#method</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;method&quot;
-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()])
-&gt; Rec
     (&quot;method&quot;
      .== Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]))
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;post&quot;
-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()])
forall (r :: Row (*)) (l :: Symbol).
(AllUniqueLabels r, KnownSymbol l, (r .! l) ~ ()) =&gt;
Label l -&gt; Var r
</span><a href="IC.Test.Agent.html#enum"><span class="hs-identifier hs-var">enum</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;post&quot; (Label &quot;post&quot;)
Label &quot;post&quot;
</span><a href="#local-6989586621679351206"><span class="hs-var">#post</span></a></span><span>
</span><span id="line-157"></span><span>      </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;url&quot; ':-&gt; Text])
-&gt; Rec
     ('R
        '[ &quot;headers&quot;
           ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text]))])
-&gt; Rec
     ('R
        '[ &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
           &quot;method&quot;
           ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
           &quot;url&quot; ':-&gt; Text]
      .+ 'R
           '[ &quot;headers&quot;
              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text]))])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;headers&quot; (Label &quot;headers&quot;)
Label &quot;headers&quot;
</span><a href="#local-6989586621679351203"><span class="hs-var">#headers</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;headers&quot;
-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text]))
-&gt; Rec
     (&quot;headers&quot;
      .== Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])))
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text]))
Vector HttpHeader
</span><a href="#local-6989586621679350795"><span class="hs-identifier hs-var">headers</span></a></span><span>
</span><span id="line-158"></span><span>      </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;url&quot; ':-&gt; Text])
-&gt; Rec ('R '[ &quot;body&quot; ':-&gt; Maybe Blob])
-&gt; Rec
     ('R
        '[ &quot;headers&quot;
           ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
           &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
           &quot;method&quot;
           ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
           &quot;url&quot; ':-&gt; Text]
      .+ 'R '[ &quot;body&quot; ':-&gt; Maybe Blob])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;body&quot; (Label &quot;body&quot;)
Label &quot;body&quot;
</span><a href="#local-6989586621679351200"><span class="hs-var">#body</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;body&quot; -&gt; Maybe Blob -&gt; Rec (&quot;body&quot; .== Maybe Blob)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Blob
</span><a href="#local-6989586621679350796"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-159"></span><span>      </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; Maybe Blob,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;url&quot; ':-&gt; Text])
-&gt; Rec
     ('R
        '[ &quot;transform&quot;
           ':-&gt; Maybe
                  (Rec
                     ('R
                        '[ &quot;context&quot; ':-&gt; Blob,
                           &quot;function&quot;
                           ':-&gt; FuncRef
                                  (Rec
                                     ('R
                                        '[ &quot;context&quot; ':-&gt; Blob,
                                           &quot;response&quot;
                                           ':-&gt; Rec
                                                  ('R
                                                     '[ &quot;body&quot; ':-&gt; Blob,
                                                        &quot;headers&quot;
                                                        ':-&gt; Vector
                                                               (Rec
                                                                  ('R
                                                                     '[ &quot;name&quot; ':-&gt; Text,
                                                                        &quot;value&quot; ':-&gt; Text])),
                                                        &quot;status&quot; ':-&gt; Natural])]),
                                   Rec
                                     ('R
                                        '[ &quot;body&quot; ':-&gt; Blob,
                                           &quot;headers&quot;
                                           ':-&gt; Vector
                                                  (Rec
                                                     ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                           &quot;status&quot; ':-&gt; Natural]),
                                   AnnTrue, AnnFalse)]))])
-&gt; Rec
     ('R
        '[ &quot;body&quot; ':-&gt; Maybe Blob,
           &quot;headers&quot;
           ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
           &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
           &quot;method&quot;
           ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
           &quot;url&quot; ':-&gt; Text]
      .+ 'R
           '[ &quot;transform&quot;
              ':-&gt; Maybe
                     (Rec
                        ('R
                           '[ &quot;context&quot; ':-&gt; Blob,
                              &quot;function&quot;
                              ':-&gt; FuncRef
                                     (Rec
                                        ('R
                                           '[ &quot;context&quot; ':-&gt; Blob,
                                              &quot;response&quot;
                                              ':-&gt; Rec
                                                     ('R
                                                        '[ &quot;body&quot; ':-&gt; Blob,
                                                           &quot;headers&quot;
                                                           ':-&gt; Vector
                                                                  (Rec
                                                                     ('R
                                                                        '[ &quot;name&quot; ':-&gt; Text,
                                                                           &quot;value&quot; ':-&gt; Text])),
                                                           &quot;status&quot; ':-&gt; Natural])]),
                                      Rec
                                        ('R
                                           '[ &quot;body&quot; ':-&gt; Blob,
                                              &quot;headers&quot;
                                              ':-&gt; Vector
                                                     (Rec
                                                        ('R
                                                           '[ &quot;name&quot; ':-&gt; Text,
                                                              &quot;value&quot; ':-&gt; Text])),
                                              &quot;status&quot; ':-&gt; Natural]),
                                      AnnTrue, AnnFalse)]))])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;transform&quot; (Label &quot;transform&quot;)
Label &quot;transform&quot;
</span><a href="#local-6989586621679351197"><span class="hs-var">#transform</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;transform&quot;
-&gt; Maybe
     (Rec
        ('R
           '[ &quot;context&quot; ':-&gt; Blob,
              &quot;function&quot;
              ':-&gt; FuncRef
                     (Rec
                        ('R
                           '[ &quot;context&quot; ':-&gt; Blob,
                              &quot;response&quot;
                              ':-&gt; Rec
                                     ('R
                                        '[ &quot;body&quot; ':-&gt; Blob,
                                           &quot;headers&quot;
                                           ':-&gt; Vector
                                                  (Rec
                                                     ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                           &quot;status&quot; ':-&gt; Natural])]),
                      Rec
                        ('R
                           '[ &quot;body&quot; ':-&gt; Blob,
                              &quot;headers&quot;
                              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                              &quot;status&quot; ':-&gt; Natural]),
                      AnnTrue, AnnFalse)]))
-&gt; Rec
     (&quot;transform&quot;
      .== Maybe
            (Rec
               ('R
                  '[ &quot;context&quot; ':-&gt; Blob,
                     &quot;function&quot;
                     ':-&gt; FuncRef
                            (Rec
                               ('R
                                  '[ &quot;context&quot; ':-&gt; Blob,
                                     &quot;response&quot;
                                     ':-&gt; Rec
                                            ('R
                                               '[ &quot;body&quot; ':-&gt; Blob,
                                                  &quot;headers&quot;
                                                  ':-&gt; Vector
                                                         (Rec
                                                            ('R
                                                               '[ &quot;name&quot; ':-&gt; Text,
                                                                  &quot;value&quot; ':-&gt; Text])),
                                                  &quot;status&quot; ':-&gt; Natural])]),
                             Rec
                               ('R
                                  '[ &quot;body&quot; ':-&gt; Blob,
                                     &quot;headers&quot;
                                     ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                     &quot;status&quot; ':-&gt; Natural]),
                             AnnTrue, AnnFalse)])))
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (String, Blob)
-&gt; Blob
-&gt; Maybe
     (Rec
        ('R
           '[ &quot;context&quot; ':-&gt; Blob,
              &quot;function&quot;
              ':-&gt; FuncRef
                     (Rec
                        ('R
                           '[ &quot;context&quot; ':-&gt; Blob,
                              &quot;response&quot;
                              ':-&gt; Rec
                                     ('R
                                        '[ &quot;body&quot; ':-&gt; Blob,
                                           &quot;headers&quot;
                                           ':-&gt; Vector
                                                  (Rec
                                                     ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                           &quot;status&quot; ':-&gt; Natural])]),
                      Rec
                        ('R
                           '[ &quot;body&quot; ':-&gt; Blob,
                              &quot;headers&quot;
                              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                              &quot;status&quot; ':-&gt; Natural]),
                      AnnTrue, AnnFalse)]))
forall a r.
Maybe (String, a)
-&gt; Blob
-&gt; Maybe (Rec ('R '[ &quot;context&quot; ':-&gt; a, &quot;function&quot; ':-&gt; FuncRef r]))
</span><a href="IC.Test.Agent.Calls.html#toTransformFn"><span class="hs-identifier hs-var">toTransformFn</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (String, Blob)
</span><a href="#local-6989586621679350794"><span class="hs-identifier hs-var">transform</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679350793"><span class="hs-identifier hs-var">canister_id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span id="local-6989586621679350790"><span id="local-6989586621679350791"><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_head_request"><span class="hs-identifier hs-type">ic_http_head_request</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Agent.html#HasAgentConfig"><span class="hs-identifier hs-type">HasAgentConfig</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679350791"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679350790"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Management.html#ICManagement"><span class="hs-identifier hs-type">ICManagement</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Internal.html#.%21"><span class="hs-operator hs-type">.!</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;http_request&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-163"></span><span>    </span><span class="annot"><a href="IC.Test.Agent.html#IC00WithCycles"><span class="hs-identifier hs-type">IC00WithCycles</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#TestSubnetConfig"><span class="hs-identifier hs-type">TestSubnetConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">W.Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/bytestring-0.10.12.1/src/Data.ByteString.Lazy.Internal.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/5xj65cipwzdnpp6y5z9vwld366h065w2-vector-0.12.3.1-doc/share/doc/vector-0.12.3.1/html/src/Data.Vector.html#Vector"><span class="hs-identifier hs-type">Vec.Vector</span></a></span><span> </span><span class="annot"><a href="IC.Management.html#HttpHeader"><span class="hs-identifier hs-type">HttpHeader</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Id.Forms.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Id.Forms.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679350790"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-164"></span><span id="ic_http_head_request"><span class="annot"><span class="annottext">ic_http_head_request :: forall a b.
(HasAgentConfig,
 (a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;)) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Maybe Word64
-&gt; Maybe Blob
-&gt; Vector HttpHeader
-&gt; Maybe (String, Blob)
-&gt; Blob
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_http_head_request"><span class="hs-identifier hs-var hs-var">ic_http_head_request</span></a></span></span><span> </span><span id="local-6989586621679350336"><span class="annot"><span class="annottext">IC00WithCycles
</span><a href="#local-6989586621679350336"><span class="hs-identifier hs-var">ic00</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EntityId
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679350335"><span class="annot"><span class="annottext">SubnetType
</span><a href="#local-6989586621679350335"><span class="hs-identifier hs-var">subnet_type</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679350334"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679350334"><span class="hs-identifier hs-var">subnet_size</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Word64, Word64)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679350333"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679350333"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span id="local-6989586621679350332"><span class="annot"><span class="annottext">Maybe Word64
</span><a href="#local-6989586621679350332"><span class="hs-identifier hs-var">max_response_bytes</span></a></span></span><span> </span><span id="local-6989586621679350331"><span class="annot"><span class="annottext">Maybe Blob
</span><a href="#local-6989586621679350331"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span id="local-6989586621679350330"><span class="annot"><span class="annottext">Vector HttpHeader
</span><a href="#local-6989586621679350330"><span class="hs-identifier hs-var">headers</span></a></span></span><span> </span><span id="local-6989586621679350329"><span class="annot"><span class="annottext">Maybe (String, Blob)
</span><a href="#local-6989586621679350329"><span class="hs-identifier hs-var">transform</span></a></span></span><span> </span><span id="local-6989586621679350328"><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679350328"><span class="hs-identifier hs-var">canister_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-165"></span><span>  </span><span class="annot"><span class="annottext">IC00
-&gt; Blob
-&gt; Label &quot;http_request&quot;
-&gt; Rec
     ('R
        '[ &quot;body&quot; ':-&gt; Maybe Blob,
           &quot;headers&quot;
           ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
           &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
           &quot;method&quot;
           ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
           &quot;transform&quot;
           ':-&gt; Maybe
                  (Rec
                     ('R
                        '[ &quot;context&quot; ':-&gt; Blob,
                           &quot;function&quot;
                           ':-&gt; FuncRef
                                  (Rec
                                     ('R
                                        '[ &quot;context&quot; ':-&gt; Blob,
                                           &quot;response&quot;
                                           ':-&gt; Rec
                                                  ('R
                                                     '[ &quot;body&quot; ':-&gt; Blob,
                                                        &quot;headers&quot;
                                                        ':-&gt; Vector
                                                               (Rec
                                                                  ('R
                                                                     '[ &quot;name&quot; ':-&gt; Text,
                                                                        &quot;value&quot; ':-&gt; Text])),
                                                        &quot;status&quot; ':-&gt; Natural])]),
                                   Rec
                                     ('R
                                        '[ &quot;body&quot; ':-&gt; Blob,
                                           &quot;headers&quot;
                                           ':-&gt; Vector
                                                  (Rec
                                                     ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                           &quot;status&quot; ':-&gt; Natural]),
                                   AnnTrue, AnnFalse)])),
           &quot;url&quot; ':-&gt; Text])
-&gt; IO b
forall (s :: Symbol) a b.
(HasCallStack, HasAgentConfig, KnownSymbol s,
 (a -&gt; IO b) ~ (ICManagement IO .! s), CandidArg a, CandidArg b) =&gt;
IC00 -&gt; Blob -&gt; Label s -&gt; a -&gt; IO b
</span><a href="IC.Test.Agent.html#callIC"><span class="hs-identifier hs-var">callIC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IC00WithCycles
</span><a href="#local-6989586621679350336"><span class="hs-identifier hs-var">ic00</span></a></span><span> </span><span class="annot"><span class="annottext">IC00WithCycles -&gt; IC00WithCycles
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; Maybe Blob,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;transform&quot;
        ':-&gt; Maybe
               (Rec
                  ('R
                     '[ &quot;context&quot; ':-&gt; Blob,
                        &quot;function&quot;
                        ':-&gt; FuncRef
                               (Rec
                                  ('R
                                     '[ &quot;context&quot; ':-&gt; Blob,
                                        &quot;response&quot;
                                        ':-&gt; Rec
                                               ('R
                                                  '[ &quot;body&quot; ':-&gt; Blob,
                                                     &quot;headers&quot;
                                                     ':-&gt; Vector
                                                            (Rec
                                                               ('R
                                                                  '[ &quot;name&quot; ':-&gt; Text,
                                                                     &quot;value&quot; ':-&gt; Text])),
                                                     &quot;status&quot; ':-&gt; Natural])]),
                                Rec
                                  ('R
                                     '[ &quot;body&quot; ':-&gt; Blob,
                                        &quot;headers&quot;
                                        ':-&gt; Vector
                                               (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                        &quot;status&quot; ':-&gt; Natural]),
                                AnnTrue, AnnFalse)])),
        &quot;url&quot; ':-&gt; Text])
-&gt; (SubnetType, Word64) -&gt; Word64
forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;)) =&gt;
a -&gt; (SubnetType, Word64) -&gt; Word64
</span><a href="IC.Utils.html#http_request_fee"><span class="hs-identifier hs-var">http_request_fee</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; Maybe Blob,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;transform&quot;
        ':-&gt; Maybe
               (Rec
                  ('R
                     '[ &quot;context&quot; ':-&gt; Blob,
                        &quot;function&quot;
                        ':-&gt; FuncRef
                               (Rec
                                  ('R
                                     '[ &quot;context&quot; ':-&gt; Blob,
                                        &quot;response&quot;
                                        ':-&gt; Rec
                                               ('R
                                                  '[ &quot;body&quot; ':-&gt; Blob,
                                                     &quot;headers&quot;
                                                     ':-&gt; Vector
                                                            (Rec
                                                               ('R
                                                                  '[ &quot;name&quot; ':-&gt; Text,
                                                                     &quot;value&quot; ':-&gt; Text])),
                                                     &quot;status&quot; ':-&gt; Natural])]),
                                Rec
                                  ('R
                                     '[ &quot;body&quot; ':-&gt; Blob,
                                        &quot;headers&quot;
                                        ':-&gt; Vector
                                               (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                        &quot;status&quot; ':-&gt; Natural]),
                                AnnTrue, AnnFalse)])),
        &quot;url&quot; ':-&gt; Text])
Rec
  ('R
     '[ &quot;body&quot; ':-&gt; Maybe Blob,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;url&quot; ':-&gt; Text]
   .+ 'R
        '[ &quot;transform&quot;
           ':-&gt; Maybe
                  (Rec
                     ('R
                        '[ &quot;context&quot; ':-&gt; Blob,
                           &quot;function&quot;
                           ':-&gt; FuncRef
                                  (Rec
                                     ('R
                                        '[ &quot;context&quot; ':-&gt; Blob,
                                           &quot;response&quot;
                                           ':-&gt; Rec
                                                  ('R
                                                     '[ &quot;body&quot; ':-&gt; Blob,
                                                        &quot;headers&quot;
                                                        ':-&gt; Vector
                                                               (Rec
                                                                  ('R
                                                                     '[ &quot;name&quot; ':-&gt; Text,
                                                                        &quot;value&quot; ':-&gt; Text])),
                                                        &quot;status&quot; ':-&gt; Natural])]),
                                   Rec
                                     ('R
                                        '[ &quot;body&quot; ':-&gt; Blob,
                                           &quot;headers&quot;
                                           ':-&gt; Vector
                                                  (Rec
                                                     ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                           &quot;status&quot; ':-&gt; Natural]),
                                   AnnTrue, AnnFalse)]))])
</span><a href="#local-6989586621679350327"><span class="hs-identifier hs-var">request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SubnetType
</span><a href="#local-6989586621679350335"><span class="hs-identifier hs-var">subnet_type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679350334"><span class="hs-identifier hs-var">subnet_size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Blob
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;http_request&quot; (Label &quot;http_request&quot;)
Label &quot;http_request&quot;
</span><a href="#local-6989586621679350716"><span class="hs-var">#http_request</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; Maybe Blob,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;transform&quot;
        ':-&gt; Maybe
               (Rec
                  ('R
                     '[ &quot;context&quot; ':-&gt; Blob,
                        &quot;function&quot;
                        ':-&gt; FuncRef
                               (Rec
                                  ('R
                                     '[ &quot;context&quot; ':-&gt; Blob,
                                        &quot;response&quot;
                                        ':-&gt; Rec
                                               ('R
                                                  '[ &quot;body&quot; ':-&gt; Blob,
                                                     &quot;headers&quot;
                                                     ':-&gt; Vector
                                                            (Rec
                                                               ('R
                                                                  '[ &quot;name&quot; ':-&gt; Text,
                                                                     &quot;value&quot; ':-&gt; Text])),
                                                     &quot;status&quot; ':-&gt; Natural])]),
                                Rec
                                  ('R
                                     '[ &quot;body&quot; ':-&gt; Blob,
                                        &quot;headers&quot;
                                        ':-&gt; Vector
                                               (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                        &quot;status&quot; ':-&gt; Natural]),
                                AnnTrue, AnnFalse)])),
        &quot;url&quot; ':-&gt; Text])
Rec
  ('R
     '[ &quot;body&quot; ':-&gt; Maybe Blob,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;url&quot; ':-&gt; Text]
   .+ 'R
        '[ &quot;transform&quot;
           ':-&gt; Maybe
                  (Rec
                     ('R
                        '[ &quot;context&quot; ':-&gt; Blob,
                           &quot;function&quot;
                           ':-&gt; FuncRef
                                  (Rec
                                     ('R
                                        '[ &quot;context&quot; ':-&gt; Blob,
                                           &quot;response&quot;
                                           ':-&gt; Rec
                                                  ('R
                                                     '[ &quot;body&quot; ':-&gt; Blob,
                                                        &quot;headers&quot;
                                                        ':-&gt; Vector
                                                               (Rec
                                                                  ('R
                                                                     '[ &quot;name&quot; ':-&gt; Text,
                                                                        &quot;value&quot; ':-&gt; Text])),
                                                        &quot;status&quot; ':-&gt; Natural])]),
                                   Rec
                                     ('R
                                        '[ &quot;body&quot; ':-&gt; Blob,
                                           &quot;headers&quot;
                                           ':-&gt; Vector
                                                  (Rec
                                                     ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                           &quot;status&quot; ':-&gt; Natural]),
                                   AnnTrue, AnnFalse)]))])
</span><a href="#local-6989586621679350327"><span class="hs-identifier hs-var">request</span></a></span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-167"></span><span>    </span><span id="local-6989586621679350327"><span class="annot"><span class="annottext">request :: Rec
  ('R
     '[ &quot;body&quot; ':-&gt; Maybe Blob,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;url&quot; ':-&gt; Text]
   .+ 'R
        '[ &quot;transform&quot;
           ':-&gt; Maybe
                  (Rec
                     ('R
                        '[ &quot;context&quot; ':-&gt; Blob,
                           &quot;function&quot;
                           ':-&gt; FuncRef
                                  (Rec
                                     ('R
                                        '[ &quot;context&quot; ':-&gt; Blob,
                                           &quot;response&quot;
                                           ':-&gt; Rec
                                                  ('R
                                                     '[ &quot;body&quot; ':-&gt; Blob,
                                                        &quot;headers&quot;
                                                        ':-&gt; Vector
                                                               (Rec
                                                                  ('R
                                                                     '[ &quot;name&quot; ':-&gt; Text,
                                                                        &quot;value&quot; ':-&gt; Text])),
                                                        &quot;status&quot; ':-&gt; Natural])]),
                                   Rec
                                     ('R
                                        '[ &quot;body&quot; ':-&gt; Blob,
                                           &quot;headers&quot;
                                           ':-&gt; Vector
                                                  (Rec
                                                     ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                           &quot;status&quot; ':-&gt; Natural]),
                                   AnnTrue, AnnFalse)]))])
</span><a href="#local-6989586621679350327"><span class="hs-identifier hs-var hs-var">request</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rec Empty
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-168"></span><span>      </span><span class="annot"><span class="annottext">Rec Empty
-&gt; Rec ('R '[ &quot;url&quot; ':-&gt; Text])
-&gt; Rec (Empty .+ 'R '[ &quot;url&quot; ':-&gt; Text])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;url&quot; (Label &quot;url&quot;)
Label &quot;url&quot;
</span><a href="#local-6989586621679350759"><span class="hs-var">#url</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;url&quot; -&gt; Text -&gt; Rec (Extend &quot;url&quot; Text Empty)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
HasAgentConfig =&gt; String
</span><a href="IC.Test.Agent.Calls.html#httpbin"><span class="hs-identifier hs-var">httpbin</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679350333"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>      </span><span class="annot"><span class="annottext">Rec ('R '[ &quot;url&quot; ':-&gt; Text])
-&gt; Rec ('R '[ &quot;max_response_bytes&quot; ':-&gt; Maybe Word64])
-&gt; Rec
     ('R '[ &quot;url&quot; ':-&gt; Text]
      .+ 'R '[ &quot;max_response_bytes&quot; ':-&gt; Maybe Word64])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;max_response_bytes&quot; (Label &quot;max_response_bytes&quot;)
Label &quot;max_response_bytes&quot;
</span><a href="#local-6989586621679350752"><span class="hs-var">#max_response_bytes</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;max_response_bytes&quot;
-&gt; Maybe Word64 -&gt; Rec (&quot;max_response_bytes&quot; .== Maybe Word64)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Word64
</span><a href="#local-6989586621679350332"><span class="hs-identifier hs-var">max_response_bytes</span></a></span><span>
</span><span id="line-170"></span><span>      </span><span class="annot"><span class="annottext">Rec
  ('R '[ &quot;max_response_bytes&quot; ':-&gt; Maybe Word64, &quot;url&quot; ':-&gt; Text])
-&gt; Rec
     ('R
        '[ &quot;method&quot;
           ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()])])
-&gt; Rec
     ('R '[ &quot;max_response_bytes&quot; ':-&gt; Maybe Word64, &quot;url&quot; ':-&gt; Text]
      .+ 'R
           '[ &quot;method&quot;
              ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()])])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;method&quot; (Label &quot;method&quot;)
Label &quot;method&quot;
</span><a href="#local-6989586621679350748"><span class="hs-var">#method</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;method&quot;
-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()])
-&gt; Rec
     (&quot;method&quot;
      .== Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]))
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;head&quot;
-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()])
forall (r :: Row (*)) (l :: Symbol).
(AllUniqueLabels r, KnownSymbol l, (r .! l) ~ ()) =&gt;
Label l -&gt; Var r
</span><a href="IC.Test.Agent.html#enum"><span class="hs-identifier hs-var">enum</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;head&quot; (Label &quot;head&quot;)
Label &quot;head&quot;
</span><a href="#local-6989586621679350741"><span class="hs-var">#head</span></a></span><span>
</span><span id="line-171"></span><span>      </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;url&quot; ':-&gt; Text])
-&gt; Rec
     ('R
        '[ &quot;headers&quot;
           ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text]))])
-&gt; Rec
     ('R
        '[ &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
           &quot;method&quot;
           ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
           &quot;url&quot; ':-&gt; Text]
      .+ 'R
           '[ &quot;headers&quot;
              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text]))])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;headers&quot; (Label &quot;headers&quot;)
Label &quot;headers&quot;
</span><a href="#local-6989586621679350738"><span class="hs-var">#headers</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;headers&quot;
-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text]))
-&gt; Rec
     (&quot;headers&quot;
      .== Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])))
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text]))
Vector HttpHeader
</span><a href="#local-6989586621679350330"><span class="hs-identifier hs-var">headers</span></a></span><span>
</span><span id="line-172"></span><span>      </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;url&quot; ':-&gt; Text])
-&gt; Rec ('R '[ &quot;body&quot; ':-&gt; Maybe Blob])
-&gt; Rec
     ('R
        '[ &quot;headers&quot;
           ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
           &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
           &quot;method&quot;
           ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
           &quot;url&quot; ':-&gt; Text]
      .+ 'R '[ &quot;body&quot; ':-&gt; Maybe Blob])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;body&quot; (Label &quot;body&quot;)
Label &quot;body&quot;
</span><a href="#local-6989586621679350735"><span class="hs-var">#body</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;body&quot; -&gt; Maybe Blob -&gt; Rec (&quot;body&quot; .== Maybe Blob)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Blob
</span><a href="#local-6989586621679350331"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-173"></span><span>      </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; Maybe Blob,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;url&quot; ':-&gt; Text])
-&gt; Rec
     ('R
        '[ &quot;transform&quot;
           ':-&gt; Maybe
                  (Rec
                     ('R
                        '[ &quot;context&quot; ':-&gt; Blob,
                           &quot;function&quot;
                           ':-&gt; FuncRef
                                  (Rec
                                     ('R
                                        '[ &quot;context&quot; ':-&gt; Blob,
                                           &quot;response&quot;
                                           ':-&gt; Rec
                                                  ('R
                                                     '[ &quot;body&quot; ':-&gt; Blob,
                                                        &quot;headers&quot;
                                                        ':-&gt; Vector
                                                               (Rec
                                                                  ('R
                                                                     '[ &quot;name&quot; ':-&gt; Text,
                                                                        &quot;value&quot; ':-&gt; Text])),
                                                        &quot;status&quot; ':-&gt; Natural])]),
                                   Rec
                                     ('R
                                        '[ &quot;body&quot; ':-&gt; Blob,
                                           &quot;headers&quot;
                                           ':-&gt; Vector
                                                  (Rec
                                                     ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                           &quot;status&quot; ':-&gt; Natural]),
                                   AnnTrue, AnnFalse)]))])
-&gt; Rec
     ('R
        '[ &quot;body&quot; ':-&gt; Maybe Blob,
           &quot;headers&quot;
           ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
           &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
           &quot;method&quot;
           ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
           &quot;url&quot; ':-&gt; Text]
      .+ 'R
           '[ &quot;transform&quot;
              ':-&gt; Maybe
                     (Rec
                        ('R
                           '[ &quot;context&quot; ':-&gt; Blob,
                              &quot;function&quot;
                              ':-&gt; FuncRef
                                     (Rec
                                        ('R
                                           '[ &quot;context&quot; ':-&gt; Blob,
                                              &quot;response&quot;
                                              ':-&gt; Rec
                                                     ('R
                                                        '[ &quot;body&quot; ':-&gt; Blob,
                                                           &quot;headers&quot;
                                                           ':-&gt; Vector
                                                                  (Rec
                                                                     ('R
                                                                        '[ &quot;name&quot; ':-&gt; Text,
                                                                           &quot;value&quot; ':-&gt; Text])),
                                                           &quot;status&quot; ':-&gt; Natural])]),
                                      Rec
                                        ('R
                                           '[ &quot;body&quot; ':-&gt; Blob,
                                              &quot;headers&quot;
                                              ':-&gt; Vector
                                                     (Rec
                                                        ('R
                                                           '[ &quot;name&quot; ':-&gt; Text,
                                                              &quot;value&quot; ':-&gt; Text])),
                                              &quot;status&quot; ':-&gt; Natural]),
                                      AnnTrue, AnnFalse)]))])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;transform&quot; (Label &quot;transform&quot;)
Label &quot;transform&quot;
</span><a href="#local-6989586621679350732"><span class="hs-var">#transform</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;transform&quot;
-&gt; Maybe
     (Rec
        ('R
           '[ &quot;context&quot; ':-&gt; Blob,
              &quot;function&quot;
              ':-&gt; FuncRef
                     (Rec
                        ('R
                           '[ &quot;context&quot; ':-&gt; Blob,
                              &quot;response&quot;
                              ':-&gt; Rec
                                     ('R
                                        '[ &quot;body&quot; ':-&gt; Blob,
                                           &quot;headers&quot;
                                           ':-&gt; Vector
                                                  (Rec
                                                     ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                           &quot;status&quot; ':-&gt; Natural])]),
                      Rec
                        ('R
                           '[ &quot;body&quot; ':-&gt; Blob,
                              &quot;headers&quot;
                              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                              &quot;status&quot; ':-&gt; Natural]),
                      AnnTrue, AnnFalse)]))
-&gt; Rec
     (&quot;transform&quot;
      .== Maybe
            (Rec
               ('R
                  '[ &quot;context&quot; ':-&gt; Blob,
                     &quot;function&quot;
                     ':-&gt; FuncRef
                            (Rec
                               ('R
                                  '[ &quot;context&quot; ':-&gt; Blob,
                                     &quot;response&quot;
                                     ':-&gt; Rec
                                            ('R
                                               '[ &quot;body&quot; ':-&gt; Blob,
                                                  &quot;headers&quot;
                                                  ':-&gt; Vector
                                                         (Rec
                                                            ('R
                                                               '[ &quot;name&quot; ':-&gt; Text,
                                                                  &quot;value&quot; ':-&gt; Text])),
                                                  &quot;status&quot; ':-&gt; Natural])]),
                             Rec
                               ('R
                                  '[ &quot;body&quot; ':-&gt; Blob,
                                     &quot;headers&quot;
                                     ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                     &quot;status&quot; ':-&gt; Natural]),
                             AnnTrue, AnnFalse)])))
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (String, Blob)
-&gt; Blob
-&gt; Maybe
     (Rec
        ('R
           '[ &quot;context&quot; ':-&gt; Blob,
              &quot;function&quot;
              ':-&gt; FuncRef
                     (Rec
                        ('R
                           '[ &quot;context&quot; ':-&gt; Blob,
                              &quot;response&quot;
                              ':-&gt; Rec
                                     ('R
                                        '[ &quot;body&quot; ':-&gt; Blob,
                                           &quot;headers&quot;
                                           ':-&gt; Vector
                                                  (Rec
                                                     ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                           &quot;status&quot; ':-&gt; Natural])]),
                      Rec
                        ('R
                           '[ &quot;body&quot; ':-&gt; Blob,
                              &quot;headers&quot;
                              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                              &quot;status&quot; ':-&gt; Natural]),
                      AnnTrue, AnnFalse)]))
forall a r.
Maybe (String, a)
-&gt; Blob
-&gt; Maybe (Rec ('R '[ &quot;context&quot; ':-&gt; a, &quot;function&quot; ':-&gt; FuncRef r]))
</span><a href="IC.Test.Agent.Calls.html#toTransformFn"><span class="hs-identifier hs-var">toTransformFn</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (String, Blob)
</span><a href="#local-6989586621679350329"><span class="hs-identifier hs-var">transform</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679350328"><span class="hs-identifier hs-var">canister_id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_long_url_http_request"><span class="hs-identifier hs-type">ic_long_url_http_request</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IC.Test.Agent.html#HasAgentConfig"><span class="hs-identifier hs-type">HasAgentConfig</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679353548"><span class="annot"><a href="#local-6989586621679353548"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679353547"><span class="annot"><a href="#local-6989586621679353547"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679353548"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679353547"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Management.html#ICManagement"><span class="hs-identifier hs-type">ICManagement</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Internal.html#.%21"><span class="hs-operator hs-type">.!</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;http_request&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-177"></span><span>  </span><span class="annot"><a href="IC.Test.Agent.html#IC00WithCycles"><span class="hs-identifier hs-type">IC00WithCycles</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Types.html#TestSubnetConfig"><span class="hs-identifier hs-type">TestSubnetConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Word.html#Word64"><span class="hs-identifier hs-type">W.Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IC.Id.Forms.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Id.Forms.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679353547"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-178"></span><span id="ic_long_url_http_request"><span class="annot"><span class="annottext">ic_long_url_http_request :: forall a b.
(HasAgentConfig,
 (a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;)) =&gt;
IC00WithCycles
-&gt; TestSubnetConfig
-&gt; String
-&gt; Word64
-&gt; Maybe (String, Blob)
-&gt; Blob
-&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_long_url_http_request"><span class="hs-identifier hs-var hs-var">ic_long_url_http_request</span></a></span></span><span> </span><span id="local-6989586621679349862"><span class="annot"><span class="annottext">IC00WithCycles
</span><a href="#local-6989586621679349862"><span class="hs-identifier hs-var">ic00</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EntityId
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679349861"><span class="annot"><span class="annottext">SubnetType
</span><a href="#local-6989586621679349861"><span class="hs-identifier hs-var">subnet_type</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679349860"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679349860"><span class="hs-identifier hs-var">subnet_size</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Word64, Word64)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679349859"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679349859"><span class="hs-identifier hs-var">proto</span></a></span></span><span> </span><span id="local-6989586621679349858"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679349858"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span id="local-6989586621679349857"><span class="annot"><span class="annottext">Maybe (String, Blob)
</span><a href="#local-6989586621679349857"><span class="hs-identifier hs-var">transform</span></a></span></span><span> </span><span id="local-6989586621679349856"><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679349856"><span class="hs-identifier hs-var">canister_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-179"></span><span>  </span><span class="annot"><span class="annottext">IC00
-&gt; Blob
-&gt; Label &quot;http_request&quot;
-&gt; Rec
     ('R
        '[ &quot;body&quot; ':-&gt; Maybe Blob,
           &quot;headers&quot;
           ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
           &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
           &quot;method&quot;
           ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
           &quot;transform&quot;
           ':-&gt; Maybe
                  (Rec
                     ('R
                        '[ &quot;context&quot; ':-&gt; Blob,
                           &quot;function&quot;
                           ':-&gt; FuncRef
                                  (Rec
                                     ('R
                                        '[ &quot;context&quot; ':-&gt; Blob,
                                           &quot;response&quot;
                                           ':-&gt; Rec
                                                  ('R
                                                     '[ &quot;body&quot; ':-&gt; Blob,
                                                        &quot;headers&quot;
                                                        ':-&gt; Vector
                                                               (Rec
                                                                  ('R
                                                                     '[ &quot;name&quot; ':-&gt; Text,
                                                                        &quot;value&quot; ':-&gt; Text])),
                                                        &quot;status&quot; ':-&gt; Natural])]),
                                   Rec
                                     ('R
                                        '[ &quot;body&quot; ':-&gt; Blob,
                                           &quot;headers&quot;
                                           ':-&gt; Vector
                                                  (Rec
                                                     ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                           &quot;status&quot; ':-&gt; Natural]),
                                   AnnTrue, AnnFalse)])),
           &quot;url&quot; ':-&gt; Text])
-&gt; IO b
forall (s :: Symbol) a b.
(HasCallStack, HasAgentConfig, KnownSymbol s,
 (a -&gt; IO b) ~ (ICManagement IO .! s), CandidArg a, CandidArg b) =&gt;
IC00 -&gt; Blob -&gt; Label s -&gt; a -&gt; IO b
</span><a href="IC.Test.Agent.html#callIC"><span class="hs-identifier hs-var">callIC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IC00WithCycles
</span><a href="#local-6989586621679349862"><span class="hs-identifier hs-var">ic00</span></a></span><span> </span><span class="annot"><span class="annottext">IC00WithCycles -&gt; IC00WithCycles
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; Maybe Blob,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;transform&quot;
        ':-&gt; Maybe
               (Rec
                  ('R
                     '[ &quot;context&quot; ':-&gt; Blob,
                        &quot;function&quot;
                        ':-&gt; FuncRef
                               (Rec
                                  ('R
                                     '[ &quot;context&quot; ':-&gt; Blob,
                                        &quot;response&quot;
                                        ':-&gt; Rec
                                               ('R
                                                  '[ &quot;body&quot; ':-&gt; Blob,
                                                     &quot;headers&quot;
                                                     ':-&gt; Vector
                                                            (Rec
                                                               ('R
                                                                  '[ &quot;name&quot; ':-&gt; Text,
                                                                     &quot;value&quot; ':-&gt; Text])),
                                                     &quot;status&quot; ':-&gt; Natural])]),
                                Rec
                                  ('R
                                     '[ &quot;body&quot; ':-&gt; Blob,
                                        &quot;headers&quot;
                                        ':-&gt; Vector
                                               (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                        &quot;status&quot; ':-&gt; Natural]),
                                AnnTrue, AnnFalse)])),
        &quot;url&quot; ':-&gt; Text])
-&gt; (SubnetType, Word64) -&gt; Word64
forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;http_request&quot;)) =&gt;
a -&gt; (SubnetType, Word64) -&gt; Word64
</span><a href="IC.Utils.html#http_request_fee"><span class="hs-identifier hs-var">http_request_fee</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; Maybe Blob,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;transform&quot;
        ':-&gt; Maybe
               (Rec
                  ('R
                     '[ &quot;context&quot; ':-&gt; Blob,
                        &quot;function&quot;
                        ':-&gt; FuncRef
                               (Rec
                                  ('R
                                     '[ &quot;context&quot; ':-&gt; Blob,
                                        &quot;response&quot;
                                        ':-&gt; Rec
                                               ('R
                                                  '[ &quot;body&quot; ':-&gt; Blob,
                                                     &quot;headers&quot;
                                                     ':-&gt; Vector
                                                            (Rec
                                                               ('R
                                                                  '[ &quot;name&quot; ':-&gt; Text,
                                                                     &quot;value&quot; ':-&gt; Text])),
                                                     &quot;status&quot; ':-&gt; Natural])]),
                                Rec
                                  ('R
                                     '[ &quot;body&quot; ':-&gt; Blob,
                                        &quot;headers&quot;
                                        ':-&gt; Vector
                                               (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                        &quot;status&quot; ':-&gt; Natural]),
                                AnnTrue, AnnFalse)])),
        &quot;url&quot; ':-&gt; Text])
Rec
  ('R
     '[ &quot;body&quot; ':-&gt; Maybe Blob,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;url&quot; ':-&gt; Text]
   .+ 'R
        '[ &quot;transform&quot;
           ':-&gt; Maybe
                  (Rec
                     ('R
                        '[ &quot;context&quot; ':-&gt; Blob,
                           &quot;function&quot;
                           ':-&gt; FuncRef
                                  (Rec
                                     ('R
                                        '[ &quot;context&quot; ':-&gt; Blob,
                                           &quot;response&quot;
                                           ':-&gt; Rec
                                                  ('R
                                                     '[ &quot;body&quot; ':-&gt; Blob,
                                                        &quot;headers&quot;
                                                        ':-&gt; Vector
                                                               (Rec
                                                                  ('R
                                                                     '[ &quot;name&quot; ':-&gt; Text,
                                                                        &quot;value&quot; ':-&gt; Text])),
                                                        &quot;status&quot; ':-&gt; Natural])]),
                                   Rec
                                     ('R
                                        '[ &quot;body&quot; ':-&gt; Blob,
                                           &quot;headers&quot;
                                           ':-&gt; Vector
                                                  (Rec
                                                     ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                           &quot;status&quot; ':-&gt; Natural]),
                                   AnnTrue, AnnFalse)]))])
</span><a href="#local-6989586621679349855"><span class="hs-identifier hs-var">request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SubnetType
</span><a href="#local-6989586621679349861"><span class="hs-identifier hs-var">subnet_type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679349860"><span class="hs-identifier hs-var">subnet_size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Blob
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;http_request&quot; (Label &quot;http_request&quot;)
Label &quot;http_request&quot;
</span><a href="#local-6989586621679350245"><span class="hs-var">#http_request</span></a></span><span> </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; Maybe Blob,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;transform&quot;
        ':-&gt; Maybe
               (Rec
                  ('R
                     '[ &quot;context&quot; ':-&gt; Blob,
                        &quot;function&quot;
                        ':-&gt; FuncRef
                               (Rec
                                  ('R
                                     '[ &quot;context&quot; ':-&gt; Blob,
                                        &quot;response&quot;
                                        ':-&gt; Rec
                                               ('R
                                                  '[ &quot;body&quot; ':-&gt; Blob,
                                                     &quot;headers&quot;
                                                     ':-&gt; Vector
                                                            (Rec
                                                               ('R
                                                                  '[ &quot;name&quot; ':-&gt; Text,
                                                                     &quot;value&quot; ':-&gt; Text])),
                                                     &quot;status&quot; ':-&gt; Natural])]),
                                Rec
                                  ('R
                                     '[ &quot;body&quot; ':-&gt; Blob,
                                        &quot;headers&quot;
                                        ':-&gt; Vector
                                               (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                        &quot;status&quot; ':-&gt; Natural]),
                                AnnTrue, AnnFalse)])),
        &quot;url&quot; ':-&gt; Text])
Rec
  ('R
     '[ &quot;body&quot; ':-&gt; Maybe Blob,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;url&quot; ':-&gt; Text]
   .+ 'R
        '[ &quot;transform&quot;
           ':-&gt; Maybe
                  (Rec
                     ('R
                        '[ &quot;context&quot; ':-&gt; Blob,
                           &quot;function&quot;
                           ':-&gt; FuncRef
                                  (Rec
                                     ('R
                                        '[ &quot;context&quot; ':-&gt; Blob,
                                           &quot;response&quot;
                                           ':-&gt; Rec
                                                  ('R
                                                     '[ &quot;body&quot; ':-&gt; Blob,
                                                        &quot;headers&quot;
                                                        ':-&gt; Vector
                                                               (Rec
                                                                  ('R
                                                                     '[ &quot;name&quot; ':-&gt; Text,
                                                                        &quot;value&quot; ':-&gt; Text])),
                                                        &quot;status&quot; ':-&gt; Natural])]),
                                   Rec
                                     ('R
                                        '[ &quot;body&quot; ':-&gt; Blob,
                                           &quot;headers&quot;
                                           ':-&gt; Vector
                                                  (Rec
                                                     ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                           &quot;status&quot; ':-&gt; Natural]),
                                   AnnTrue, AnnFalse)]))])
</span><a href="#local-6989586621679349855"><span class="hs-identifier hs-var">request</span></a></span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-181"></span><span>    </span><span id="local-6989586621679349854"><span class="annot"><span class="annottext">l :: Int
</span><a href="#local-6989586621679349854"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679349858"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Int) -&gt; String -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679349859"><span class="hs-identifier hs-var">proto</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
HasAgentConfig =&gt; String
</span><a href="IC.Test.Agent.Calls.html#httpbin"><span class="hs-identifier hs-var">httpbin</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/ascii/&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>    </span><span id="local-6989586621679349852"><span class="annot"><span class="annottext">path :: String
</span><a href="#local-6989586621679349852"><span class="hs-identifier hs-var hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; String
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.List.html#take"><span class="hs-identifier hs-var">take</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679349854"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String
forall a. a -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.List.html#repeat"><span class="hs-identifier hs-var">repeat</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'x'</span></span><span>
</span><span id="line-183"></span><span>    </span><span id="local-6989586621679349855"><span class="annot"><span class="annottext">request :: Rec
  ('R
     '[ &quot;body&quot; ':-&gt; Maybe Blob,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;url&quot; ':-&gt; Text]
   .+ 'R
        '[ &quot;transform&quot;
           ':-&gt; Maybe
                  (Rec
                     ('R
                        '[ &quot;context&quot; ':-&gt; Blob,
                           &quot;function&quot;
                           ':-&gt; FuncRef
                                  (Rec
                                     ('R
                                        '[ &quot;context&quot; ':-&gt; Blob,
                                           &quot;response&quot;
                                           ':-&gt; Rec
                                                  ('R
                                                     '[ &quot;body&quot; ':-&gt; Blob,
                                                        &quot;headers&quot;
                                                        ':-&gt; Vector
                                                               (Rec
                                                                  ('R
                                                                     '[ &quot;name&quot; ':-&gt; Text,
                                                                        &quot;value&quot; ':-&gt; Text])),
                                                        &quot;status&quot; ':-&gt; Natural])]),
                                   Rec
                                     ('R
                                        '[ &quot;body&quot; ':-&gt; Blob,
                                           &quot;headers&quot;
                                           ':-&gt; Vector
                                                  (Rec
                                                     ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                           &quot;status&quot; ':-&gt; Natural]),
                                   AnnTrue, AnnFalse)]))])
</span><a href="#local-6989586621679349855"><span class="hs-identifier hs-var hs-var">request</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rec Empty
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-184"></span><span>      </span><span class="annot"><span class="annottext">Rec Empty
-&gt; Rec ('R '[ &quot;url&quot; ':-&gt; Text])
-&gt; Rec (Empty .+ 'R '[ &quot;url&quot; ':-&gt; Text])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;url&quot; (Label &quot;url&quot;)
Label &quot;url&quot;
</span><a href="#local-6989586621679350286"><span class="hs-var">#url</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;url&quot; -&gt; Text -&gt; Rec (Extend &quot;url&quot; Text Empty)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679349859"><span class="hs-identifier hs-var">proto</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
HasAgentConfig =&gt; String
</span><a href="IC.Test.Agent.Calls.html#httpbin"><span class="hs-identifier hs-var">httpbin</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/ascii/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679349852"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>      </span><span class="annot"><span class="annottext">Rec ('R '[ &quot;url&quot; ':-&gt; Text])
-&gt; Rec ('R '[ &quot;max_response_bytes&quot; ':-&gt; Maybe Word64])
-&gt; Rec
     ('R '[ &quot;url&quot; ':-&gt; Text]
      .+ 'R '[ &quot;max_response_bytes&quot; ':-&gt; Maybe Word64])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;max_response_bytes&quot; (Label &quot;max_response_bytes&quot;)
Label &quot;max_response_bytes&quot;
</span><a href="#local-6989586621679350281"><span class="hs-var">#max_response_bytes</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;max_response_bytes&quot;
-&gt; Maybe Word64 -&gt; Rec (&quot;max_response_bytes&quot; .== Maybe Word64)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Word64
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-186"></span><span>      </span><span class="annot"><span class="annottext">Rec
  ('R '[ &quot;max_response_bytes&quot; ':-&gt; Maybe Word64, &quot;url&quot; ':-&gt; Text])
-&gt; Rec
     ('R
        '[ &quot;method&quot;
           ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()])])
-&gt; Rec
     ('R '[ &quot;max_response_bytes&quot; ':-&gt; Maybe Word64, &quot;url&quot; ':-&gt; Text]
      .+ 'R
           '[ &quot;method&quot;
              ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()])])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;method&quot; (Label &quot;method&quot;)
Label &quot;method&quot;
</span><a href="#local-6989586621679350277"><span class="hs-var">#method</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;method&quot;
-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()])
-&gt; Rec
     (&quot;method&quot;
      .== Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]))
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;get&quot;
-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()])
forall (r :: Row (*)) (l :: Symbol).
(AllUniqueLabels r, KnownSymbol l, (r .! l) ~ ()) =&gt;
Label l -&gt; Var r
</span><a href="IC.Test.Agent.html#enum"><span class="hs-identifier hs-var">enum</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;get&quot; (Label &quot;get&quot;)
Label &quot;get&quot;
</span><a href="#local-6989586621679350270"><span class="hs-var">#get</span></a></span><span>
</span><span id="line-187"></span><span>      </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;url&quot; ':-&gt; Text])
-&gt; Rec
     ('R
        '[ &quot;headers&quot;
           ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text]))])
-&gt; Rec
     ('R
        '[ &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
           &quot;method&quot;
           ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
           &quot;url&quot; ':-&gt; Text]
      .+ 'R
           '[ &quot;headers&quot;
              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text]))])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;headers&quot; (Label &quot;headers&quot;)
Label &quot;headers&quot;
</span><a href="#local-6989586621679350267"><span class="hs-var">#headers</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;headers&quot;
-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text]))
-&gt; Rec
     (&quot;headers&quot;
      .== Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])))
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text]))
forall a. Vector a
</span><a href="file:///nix/store/5xj65cipwzdnpp6y5z9vwld366h065w2-vector-0.12.3.1-doc/share/doc/vector-0.12.3.1/html/src/Data.Vector.html#empty"><span class="hs-identifier hs-var">Vec.empty</span></a></span><span>
</span><span id="line-188"></span><span>      </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;url&quot; ':-&gt; Text])
-&gt; Rec ('R '[ &quot;body&quot; ':-&gt; Maybe Blob])
-&gt; Rec
     ('R
        '[ &quot;headers&quot;
           ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
           &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
           &quot;method&quot;
           ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
           &quot;url&quot; ':-&gt; Text]
      .+ 'R '[ &quot;body&quot; ':-&gt; Maybe Blob])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;body&quot; (Label &quot;body&quot;)
Label &quot;body&quot;
</span><a href="#local-6989586621679350264"><span class="hs-var">#body</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;body&quot; -&gt; Maybe Blob -&gt; Rec (&quot;body&quot; .== Maybe Blob)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Blob
forall a. Maybe a
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-189"></span><span>      </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;body&quot; ':-&gt; Maybe Blob,
        &quot;headers&quot;
        ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
        &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
        &quot;method&quot;
        ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
        &quot;url&quot; ':-&gt; Text])
-&gt; Rec
     ('R
        '[ &quot;transform&quot;
           ':-&gt; Maybe
                  (Rec
                     ('R
                        '[ &quot;context&quot; ':-&gt; Blob,
                           &quot;function&quot;
                           ':-&gt; FuncRef
                                  (Rec
                                     ('R
                                        '[ &quot;context&quot; ':-&gt; Blob,
                                           &quot;response&quot;
                                           ':-&gt; Rec
                                                  ('R
                                                     '[ &quot;body&quot; ':-&gt; Blob,
                                                        &quot;headers&quot;
                                                        ':-&gt; Vector
                                                               (Rec
                                                                  ('R
                                                                     '[ &quot;name&quot; ':-&gt; Text,
                                                                        &quot;value&quot; ':-&gt; Text])),
                                                        &quot;status&quot; ':-&gt; Natural])]),
                                   Rec
                                     ('R
                                        '[ &quot;body&quot; ':-&gt; Blob,
                                           &quot;headers&quot;
                                           ':-&gt; Vector
                                                  (Rec
                                                     ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                           &quot;status&quot; ':-&gt; Natural]),
                                   AnnTrue, AnnFalse)]))])
-&gt; Rec
     ('R
        '[ &quot;body&quot; ':-&gt; Maybe Blob,
           &quot;headers&quot;
           ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
           &quot;max_response_bytes&quot; ':-&gt; Maybe Word64,
           &quot;method&quot;
           ':-&gt; Var ('R '[ &quot;get&quot; ':-&gt; (), &quot;head&quot; ':-&gt; (), &quot;post&quot; ':-&gt; ()]),
           &quot;url&quot; ':-&gt; Text]
      .+ 'R
           '[ &quot;transform&quot;
              ':-&gt; Maybe
                     (Rec
                        ('R
                           '[ &quot;context&quot; ':-&gt; Blob,
                              &quot;function&quot;
                              ':-&gt; FuncRef
                                     (Rec
                                        ('R
                                           '[ &quot;context&quot; ':-&gt; Blob,
                                              &quot;response&quot;
                                              ':-&gt; Rec
                                                     ('R
                                                        '[ &quot;body&quot; ':-&gt; Blob,
                                                           &quot;headers&quot;
                                                           ':-&gt; Vector
                                                                  (Rec
                                                                     ('R
                                                                        '[ &quot;name&quot; ':-&gt; Text,
                                                                           &quot;value&quot; ':-&gt; Text])),
                                                           &quot;status&quot; ':-&gt; Natural])]),
                                      Rec
                                        ('R
                                           '[ &quot;body&quot; ':-&gt; Blob,
                                              &quot;headers&quot;
                                              ':-&gt; Vector
                                                     (Rec
                                                        ('R
                                                           '[ &quot;name&quot; ':-&gt; Text,
                                                              &quot;value&quot; ':-&gt; Text])),
                                              &quot;status&quot; ':-&gt; Natural]),
                                      AnnTrue, AnnFalse)]))])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;transform&quot; (Label &quot;transform&quot;)
Label &quot;transform&quot;
</span><a href="#local-6989586621679350261"><span class="hs-var">#transform</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;transform&quot;
-&gt; Maybe
     (Rec
        ('R
           '[ &quot;context&quot; ':-&gt; Blob,
              &quot;function&quot;
              ':-&gt; FuncRef
                     (Rec
                        ('R
                           '[ &quot;context&quot; ':-&gt; Blob,
                              &quot;response&quot;
                              ':-&gt; Rec
                                     ('R
                                        '[ &quot;body&quot; ':-&gt; Blob,
                                           &quot;headers&quot;
                                           ':-&gt; Vector
                                                  (Rec
                                                     ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                           &quot;status&quot; ':-&gt; Natural])]),
                      Rec
                        ('R
                           '[ &quot;body&quot; ':-&gt; Blob,
                              &quot;headers&quot;
                              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                              &quot;status&quot; ':-&gt; Natural]),
                      AnnTrue, AnnFalse)]))
-&gt; Rec
     (&quot;transform&quot;
      .== Maybe
            (Rec
               ('R
                  '[ &quot;context&quot; ':-&gt; Blob,
                     &quot;function&quot;
                     ':-&gt; FuncRef
                            (Rec
                               ('R
                                  '[ &quot;context&quot; ':-&gt; Blob,
                                     &quot;response&quot;
                                     ':-&gt; Rec
                                            ('R
                                               '[ &quot;body&quot; ':-&gt; Blob,
                                                  &quot;headers&quot;
                                                  ':-&gt; Vector
                                                         (Rec
                                                            ('R
                                                               '[ &quot;name&quot; ':-&gt; Text,
                                                                  &quot;value&quot; ':-&gt; Text])),
                                                  &quot;status&quot; ':-&gt; Natural])]),
                             Rec
                               ('R
                                  '[ &quot;body&quot; ':-&gt; Blob,
                                     &quot;headers&quot;
                                     ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                     &quot;status&quot; ':-&gt; Natural]),
                             AnnTrue, AnnFalse)])))
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (String, Blob)
-&gt; Blob
-&gt; Maybe
     (Rec
        ('R
           '[ &quot;context&quot; ':-&gt; Blob,
              &quot;function&quot;
              ':-&gt; FuncRef
                     (Rec
                        ('R
                           '[ &quot;context&quot; ':-&gt; Blob,
                              &quot;response&quot;
                              ':-&gt; Rec
                                     ('R
                                        '[ &quot;body&quot; ':-&gt; Blob,
                                           &quot;headers&quot;
                                           ':-&gt; Vector
                                                  (Rec
                                                     ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                                           &quot;status&quot; ':-&gt; Natural])]),
                      Rec
                        ('R
                           '[ &quot;body&quot; ':-&gt; Blob,
                              &quot;headers&quot;
                              ':-&gt; Vector (Rec ('R '[ &quot;name&quot; ':-&gt; Text, &quot;value&quot; ':-&gt; Text])),
                              &quot;status&quot; ':-&gt; Natural]),
                      AnnTrue, AnnFalse)]))
forall a r.
Maybe (String, a)
-&gt; Blob
-&gt; Maybe (Rec ('R '[ &quot;context&quot; ':-&gt; a, &quot;function&quot; ':-&gt; FuncRef r]))
</span><a href="IC.Test.Agent.Calls.html#toTransformFn"><span class="hs-identifier hs-var">toTransformFn</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (String, Blob)
</span><a href="#local-6989586621679349857"><span class="hs-identifier hs-var">transform</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679349856"><span class="hs-identifier hs-var">canister_id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_ecdsa_public_key"><span class="hs-identifier hs-type">ic_ecdsa_public_key</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679353537"><span class="annot"><a href="#local-6989586621679353537"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679353536"><span class="annot"><a href="#local-6989586621679353536"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679353537"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679353536"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Management.html#ICManagement"><span class="hs-identifier hs-type">ICManagement</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Internal.html#.%21"><span class="hs-operator hs-type">.!</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;ecdsa_public_key&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-193"></span><span>    </span><span class="annot"><a href="IC.Test.Agent.html#HasAgentConfig"><span class="hs-identifier hs-type">HasAgentConfig</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Test.Agent.html#IC00"><span class="hs-identifier hs-type">IC00</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Id.Forms.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="IC.Id.Forms.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/5xj65cipwzdnpp6y5z9vwld366h065w2-vector-0.12.3.1-doc/share/doc/vector-0.12.3.1/html/src/Data.Vector.html#Vector"><span class="hs-identifier hs-type">Vec.Vector</span></a></span><span> </span><span class="annot"><a href="IC.Id.Forms.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679353536"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-194"></span><span id="ic_ecdsa_public_key"><span class="annot"><span class="annottext">ic_ecdsa_public_key :: forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;ecdsa_public_key&quot;),
 HasAgentConfig) =&gt;
IC00 -&gt; Blob -&gt; Maybe Blob -&gt; Vector Blob -&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_ecdsa_public_key"><span class="hs-identifier hs-var hs-var">ic_ecdsa_public_key</span></a></span></span><span> </span><span id="local-6989586621679349589"><span class="annot"><span class="annottext">IC00
</span><a href="#local-6989586621679349589"><span class="hs-identifier hs-var">ic00</span></a></span></span><span> </span><span id="local-6989586621679349588"><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679349588"><span class="hs-identifier hs-var">ecid</span></a></span></span><span> </span><span id="local-6989586621679349587"><span class="annot"><span class="annottext">Maybe Blob
</span><a href="#local-6989586621679349587"><span class="hs-identifier hs-var">canister_id</span></a></span></span><span> </span><span id="local-6989586621679349586"><span class="annot"><span class="annottext">Vector Blob
</span><a href="#local-6989586621679349586"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-195"></span><span>  </span><span class="annot"><span class="annottext">IC00
-&gt; Blob
-&gt; Label &quot;ecdsa_public_key&quot;
-&gt; Rec
     ('R
        '[ &quot;canister_id&quot; ':-&gt; Maybe Principal,
           &quot;derivation_path&quot; ':-&gt; Vector Blob,
           &quot;key_id&quot;
           ':-&gt; Rec
                  ('R
                     '[ &quot;curve&quot; ':-&gt; Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()]),
                        &quot;name&quot; ':-&gt; Text])])
-&gt; IO b
forall (s :: Symbol) a b.
(HasCallStack, HasAgentConfig, KnownSymbol s,
 (a -&gt; IO b) ~ (ICManagement IO .! s), CandidArg a, CandidArg b) =&gt;
IC00 -&gt; Blob -&gt; Label s -&gt; a -&gt; IO b
</span><a href="IC.Test.Agent.html#callIC"><span class="hs-identifier hs-var">callIC</span></a></span><span> </span><span class="annot"><span class="annottext">IC00
</span><a href="#local-6989586621679349589"><span class="hs-identifier hs-var">ic00</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679349588"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;ecdsa_public_key&quot; (Label &quot;ecdsa_public_key&quot;)
Label &quot;ecdsa_public_key&quot;
</span><a href="#local-6989586621679349836"><span class="hs-var">#ecdsa_public_key</span></a></span><span> </span><span class="annot"><span class="annottext">(Rec
   ('R
      '[ &quot;canister_id&quot; ':-&gt; Maybe Principal,
         &quot;derivation_path&quot; ':-&gt; Vector Blob,
         &quot;key_id&quot;
         ':-&gt; Rec
                ('R
                   '[ &quot;curve&quot; ':-&gt; Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()]),
                      &quot;name&quot; ':-&gt; Text])])
 -&gt; IO b)
-&gt; Rec
     ('R
        '[ &quot;canister_id&quot; ':-&gt; Maybe Principal,
           &quot;derivation_path&quot; ':-&gt; Vector Blob,
           &quot;key_id&quot;
           ':-&gt; Rec
                  ('R
                     '[ &quot;curve&quot; ':-&gt; Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()]),
                        &quot;name&quot; ':-&gt; Text])])
-&gt; IO b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec Empty
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-196"></span><span>    </span><span class="annot"><span class="annottext">Rec Empty
-&gt; Rec ('R '[ &quot;derivation_path&quot; ':-&gt; Vector Blob])
-&gt; Rec (Empty .+ 'R '[ &quot;derivation_path&quot; ':-&gt; Vector Blob])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;derivation_path&quot; (Label &quot;derivation_path&quot;)
Label &quot;derivation_path&quot;
</span><a href="#local-6989586621679349820"><span class="hs-var">#derivation_path</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;derivation_path&quot;
-&gt; Vector Blob
-&gt; Rec (Extend &quot;derivation_path&quot; (Vector Blob) Empty)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Blob
</span><a href="#local-6989586621679349586"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-197"></span><span>    </span><span class="annot"><span class="annottext">Rec ('R '[ &quot;derivation_path&quot; ':-&gt; Vector Blob])
-&gt; Rec ('R '[ &quot;canister_id&quot; ':-&gt; Maybe Principal])
-&gt; Rec
     ('R '[ &quot;derivation_path&quot; ':-&gt; Vector Blob]
      .+ 'R '[ &quot;canister_id&quot; ':-&gt; Maybe Principal])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;canister_id&quot; (Label &quot;canister_id&quot;)
Label &quot;canister_id&quot;
</span><a href="#local-6989586621679349817"><span class="hs-var">#canister_id</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;canister_id&quot;
-&gt; Maybe Principal -&gt; Rec (&quot;canister_id&quot; .== Maybe Principal)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Blob -&gt; Principal) -&gt; Maybe Blob -&gt; Maybe Principal
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Blob -&gt; Principal
</span><a href="file:///nix/store/5q8knwbpcq1xjhfifih1jfwmvd2jr0sg-candid-0.4-doc/share/doc/candid-0.4/html/src/Codec.Candid.Data.html#Principal"><span class="hs-identifier hs-var">Principal</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Blob
</span><a href="#local-6989586621679349587"><span class="hs-identifier hs-var">canister_id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>    </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;canister_id&quot; ':-&gt; Maybe Principal,
        &quot;derivation_path&quot; ':-&gt; Vector Blob])
-&gt; Rec
     ('R
        '[ &quot;key_id&quot;
           ':-&gt; Rec
                  ('R
                     '[ &quot;curve&quot; ':-&gt; Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()]),
                        &quot;name&quot; ':-&gt; Text])])
-&gt; Rec
     ('R
        '[ &quot;canister_id&quot; ':-&gt; Maybe Principal,
           &quot;derivation_path&quot; ':-&gt; Vector Blob]
      .+ 'R
           '[ &quot;key_id&quot;
              ':-&gt; Rec
                     ('R
                        '[ &quot;curve&quot; ':-&gt; Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()]),
                           &quot;name&quot; ':-&gt; Text])])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;key_id&quot; (Label &quot;key_id&quot;)
Label &quot;key_id&quot;
</span><a href="#local-6989586621679349811"><span class="hs-var">#key_id</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;key_id&quot;
-&gt; Rec
     ('R
        '[ &quot;curve&quot; ':-&gt; Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()]),
           &quot;name&quot; ':-&gt; Text])
-&gt; Rec
     (Extend
        &quot;key_id&quot;
        (Rec
           ('R
              '[ &quot;curve&quot; ':-&gt; Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()]),
                 &quot;name&quot; ':-&gt; Text]))
        Empty)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec Empty
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-199"></span><span>       </span><span class="annot"><span class="annottext">Rec Empty
-&gt; Rec ('R '[ &quot;curve&quot; ':-&gt; Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()])])
-&gt; Rec
     (Empty .+ 'R '[ &quot;curve&quot; ':-&gt; Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()])])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;curve&quot; (Label &quot;curve&quot;)
Label &quot;curve&quot;
</span><a href="#local-6989586621679349802"><span class="hs-var">#curve</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;curve&quot;
-&gt; Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()])
-&gt; Rec (Extend &quot;curve&quot; (Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()])) Empty)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;secp256k1&quot; -&gt; Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()])
forall (r :: Row (*)) (l :: Symbol).
(AllUniqueLabels r, KnownSymbol l, (r .! l) ~ ()) =&gt;
Label l -&gt; Var r
</span><a href="IC.Test.Agent.html#enum"><span class="hs-identifier hs-var">enum</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;secp256k1&quot; (Label &quot;secp256k1&quot;)
Label &quot;secp256k1&quot;
</span><a href="#local-6989586621679349795"><span class="hs-var">#secp256k1</span></a></span><span>
</span><span id="line-200"></span><span>       </span><span class="annot"><span class="annottext">Rec ('R '[ &quot;curve&quot; ':-&gt; Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()])])
-&gt; Rec ('R '[ &quot;name&quot; ':-&gt; Text])
-&gt; Rec
     ('R '[ &quot;curve&quot; ':-&gt; Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()])]
      .+ 'R '[ &quot;name&quot; ':-&gt; Text])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;name&quot; (Label &quot;name&quot;)
Label &quot;name&quot;
</span><a href="#local-6989586621679349791"><span class="hs-var">#name</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;name&quot; -&gt; Text -&gt; Rec (Extend &quot;name&quot; Text Empty)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="annot"><a href="IC.Test.Agent.UnsafeCalls.html#ic_sign_with_ecdsa"><span class="hs-identifier hs-type">ic_sign_with_ecdsa</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679353530"><span class="annot"><a href="#local-6989586621679353530"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679353529"><span class="annot"><a href="#local-6989586621679353529"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679353530"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679353529"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#~"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IC.Management.html#ICManagement"><span class="hs-identifier hs-type">ICManagement</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Internal.html#.%21"><span class="hs-operator hs-type">.!</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;sign_with_ecdsa&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-205"></span><span>    </span><span class="annot"><a href="IC.Test.Agent.html#HasAgentConfig"><span class="hs-identifier hs-type">HasAgentConfig</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="IC.Test.Agent.html#IC00"><span class="hs-identifier hs-type">IC00</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Id.Forms.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IC.Id.Forms.html#Blob"><span class="hs-identifier hs-type">Blob</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/ghc-prim-0.7.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679353529"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-206"></span><span id="ic_sign_with_ecdsa"><span class="annot"><span class="annottext">ic_sign_with_ecdsa :: forall a b.
((a -&gt; IO b) ~ (ICManagement IO .! &quot;sign_with_ecdsa&quot;),
 HasAgentConfig) =&gt;
IC00 -&gt; Blob -&gt; Blob -&gt; IO b
</span><a href="IC.Test.Agent.UnsafeCalls.html#ic_sign_with_ecdsa"><span class="hs-identifier hs-var hs-var">ic_sign_with_ecdsa</span></a></span></span><span> </span><span id="local-6989586621679349354"><span class="annot"><span class="annottext">IC00
</span><a href="#local-6989586621679349354"><span class="hs-identifier hs-var">ic00</span></a></span></span><span> </span><span id="local-6989586621679349353"><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679349353"><span class="hs-identifier hs-var">ecid</span></a></span></span><span> </span><span id="local-6989586621679349352"><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679349352"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-207"></span><span>  </span><span class="annot"><span class="annottext">IC00
-&gt; Blob
-&gt; Label &quot;sign_with_ecdsa&quot;
-&gt; Rec
     ('R
        '[ &quot;derivation_path&quot; ':-&gt; Vector Blob,
           &quot;key_id&quot;
           ':-&gt; Rec
                  ('R
                     '[ &quot;curve&quot; ':-&gt; Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()]),
                        &quot;name&quot; ':-&gt; Text]),
           &quot;message_hash&quot; ':-&gt; Blob])
-&gt; IO b
forall (s :: Symbol) a b.
(HasCallStack, HasAgentConfig, KnownSymbol s,
 (a -&gt; IO b) ~ (ICManagement IO .! s), CandidArg a, CandidArg b) =&gt;
IC00 -&gt; Blob -&gt; Label s -&gt; a -&gt; IO b
</span><a href="IC.Test.Agent.html#callIC"><span class="hs-identifier hs-var">callIC</span></a></span><span> </span><span class="annot"><span class="annottext">IC00
</span><a href="#local-6989586621679349354"><span class="hs-identifier hs-var">ic00</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679349353"><span class="hs-identifier hs-var">ecid</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;sign_with_ecdsa&quot; (Label &quot;sign_with_ecdsa&quot;)
Label &quot;sign_with_ecdsa&quot;
</span><a href="#local-6989586621679349572"><span class="hs-var">#sign_with_ecdsa</span></a></span><span> </span><span class="annot"><span class="annottext">(Rec
   ('R
      '[ &quot;derivation_path&quot; ':-&gt; Vector Blob,
         &quot;key_id&quot;
         ':-&gt; Rec
                ('R
                   '[ &quot;curve&quot; ':-&gt; Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()]),
                      &quot;name&quot; ':-&gt; Text]),
         &quot;message_hash&quot; ':-&gt; Blob])
 -&gt; IO b)
-&gt; Rec
     ('R
        '[ &quot;derivation_path&quot; ':-&gt; Vector Blob,
           &quot;key_id&quot;
           ':-&gt; Rec
                  ('R
                     '[ &quot;curve&quot; ':-&gt; Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()]),
                        &quot;name&quot; ':-&gt; Text]),
           &quot;message_hash&quot; ':-&gt; Blob])
-&gt; IO b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/base-4.15.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Rec Empty
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><span class="annottext">Rec Empty
-&gt; Rec ('R '[ &quot;derivation_path&quot; ':-&gt; Vector Blob])
-&gt; Rec (Empty .+ 'R '[ &quot;derivation_path&quot; ':-&gt; Vector Blob])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;derivation_path&quot; (Label &quot;derivation_path&quot;)
Label &quot;derivation_path&quot;
</span><a href="#local-6989586621679349558"><span class="hs-var">#derivation_path</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;derivation_path&quot;
-&gt; Vector Blob
-&gt; Rec (Extend &quot;derivation_path&quot; (Vector Blob) Empty)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Blob
forall a. Vector a
</span><a href="file:///nix/store/5xj65cipwzdnpp6y5z9vwld366h065w2-vector-0.12.3.1-doc/share/doc/vector-0.12.3.1/html/src/Data.Vector.html#empty"><span class="hs-identifier hs-var">Vec.empty</span></a></span><span>
</span><span id="line-209"></span><span>    </span><span class="annot"><span class="annottext">Rec ('R '[ &quot;derivation_path&quot; ':-&gt; Vector Blob])
-&gt; Rec ('R '[ &quot;message_hash&quot; ':-&gt; Blob])
-&gt; Rec
     ('R '[ &quot;derivation_path&quot; ':-&gt; Vector Blob]
      .+ 'R '[ &quot;message_hash&quot; ':-&gt; Blob])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;message_hash&quot; (Label &quot;message_hash&quot;)
Label &quot;message_hash&quot;
</span><a href="#local-6989586621679349554"><span class="hs-var">#message_hash</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;message_hash&quot;
-&gt; Blob -&gt; Rec (Extend &quot;message_hash&quot; Blob Empty)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Blob
</span><a href="#local-6989586621679349352"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-210"></span><span>    </span><span class="annot"><span class="annottext">Rec
  ('R
     '[ &quot;derivation_path&quot; ':-&gt; Vector Blob, &quot;message_hash&quot; ':-&gt; Blob])
-&gt; Rec
     ('R
        '[ &quot;key_id&quot;
           ':-&gt; Rec
                  ('R
                     '[ &quot;curve&quot; ':-&gt; Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()]),
                        &quot;name&quot; ':-&gt; Text])])
-&gt; Rec
     ('R
        '[ &quot;derivation_path&quot; ':-&gt; Vector Blob, &quot;message_hash&quot; ':-&gt; Blob]
      .+ 'R
           '[ &quot;key_id&quot;
              ':-&gt; Rec
                     ('R
                        '[ &quot;curve&quot; ':-&gt; Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()]),
                           &quot;name&quot; ':-&gt; Text])])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;key_id&quot; (Label &quot;key_id&quot;)
Label &quot;key_id&quot;
</span><a href="#local-6989586621679349550"><span class="hs-var">#key_id</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;key_id&quot;
-&gt; Rec
     ('R
        '[ &quot;curve&quot; ':-&gt; Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()]),
           &quot;name&quot; ':-&gt; Text])
-&gt; Rec
     (Extend
        &quot;key_id&quot;
        (Rec
           ('R
              '[ &quot;curve&quot; ':-&gt; Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()]),
                 &quot;name&quot; ':-&gt; Text]))
        Empty)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec Empty
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-211"></span><span>       </span><span class="annot"><span class="annottext">Rec Empty
-&gt; Rec ('R '[ &quot;curve&quot; ':-&gt; Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()])])
-&gt; Rec
     (Empty .+ 'R '[ &quot;curve&quot; ':-&gt; Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()])])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;curve&quot; (Label &quot;curve&quot;)
Label &quot;curve&quot;
</span><a href="#local-6989586621679349541"><span class="hs-var">#curve</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;curve&quot;
-&gt; Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()])
-&gt; Rec (Extend &quot;curve&quot; (Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()])) Empty)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;secp256k1&quot; -&gt; Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()])
forall (r :: Row (*)) (l :: Symbol).
(AllUniqueLabels r, KnownSymbol l, (r .! l) ~ ()) =&gt;
Label l -&gt; Var r
</span><a href="IC.Test.Agent.html#enum"><span class="hs-identifier hs-var">enum</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;secp256k1&quot; (Label &quot;secp256k1&quot;)
Label &quot;secp256k1&quot;
</span><a href="#local-6989586621679349534"><span class="hs-var">#secp256k1</span></a></span><span>
</span><span id="line-212"></span><span>       </span><span class="annot"><span class="annottext">Rec ('R '[ &quot;curve&quot; ':-&gt; Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()])])
-&gt; Rec ('R '[ &quot;name&quot; ':-&gt; Text])
-&gt; Rec
     ('R '[ &quot;curve&quot; ':-&gt; Var ('R '[ &quot;secp256k1&quot; ':-&gt; ()])]
      .+ 'R '[ &quot;name&quot; ':-&gt; Text])
forall (l :: Row (*)) (r :: Row (*)).
FreeForall l =&gt;
Rec l -&gt; Rec r -&gt; Rec (l .+ r)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%2B"><span class="hs-operator hs-var">.+</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;name&quot; (Label &quot;name&quot;)
Label &quot;name&quot;
</span><a href="#local-6989586621679349530"><span class="hs-var">#name</span></a></span><span> </span><span class="annot"><span class="annottext">Label &quot;name&quot; -&gt; Text -&gt; Rec (Extend &quot;name&quot; Text Empty)
forall (l :: Symbol) a.
KnownSymbol l =&gt;
Label l -&gt; a -&gt; Rec (l .== a)
</span><a href="file:///nix/store/b588wzszvp5fnvv6rhlb8hcvmljsxf2h-row-types-1.0.1.2-doc/share/doc/row-types-1.0.1.2/html/src/Data.Row.Records.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///nix/store/sq3hm1arb77zb833mld18fi4liydbf18-ghc-9.0.2-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.html#pack"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-214"></span></pre></body></html>